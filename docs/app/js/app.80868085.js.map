{"version":3,"sources":["webpack://vue-flatsurf/./demo/App.vue?9b60","webpack://vue-flatsurf/./src/components/PanZoom.vue?a06e","webpack://vue-flatsurf/./src/geometry/Point.ts","webpack://vue-flatsurf/./src/geometry/Box.ts","webpack://vue-flatsurf/./src/geometry/Vector.ts","webpack://vue-flatsurf/./src/geometry/Segment.ts","webpack://vue-flatsurf/./src/geometry/Line.ts","webpack://vue-flatsurf/./src/geometry/CoordinateSystem.ts","webpack://vue-flatsurf/./src/geometry/Viewport.ts","webpack://vue-flatsurf/./src/components/PanZoom.vue","webpack://vue-flatsurf/./src/components/PanZoom.vue?9fa1","webpack://vue-flatsurf/./src/components/PanZoom.vue?7336","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?9351","webpack://vue-flatsurf/./src/geometry/triangulation/Permutation.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlatTriangulation.ts","webpack://vue-flatsurf/./src/geometry/triangulation/Automorphism.ts","webpack://vue-flatsurf/./src/geometry/triangulation/SaddleConnection.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlowConnection.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlowComponent.ts","webpack://vue-flatsurf/./src/components/Surface.vue?001f","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?040a","webpack://vue-flatsurf/./src/components/Face.vue?bdb4","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?cd00","webpack://vue-flatsurf/./src/components/svg/Ngon.vue","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?259e","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?ed49","webpack://vue-flatsurf/./src/components/Face.vue","webpack://vue-flatsurf/./src/components/Face.vue?dab4","webpack://vue-flatsurf/./src/components/Face.vue?1bf1","webpack://vue-flatsurf/./src/components/HalfEdge.vue?e265","webpack://vue-flatsurf/./src/components/svg/Segment.vue?7c4f","webpack://vue-flatsurf/./src/components/svg/Segment.vue","webpack://vue-flatsurf/./src/components/svg/Segment.vue?4ff6","webpack://vue-flatsurf/./src/components/svg/Segment.vue?c246","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?ee03","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?f6d6","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?aaf3","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?0be1","webpack://vue-flatsurf/./src/components/svg/Arrow.vue","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?d680","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?5da5","webpack://vue-flatsurf/./src/components/svg/ExtendedClickArea.vue?b9c0","webpack://vue-flatsurf/./src/components/svg/ExtendedClickArea.vue","webpack://vue-flatsurf/./src/components/HalfEdgeConfiguration.ts","webpack://vue-flatsurf/./src/components/HalfEdge.vue","webpack://vue-flatsurf/./src/components/HalfEdge.vue?2ee5","webpack://vue-flatsurf/./src/components/HalfEdge.vue?fa65","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?e38e","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?9e07","webpack://vue-flatsurf/./src/components/FlowComponent.vue?f54c","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?08f7","webpack://vue-flatsurf/./src/components/SaddleConnection.vue","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?4ee1","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?5a2a","webpack://vue-flatsurf/./src/components/FlowComponent.vue","webpack://vue-flatsurf/./src/components/FlowComponent.vue?4dde","webpack://vue-flatsurf/./src/components/FlowComponent.vue?bd31","webpack://vue-flatsurf/./src/Palette.ts","webpack://vue-flatsurf/./src/geometry/Polygon.ts","webpack://vue-flatsurf/./src/Progress.ts","webpack://vue-flatsurf/./src/CancellationToken.ts","webpack://vue-flatsurf/./src/geometry/layout/CellLayout.ts","webpack://vue-flatsurf/./src/geometry/layout/FlatTriangulationLayout.ts","webpack://vue-flatsurf/./src/export/SVGExporter.ts","webpack://vue-flatsurf/./src/components/Surface.vue","webpack://vue-flatsurf/./src/components/Surface.vue?3189","webpack://vue-flatsurf/./src/components/Surface.vue?94ad","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?1ac1","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?3274","webpack://vue-flatsurf/./demo/2-3-4-pullback-flow.txt","webpack://vue-flatsurf/./demo/Overlay.vue?1d12","webpack://vue-flatsurf/./demo/Overlay.vue","webpack://vue-flatsurf/./demo/Overlay.vue?3854","webpack://vue-flatsurf/./demo/Overlay.vue?d4f7","webpack://vue-flatsurf/./demo/App.vue","webpack://vue-flatsurf/./demo/App.vue?2c48","webpack://vue-flatsurf/./demo/App.vue?7ebf","webpack://vue-flatsurf/./demo/main.ts","webpack://vue-flatsurf/webpack/bootstrap","webpack://vue-flatsurf/webpack/runtime/chunk loaded","webpack://vue-flatsurf/webpack/runtime/compat get default export","webpack://vue-flatsurf/webpack/runtime/define property getters","webpack://vue-flatsurf/webpack/runtime/global","webpack://vue-flatsurf/webpack/runtime/hasOwnProperty shorthand","webpack://vue-flatsurf/webpack/runtime/make namespace object","webpack://vue-flatsurf/webpack/runtime/jsonp chunk loading","webpack://vue-flatsurf/webpack/startup"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","overlay","progress","raw","on","onError","svg","svgExport","scopedSlots","_u","key","fn","ref","_g","_b","error","_v","model","value","callback","$$v","editor","expression","$event","staticClass","_e","staticRenderFns","class","pan","onMouseDown","onMouseUp","_t","viewport","Point","parent","x","y","equalTo","rhs","epsilon","Math","abs","embed","toString","shape","translate","vector","Box","xy0","xy1","Array","min","max","shapes","length","Error","boxes","map","box","reduce","a","b","merge","contain","aspectRatio","xmin","height","width","ymin","xmax","ymax","other","low","high","Vector","yaml","coordinateSystem","rotate90CW","positive","rotate90CCW","normalize","multiply","scalar","angleTo","ccw","invert","add","v","Segment","end","CoordinateSystem","console","assert","undefined","start","middle","tangentInStart","tangentInEnd","at","relative","delta","intersect","intersections","push","intersects","touch","reverse","Line","pt","norm","intersection","A","a00","a01","a02","a10","a11","a12","a20","a21","a22","c","tx","d","ty","adj","det","inv","affine","embeddedInto","embedding","embedInto","into","point","xy","transform","JSON","stringify","inverse","origin","Viewport","ideal","idealCoordinateSystem","viewportCoordinateSystem","visible","focused","resize","focus","zoom","factor","center","centerBefore","centerAfter","PanZoom","observer","ResizeObserver","unpanzoom","$refs","clientWidth","window","innerWidth","clientHeight","innerHeight","refocus","mounted","$el","panzoom","observe","beforeDestroy","unobserve","e","dz","exp","dx","dy","required","type","immediate","component","surface","automorphisms","components","inner","onLayoutChanged","onSVGChanged","Permutation","cycles","mapping","cycle","i","fromMapping","entry","String","xor","Object","keys","find","includes","pop","image","preimage","values","FlatTriangulation","fromCycles","vertices","fromEntries","entries","vectors","halfEdge","parse","halfEdges","domain","faces","he","Number","face","sum","Automorphism","set","hasOwnProperty","halfEdgeMap","orbit","automorphism","SaddleConnection","source","target","crossings","freeze","FlowConnection","vertical","boundary","touches","connection","FlowComponent","cylinder","perimeter","inside","layout","_l","palette","color","sourceIndicators","points","Ngon","join","Face","onClick","onMouseEnter","onMouseLeave","onMouseMove","halfEdgeConfiguration","state","segment","_s","label","indicator","selected","glued","coords","embedded","transformation","HalfEdgeLabel","midpoint","normal","position","x1","y1","x2","y2","atEnd","SVGArrow","endWithoutHead","PI","preventDefault","stopPropagation","$emit","apply","arguments","script","DefaultHalfEdgeConfiguration","interactions","click","enter","leave","hover","HalfEdgeComponent","sourceIndicator","ev","Boolean","default","Arrow","ExtendedClickArea","SegmentComponent","SegmentLabel","filter","every","primary","s","some","t","w","angle","degree","style","segments","crossing","shift","line","crossingEdge","crossingLine","alongHalfEdge","ats","resetCaches","ensureCaches","index","floor","patch","isHalfEdge","B","C","scenario","atouches","btouches","patchHalfEdge","triangles","patches","glue","ngon","triangle","step","n","splice","nn","SaddleConnectionComponent","Palette","constructor","colors","space","seed","colorSpace","warn","Polygon","convexHull","p","hull","q","last","next","leftTo","polygon","addFace","minArea","minAreaRect","edge","edges","direction","theta","rotation","cos","sin","aligned","area","toPoints","vertex","Progress","name","steps","task","OperationAborted","CancellationToken","cancellationRequested","Promise","resolve","reject","aborted","setTimeout","cancelled","cancel","abort","CellLayout","cell","boundingRectArea","boundingRect","before","glues","otherPolygon","touchConsistent","boundaries","side","pending","Set","size","delete","cells","force","cache","cancellation","_progress","scores","score","best","minBy","ca","cb","dc","x00","x01","x02","x10","x11","x12","x20","x21","x22","delaunay","ungluedArea","gluedArea","isArray","packed","cell_","halfEdge_","packable","segment_","screen","FlatTriangulationLayout","recompute","_","pack","assign","flat","log","bbox","SVGExporter","cloneNode","styles","getElementsByTagName","computedStyle","tagName","document","createElement","appendChild","unshift","setAttribute","element","getComputedStyle","computed","getPropertyValue","children","dropClasses","child","removeAttribute","dropPrefixedStyles","_value","startsWith","dropInvisible","trash","addToTrash","forEach","_style","parentNode","removeChild","dropRedundantStyles","dropCustomAttributes","attributes","attribute","dropNonStandardStyles","standard","usePresentationAttributes","makePresentation","hasAttribute","simplifyColors","simplify","okey","getAttribute","opacity","dropTrivialStyles","dropNonInkscapeStyles","dropInteractiveStyles","inlineStyles","svgo","outerHTML","data","Surface","forced","hovered","visibleComponents","defaultLabel","run","created","relayout","nextLabel","chars","split","charCodeAt","code","fromCharCode","async","componentInnerHalfEdges","cylinderInnerHalfEdges","$nextTick","exporter","onForcedChanged","onInnerChanged","forceHalfEdge","$once","clamp","unhover","relativizeOntoSegment","toPoint","dot","clientX","getBoundingClientRect","left","clientY","top","from","_run","FlatTriangulationComponent","FlowComponentComponent","SurfaceViewer","onRawChanged","parsed","message","Overlay","onCancellation","stats","VBtn","App","VApp","h","vuetify","$mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","deferred","O","result","chunkIds","priority","notFulfilled","Infinity","fulfilled","j","r","getter","__esModule","definition","o","defineProperty","enumerable","get","g","globalThis","Function","obj","prop","prototype","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"mappings":"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","file":"js/app.80868085.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',[_c('v-main',[_c('v-container',{attrs:{\"fluid\":\"\",\"fill-height\":\"\"}},[_c('overlay',{attrs:{\"cancellation\":_vm.overlay,\"progress\":_vm.progress}}),_c('surface-viewer',{attrs:{\"raw\":_vm.raw},on:{\"error\":_vm.onError,\"ok\":function () { return _vm.onError(); },\"svg\":function (svg) { return _vm.svgExport = svg; }}})],1),_c('v-dialog',{attrs:{\"fullscreen\":\"\",\"hide-overlay\":\"\",\"transition\":\"dialog-bottom-transition\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({attrs:{\"color\":_vm.error ? 'red': 'green',\"dark\":\"\",\"dense\":\"\",\"small\":\"\",\"fixed\":\"\",\"bottom\":\"\",\"right\":\"\",\"fab\":\"\"}},'v-btn',attrs,false),on),[(!_vm.error)?_c('v-icon',[_vm._v(\"mdi-pencil\")]):_c('v-icon',[_vm._v(\"mdi-alert-circle-outline\")])],1)]}}]),model:{value:(_vm.editor),callback:function ($$v) {_vm.editor=$$v},expression:\"editor\"}},[_c('v-card',[_c('v-toolbar',{attrs:{\"dark\":\"\",\"cards\":\"\",\"color\":_vm.error ? 'red' : 'green'}},[_c('v-btn',{attrs:{\"icon\":\"\",\"dark\":\"\"},on:{\"click\":function($event){_vm.editor = false}}},[_c('v-icon',[_vm._v(\"mdi-arrow-left\")])],1),_c('v-card-title',[_vm._v(\"Flat Triangulation Data\")])],1),_c('v-form',{staticClass:\"pa-6 pt-6\"},[_c('v-textarea',{staticClass:\"editor\",attrs:{\"error-messages\":_vm.error,\"auto-grow\":\"\",\"filled\":\"\",\"rows\":\"1\"},model:{value:(_vm.raw),callback:function ($$v) {_vm.raw=$$v},expression:\"raw\"}})],1)],1)],1),(!_vm.error && !_vm.overlay)?_c('v-dialog',{attrs:{\"fullscreen\":\"\",\"hide-overlay\":\"\",\"transition\":\"dialog-bottom-transition\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({attrs:{\"color\":\"blue\",\"dark\":\"\",\"dense\":\"\",\"small\":\"\",\"fixed\":\"\",\"bottom\":\"\",\"left\":\"\",\"fab\":\"\"}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-camera\")])],1)]}}],null,false,4025757055),model:{value:(_vm.svg),callback:function ($$v) {_vm.svg=$$v},expression:\"svg\"}},[_c('v-card',[_c('v-toolbar',{attrs:{\"dark\":\"\",\"cards\":\"\",\"color\":\"green\"}},[_c('v-btn',{attrs:{\"icon\":\"\",\"dark\":\"\"},on:{\"click\":function($event){_vm.svg = false}}},[_c('v-icon',[_vm._v(\"mdi-arrow-left\")])],1),_c('v-card-title',[_vm._v(\"SVG Export\")])],1),_c('v-form',{staticClass:\"pa-6 pt-6\"},[_c('v-textarea',{staticClass:\"editor\",attrs:{\"auto-grow\":\"\",\"filled\":\"\",\"rows\":\"1\"},model:{value:(_vm.svgExport),callback:function ($$v) {_vm.svgExport=$$v},expression:\"svgExport\"}})],1)],1)],1):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"viewport\",class:{ pan: _vm.pan },on:{\"mousedown\":_vm.onMouseDown,\"mouseup\":_vm.onMouseUp}},[_vm._t(\"default\",null,{\"viewport\":_vm.viewport})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Vector from './Vector';\nimport Polygon from './Polygon';\nimport Segment from './Segment';\n\nexport default class Point {\n  public constructor(parent: CoordinateSystem, x: Coordinate, y: Coordinate);\n  public constructor(parent: CoordinateSystem, p: Flatten.Point);\n  public constructor(parent: CoordinateSystem, x: Coordinate | Flatten.Point, y?: Coordinate) {\n    this.parent = parent;\n    if (typeof(x) === \"number\")\n      this.value = new Flatten.Point(x, y);\n    else\n      this.value = x;\n  }\n  \n  public get x() { return this.value.x; }\n  public get y() { return this.value.y; }\n  public get xy() : [Coordinate, Coordinate] { return [this.x, this.y]; }\n\n  public equalTo(rhs: Point, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return Math.abs(this.x - rhs.x) <= epsilon && Math.abs(this.y - rhs.y) <= epsilon;\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public toString(): string {\n    return `(${this.x}, ${this.y})`;\n  }\n\n  public on(shape: Polygon): boolean;\n  public on(shape: Segment): boolean;\n  public on(shape: Polygon | Segment): boolean {\n    return shape.parent.embed(this).value.on(shape.value);\n  }\n\n  public translate(vector: Vector): Point {\n    return new Point(this.parent, this.value.translate(this.parent.embed(vector).value));\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Point;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Point from \"./Point\";\nimport Segment from './Segment';\n\nexport default class Box {\n  public constructor(parent: CoordinateSystem, box: Flatten.Box);\n  public constructor(parent: CoordinateSystem, xy0: [Coordinate, Coordinate], xy1: [Coordinate, Coordinate]);\n  public constructor(parent: CoordinateSystem, xy0: [Coordinate, Coordinate] | Flatten.Box, xy1?: [Coordinate, Coordinate]) {\n    this.parent = parent;\n\n    if (xy0 instanceof Flatten.Box) {\n      this.value = xy0;\n    } else {\n      assert(xy1 instanceof Array);\n      this.value = new Flatten.Box(Math.min(xy0[0], xy1[0]), Math.min(xy0[1], xy1[1]), Math.max(xy0[0], xy1[0]), Math.max(xy0[1], xy1[1]));\n    }\n  }\n\n  public static bbox(shapes: Array<Point|Segment>): Box {\n    if (shapes.length === 0)\n      throw Error(\"cannot create bounding box of nothing\");\n\n    const boxes = shapes.map((shape) => {\n      if (shape instanceof Point)\n        return new Box(shape.parent, [shape.value.x, shape.value.y], [shape.value.x, shape.value.y]);\n      else\n        return new Box(shape.parent, shape.value.box);\n    });\n    return boxes.reduce((a: Box, b: Box) => a.merge(b));\n  }\n\n  // Return an enlargened version of this box that has the prescribed aspect\n  // ratio (leaving one of its dimensions untouched and centering it in the\n  // other dimension.)\n  public contain(aspectRatio: number) {\n    if (this.aspectRatio < aspectRatio)\n      return new Box(this.parent, [this.value.xmin - (this.height * aspectRatio - this.width) / 2, this.value.ymin], [this.value.xmax + (this.height * aspectRatio - this.width) / 2, this.value.ymax]);\n    else\n      return new Box(this.parent, [this.value.xmin, this.value.ymin - (this.width / aspectRatio - this.height) / 2], [this.value.xmax, this.value.ymax + (this.width / aspectRatio - this.height) / 2]);\n  }\n\n  public merge(other: Box): Box {\n    return new Box(this.parent, this.value.merge(this.parent.embed(other).value));\n  }\n\n  public translate(x: Coordinate, y: Coordinate) {\n    return new Box(this.parent, [this.value.xmin + x, this.value.ymin + y], [this.value.xmax + x, this.value.ymax + y]);\n  }\n\n  public get low() {\n    return new Point(this.parent, this.value.xmin, this.value.ymin);\n  }\n\n  public get high() {\n    return new Point(this.parent, this.value.xmax, this.value.ymax);\n  }\n\n  public get aspectRatio() {\n    return this.width / this.height;\n  }\n\n  public get width() {\n    return this.value.xmax - this.value.xmin;\n  }\n\n  public get center() {\n    return new Point(this.parent, (this.value.xmin + this.value.xmax) / 2, (this.value.ymin + this.value.ymax) / 2);\n  }\n\n  public get height() {\n    return this.value.ymax - this.value.ymin;\n  }\n\n  public equalTo(rhs: Box, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return this.low.equalTo(rhs.low, epsilon) && this.high.equalTo(rhs.high, epsilon);\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Box;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Point from './Point';\n\nexport interface VectorSchema {\n  x: number,\n  y: number,\n};\n\nexport default class Vector {\n  public constructor(parent: CoordinateSystem, x: Coordinate, y: Coordinate);\n  public constructor(parent: CoordinateSystem, p: Flatten.Vector);\n  public constructor(parent: CoordinateSystem, a: Point, b: Point);\n  public constructor(parent: CoordinateSystem, x: Coordinate | Flatten.Vector | Point, y?: Coordinate | Point) {\n    this.parent = parent;\n    if (typeof(x) === \"number\") {\n      assert(typeof(y) === \"number\");\n      this.value = new Flatten.Vector(x, y);\n    } else if (x instanceof Flatten.Vector) {\n      assert(y == null);\n      this.value = x;\n    } else {\n      assert(x instanceof Point);\n      assert(y instanceof Point);\n      const a = parent.embed(x);\n      const b = parent.embed(y);\n      this.value = new Flatten.Vector(a.value, b.value);\n    }\n  }\n\n  public static parse(yaml: VectorSchema, coordinateSystem: CoordinateSystem): Vector {\n    return new Vector(coordinateSystem, yaml.x, yaml.y);\n  }\n  \n  public get x() { return this.value.x; }\n  public get y() { return this.value.y; }\n  public get xy() : [Coordinate, Coordinate] { return [this.x, this.y]; }\n\n  public rotate90CW() {\n    return new Vector(this.parent, this.parent.positive ? this.value.rotate90CW(): this.value.rotate90CCW());\n  }\n\n  public rotate90CCW() {\n    return new Vector(this.parent, this.parent.positive ? this.value.rotate90CCW(): this.value.rotate90CW());\n  }\n\n  public normalize() {\n    return new Vector(this.parent, this.value.normalize());\n  }\n\n  public multiply(scalar: number) {\n    return new Vector(this.parent, this.value.multiply(scalar));\n  }\n\n  public angleTo(ccw: Vector) {\n    return this.parent.positive ? this.parent.embed(ccw).value.angleTo(this.value) : this.value.angleTo(this.parent.embed(ccw).value);\n  }\n\n  public invert() {\n    return new Vector(this.parent, this.value.invert());\n  }\n\n  public add(v: Vector) {\n    return new Vector(this.parent, this.value.add(this.parent.embed(v).value));\n  }\n\n  public equalTo(rhs: Vector, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return Math.abs(this.x - rhs.x) <= epsilon && Math.abs(this.y - rhs.y) <= epsilon;\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Vector;\n}\n\n\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Point from \"./Point\";\nimport Polygon from './Polygon';\nimport Vector from './Vector';\n\nexport default class Segment {\n  public constructor(start: Point, end: Point);\n  public constructor(parent: CoordinateSystem, value: Flatten.Segment);\n  public constructor(parent: CoordinateSystem, start: Flatten.Point, end: Flatten.Point);\n  public constructor(parent: CoordinateSystem | Point, value: Point | Flatten.Point | Flatten.Segment, end?: Flatten.Point){\n    if (!(parent instanceof CoordinateSystem)) {\n      console.assert(value instanceof Point, value);\n      ({parent, value, end} = {\n        parent: parent.parent,\n        value: parent.value,\n        end: parent.parent.embed(value as Point).value,\n      });\n    }\n\n    this.parent = parent;\n    if (end !== undefined) {\n      const start = value as Flatten.Point;\n      this.value = new Flatten.Segment(start, end);\n    } else {\n      this.value = value as Flatten.Segment;\n    }\n  }\n  \n  public get start() { return new Point(this.parent, this.value.start); }\n  public get middle() { return new Point(this.parent, this.value.middle()); }\n  public get end() { return new Point(this.parent, this.value.end); }\n  public get tangentInStart() { return new Vector(this.parent, this.value.tangentInStart()); }\n  public get tangentInEnd() { return new Vector(this.parent, this.value.tangentInEnd()); }\n\n  public at(relative: number) {\n    return this.start.translate(new Vector(this.parent, this.start, this.end).multiply(relative));\n  }\n\n  public translate(delta: Vector): Segment {\n    delta = this.parent.embed(delta);\n    return new Segment(this.parent, this.value.translate(delta.value));\n  }\n\n  // Return the points of intersection between this segment and the segments\n  // forming the boundary of the polygon. If this segment overlaps with one of\n  // the boundary segments, the end points of the overlap are included. If it\n  // touches, the point of touching is included.\n  public intersect(shape: Polygon): Point[] {\n    const intersections = shape.parent.embed(this).value.intersect(shape.value).map(value => new Point(shape.parent, value));\n    if(this.start.on(shape))\n      // TODO: Bug in flatten.\n      intersections.push(this.start);\n    if (this.end.on(shape))\n      // TODO: Bug in flatten.\n      intersections.push(this.end);\n    return intersections;\n  }\n\n  // Return whether this segment and the (filled) shape have at least one point\n  // in common.\n  public intersects(shape: Polygon): boolean {\n    return Flatten.Relations.intersect(shape.parent.embed(this).value, shape.value);\n  }\n\n  public touch(shape: Polygon): boolean {\n    return Flatten.Relations.touch(shape.parent.embed(this).value, shape.value);\n  }\n\n  public toString(): string {\n    return `((${this.value.start.x}, ${this.value.start.y}), (${this.value.end.x}, ${this.value.end.y}))`;\n  }\n\n  public get length() {\n    return this.value.length;\n  }\n\n  public equalTo(rhs: Segment, epsilon: number = 0): boolean {\n    return this.start.equalTo(rhs.start, epsilon) && this.end.equalTo(rhs.end, epsilon);\n  }\n\n  public reverse(): Segment {\n    return new Segment(this.parent, this.value.reverse());\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Segment;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport Point from \"./Point\";\nimport Vector from \"./Vector\";\nimport CoordinateSystem from \"./CoordinateSystem\";\n\nexport default class Line {\n  constructor(pt: Point, norm: Vector);\n  constructor(a: Point, b: Point);\n  public constructor(pt: Point, norm: Point | Vector) {\n    this.parent = pt.parent;\n    if (norm instanceof Point)\n      this.value = new Flatten.Line(pt.value, this.parent.embed(norm).value);\n    else\n      this.value = new Flatten.Line(pt.value, this.parent.embed(norm).value);\n  }\n\n  public intersect(other: Line): Point | null {\n    const intersections = other.parent.embed(this).value.intersect(other.value).map((intersection) => new Point(other.parent, intersection));\n    if (intersections.length === 0) return null;\n    if (intersections.length !== 1) throw Error(\"not implemented: Line.intersection()\");\n    return intersections[0];\n  }\n\n  public get pt() { return new Point(this.parent, this.value.pt); }\n  public get norm() { return new Vector(this.parent, this.value.norm); }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Line;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport Point from \"./Point\";\nimport Box from \"./Box\";\nimport Vector from \"./Vector\";\nimport Segment from \"./Segment\";\nimport Line from \"./Line\";\n\nexport type Coordinate = number;\n\nexport default class CoordinateSystem {\n  public constructor(positive: boolean) {\n    this.positive = positive;\n  }\n\n  public static inverse(A: Flatten.Matrix) {\n    const [a00, a01, a02, a10, a11, a12, a20, a21, a22] = [A.a, A.c, A.tx, A.b, A.d, A.ty, 0, 0, 1];\n    const adj = [a11*a22 - a21*a12, a10*a22 - a20*a12, a10*a21 - a20*a11, a01*a22 - a21*a02, a00*a22 - a20*a02, a00*a21 - a20*a01, a01*a12 - a11*a02, a00*a12 - a10*a02, a00*a11 - a10*a01];\n    const det = a00*adj[0] - a01*adj[1] + a02*adj[2];\n    const inv = [adj[0], -adj[3], adj[6], -adj[1], adj[4], -adj[7], adj[2], -adj[5], adj[8]].map(a => a / det);\n    const affine = inv.map(a => a / inv[8]);\n    return new Flatten.Matrix(affine[0], affine[3], affine[1], affine[4], affine[2], affine[5]);\n  }\n\n  public readonly positive: boolean;\n  private embeddedInto: CoordinateSystem | null = null;\n  private embedding: Flatten.Matrix | null = null;\n\n  public embedInto(into: CoordinateSystem, embedding?: Flatten.Matrix) {\n    if (embedding === undefined) {\n      embedding = new Flatten.Matrix();\n      if (this.positive !== into.positive)\n        embedding = new Flatten.Matrix(1, 0, 0, -1);\n    }\n    if (this.embeddedInto !== null && this.embeddedInto !== into)\n        throw Error(\"not implemented: cannot have more than one embedding but this coordinate system is already embedded into another one\")\n    this.embeddedInto = into;\n    this.embedding = embedding;\n  }\n\n  public box(xy0: [Coordinate, Coordinate], xy1: [Coordinate, Coordinate]) {\n    return new Box(this, xy0, xy1);\n  }\n\n  public point(x: Coordinate, y: Coordinate) {\n    return new Point(this, x, y);\n  }\n\n  public embed(box: Box): Box;\n  public embed(point: Point): Point;\n  public embed(vector: Vector): Vector;\n  public embed(segment: Segment): Segment;\n  public embed(line: Line): Line;\n  public embed(value: Box | Point | Vector | Segment | Line) : Box | Point | Vector | Segment | Line {\n    if (value instanceof Box) {\n      let box = value as Box;\n      return new Box(this, this.embed(box.low).xy, this.embed(box.high).xy);\n    } else if (value instanceof Point) {\n      let point = value as Point;\n      while(true) {\n        if (this === point.parent)\n          return point;\n\n        if (point.parent.embeddedInto === null)\n          break;\n\n        point = new Point(point.parent.embeddedInto,\n          point.value.transform(point.parent.embedding!));\n      }\n\n      if (this.embeddedInto === null) {\n        throw Error(`point (${point.value.x}, ${point.value.y}) cannot be embedded from coordinate system ${JSON.stringify(point.parent)} into this coordinate system ${JSON.stringify(this)}; no relation between the coordinate systems could be established.`)\n      }\n\n      point = this.embeddedInto.embed(point);\n\n      return new Point(this, ...CoordinateSystem.inverse(this.embedding!).transform([point.x, point.y]));\n    } else if (value instanceof Vector) {\n      const point = this.embed(new Point(value.parent, value.x, value.y));\n      const origin = this.embed(new Point(value.parent, 0, 0));\n      return new Vector(this, point.x - origin.x, point.y - origin.y);\n    } else if (value instanceof Segment) {\n      return new Segment(this, this.embed(value.start).value, this.embed(value.end).value);\n    } else if (value instanceof Line) {\n      return new Line(this.embed(value.pt), this.embed(value.norm));\n    }\n\n    throw Error(`cannot embed this type of object into coordinate system yet`);\n  }\n}\n\n\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Box from \"./Box\";\nimport Point from \"./Point\";\n\nexport default class Viewport {\n  public constructor(ideal?: CoordinateSystem, width: number = 640, height: number = 640) {\n    this.idealCoordinateSystem = ideal || new CoordinateSystem(true);\n    if (!this.idealCoordinateSystem.positive)\n      throw new Error(\"ideal coordinate system must be positive\");\n    this.viewportCoordinateSystem = new CoordinateSystem(false);\n    this.width = width;\n    this.height = height;\n    this.visible = new Box(this.viewportCoordinateSystem, [0, 0], [width, height]);\n    this.focused = this.visible;\n\n    this.idealCoordinateSystem.embedInto(this.viewportCoordinateSystem);\n  }\n\n  // Resize the viewport while keeping the currently focused box unchanged.\n  public resize(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n\n    this.focus(this.focused);\n  }\n\n  public focus(focused: Box) {\n    this.focused = this.idealCoordinateSystem.embed(focused);\n    this.visible = this.idealCoordinateSystem.embed(this.focused.contain(this.width / this.height));\n    // We now need to embed the \"ideal\" coordinate system into the actual\n    // \"viewport\" coordinate system so that the \"visible\" box fills the (0,\n    // 0), (width, height) box.\n    this.idealCoordinateSystem.embedInto(this.viewportCoordinateSystem, new Flatten.Matrix(\n      this.width / this.visible.width, 0,\n      0, -this.height / this.visible.height,\n      -this.visible.low.x * this.width / this.visible.width,\n      this.visible.high.y * this.height / this.visible.height,\n    ));\n  }\n\n  public zoom(factor: number, center?: Point) {\n    if (center === undefined) {\n      center = this.viewport.center;\n      center = this.focused.parent.embed(center);\n\n      const width = this.focused.width / factor;\n      const height = this.focused.height / factor;\n\n      this.focus(new Box(this.focused.parent,\n        [center.x - width / 2, center.y - height / 2],\n        [center.x + width / 2, center.y + height / 2]));\n    } else {\n      center = this.idealCoordinateSystem.embed(center);\n      const centerBefore = this.viewportCoordinateSystem.embed(center);\n      this.zoom(factor);\n      const centerAfter = this.viewportCoordinateSystem.embed(center);\n      \n      this.focus(this.viewport.translate(centerAfter.x - centerBefore.x, centerAfter.y - centerBefore.y));\n    }\n  }\n\n  public embed(point: Point) : Point;\n  public embed(box: Box) : Box;\n  public embed(value: Point | Box) : Point | Box {\n    return this.viewportCoordinateSystem.embed(value as any);\n  }\n\n  public get viewport() : Box {\n    return this.viewportCoordinateSystem.embed(this.visible);\n  }\n\n  private width: number;\n  private height: number;\n  // The underlying ideal coordinate system that is stable under resizing the\n  // viewport, translating it and such.\n  public readonly idealCoordinateSystem: CoordinateSystem;\n  // Coordinates on screen, i.e., inside the viewport starting at (0, 0) in\n  // the top-left corner.\n  public readonly viewportCoordinateSystem: CoordinateSystem;\n  // The currently focused rectangle, centered in the viewport.\n  private focused: Box;\n  // The currently visible rectangle.\n  private visible: Box;\n};\n","\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport Viewport from \"../geometry/Viewport\";\nimport CoordinateSystem from \"../geometry/CoordinateSystem\";\nimport Point from \"../geometry/Point\";\nimport Box from \"../geometry/Box\";\nimport panzoom from \"pan-zoom/index.js\";\n\n@Component\nexport default class PanZoom extends Vue {\n  @Prop({required: true, type: CoordinateSystem}) coordinateSystem!: CoordinateSystem;\n  @Prop({required: true, type: Box}) focus!: Box;\n\n  private observer = new ResizeObserver(this.resize);\n  private unpanzoom = () => {};\n  protected pan = false;\n\n  private resize() {\n    this.viewport.resize(\n      Math.min((this.$refs.viewport as HTMLElement).clientWidth, window.innerWidth),\n      Math.min((this.$refs.viewport as HTMLElement).clientHeight, window.innerHeight));\n  }\n\n  @Watch(\"focus\", {immediate: true})\n  refocus() {\n    this.viewport.focus(this.focus); \n  }\n\n  mounted() {\n    this.unpanzoom = panzoom(this.$el, this.panzoom);\n    this.observer.observe(this.$el);\n    this.resize();\n  }\n\n  beforeDestroy() {\n    this.unpanzoom();\n    this.observer.unobserve(this.$el);\n  }\n\n  onMouseDown() {\n    this.pan = true;\n  }\n\n  onMouseUp() {\n    this.pan = false;\n  }\n\n  get viewport() {\n    return new Viewport(this.coordinateSystem);\n  }\n\n  private panzoom(e: any) {\n    // We either zoom or pan; mixing this is probably confusing.\n    if (e.dz !== 0) {\n      this.viewport.zoom(Math.exp(-e.dz/96), new Point(this.viewport.viewportCoordinateSystem, e.x, e.y));\n    } else {\n      this.viewport.focus(this.viewport.viewport.translate(-e.dx, -e.dy));\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PanZoom.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PanZoom.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./PanZoom.vue?vue&type=template&id=43f8a8ee&scoped=true&\"\nimport script from \"./PanZoom.vue?vue&type=script&lang=ts&\"\nexport * from \"./PanZoom.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./PanZoom.vue?vue&type=style&index=0&id=43f8a8ee&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"43f8a8ee\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('pan-zoom',{staticClass:\"surface\",attrs:{\"coordinate-system\":_vm.idealCoordinateSystem,\"focus\":_vm.focus},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar viewport = ref.viewport;\nreturn [_c('surface',{attrs:{\"viewport\":viewport,\"surface\":_vm.surface,\"automorphisms\":_vm.automorphisms,\"components\":_vm.components,\"inner\":_vm.inner},on:{\"layout\":_vm.onLayoutChanged,\"svg\":_vm.onSVGChanged}})]}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport xor from \"lodash-es/xor\";\n\n// A permutation of T where T is something that can be safely converted to a\n// key in an object, i.e., T should probably be number or string.\nexport default class Permutation<T> {\n  public static fromCycles<T>(cycles: Array<T[]>) : Permutation<T> {\n    const mapping = [] as Array<[T, T]>;\n    for (let cycle of cycles)\n      for (let i = 0; i < cycle.length; i++)\n        mapping.push([cycle[i], cycle[(i + 1) % cycle.length]]);\n    return Permutation.fromMapping(mapping);\n  }\n\n  public static fromMapping<T>(mapping: Array<[T, T]>) : Permutation<T> {\n    return new Permutation<T>(mapping);\n  }\n\n  private constructor(mapping: Array<[T, T]>) {\n    this.mapping = {};\n    this.inverse = {};\n\n    for (let entry of mapping) {\n      if (entry[0] in this.mapping)\n        throw Error(`${entry} specified more than once in mapping domain`);\n      if (entry[1] in this.inverse)\n        throw Error(`${entry} specified more than once in mapping codomain`);\n      this.mapping[String(entry[0])] = entry[1];\n      this.inverse[String(entry[1])] = entry[0];\n    }\n\n    if (xor(Object.keys(this.mapping), Object.keys(this.inverse)).length !== 0)\n      throw Error(`domain {${Object.keys(this.mapping)}} and codomain {${Object.keys(this.inverse)}} of permutation are not identical`);\n\n    this.cycles = [];\n    for (let [a, b] of mapping) {\n      if (this.cycles.find((cycle) => cycle.includes(a)))\n        continue;\n      const cycle = [a, b];\n      while(true) {\n        const x = cycle[cycle.length - 1];\n        if (cycle[0] == x) {\n          cycle.pop();\n          break;\n        }\n        cycle.push(this.mapping[String(x)]);\n      }\n      this.cycles.push(cycle);\n    }\n  }\n\n  public image(x: T) {\n    return this.mapping[String(x)];\n  }\n\n  public preimage(x: T) {\n    return this.inverse[String(x)];\n  }\n\n  public get domain() : T[] {\n    return Object.values(this.mapping);\n  }\n\n  public readonly cycles : Array<T[]>;\n\n  private readonly mapping : { [key: string]: T }; \n  private readonly inverse : { [key: string]: T };\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport xor from \"lodash-es/xor\";\n\nimport HalfEdge from \"./HalfEdge\";\nimport Permutation from \"./Permutation\";\n\nimport Vector, { VectorSchema } from \"../Vector\";\nimport Point from \"../Point\";\nimport CoordinateSystem from '../CoordinateSystem';\n\nexport interface FlatTriangulationSchema {\n  vertices: Array<HalfEdge[]>,\n  vectors: { [key: number]: VectorSchema }\n};\n\nexport default class FlatTriangulation {\n  public static parse(yaml: FlatTriangulationSchema, coordinateSystem: CoordinateSystem) : FlatTriangulation {\n    return new FlatTriangulation(\n      Permutation.fromCycles(yaml.vertices),\n      Object.fromEntries(Object.entries(yaml.vectors).map(([halfEdge, vector]) => [halfEdge, Vector.parse(vector, coordinateSystem)]))\n    );\n  }\n\n  private constructor(vertices: Permutation<HalfEdge>, vectors: {[key: string]: Vector}) {\n    this.vertices = vertices;\n    this.halfEdges = vertices.domain;\n    this.faces = Permutation.fromMapping(this.halfEdges.map((he) => [-this.vertices.image(he), he]));\n\n    this.vectors = vectors;\n\n    if (xor(\n      [...Object.keys(this.vectors), ...Object.keys(this.vectors).map((he) => String(-Number(he)))],\n      this.halfEdges.map((he) => String(he))\n    ).length !== 0)\n      throw Error(`Provided vectors {${Object.keys(this.vectors)}} and present half edges {${this.halfEdges}} do not coincide.`);\n\n    const coordinateSystem = this.vectors['1'].parent;\n\n    for (const face of this.faces.cycles) {\n      const sum = face.reduce((sum, he) => sum.translate(this.vector(he)), new Point(coordinateSystem, 0, 0));\n      if (!sum.equalTo(new Point(coordinateSystem, 0, 0), 1e-6))\n        throw Error(`Face ${face} is not closed. Going around the face gives (${sum.x}, ${sum.y}) but should be zero.`);\n      // TODO: Wiggle the half edges to a place to make the faces closed in double coordinates.\n    }\n  }\n\n  public vector(halfEdge: HalfEdge): Vector {\n    return this.vectors[halfEdge] || this.vectors[-halfEdge].invert();\n  }\n\n  public readonly vertices: Permutation<HalfEdge>;\n  public readonly halfEdges : HalfEdge[];\n  public readonly faces : Permutation<HalfEdge>;\n  private readonly vectors : {[key: string]: Vector };\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\n\nimport HalfEdge from \"./HalfEdge\";\n\ntype HalfEdgeMap = { [preimage: number]: HalfEdge };\n\nexport interface AutomorphismSchema {\n  halfEdges: HalfEdgeMap,\n};\n\n/*\n * An automorphism of a Flat Triangulation.\n */\nexport default class Automorphism {\n  public static parse(yaml: AutomorphismSchema): Automorphism {\n    return new Automorphism(yaml.halfEdges);\n  }\n\n  private constructor(halfEdges: HalfEdgeMap ) {\n    const set = (preimage: HalfEdge, image: HalfEdge) => {\n      if (halfEdges.hasOwnProperty(preimage))\n        assert(halfEdges[preimage] === image);\n      halfEdges[preimage] = image;\n    };\n\n    for (const [key, image] of Object.entries(halfEdges)) {\n      const preimage = Number(key);\n      set(-preimage, -image);\n      set(image, preimage);\n      set(-image, -preimage);\n    }\n\n    this.halfEdgeMap = halfEdges;\n  }\n\n  public static orbit(halfEdge: HalfEdge, automorphisms: Automorphism[]) {\n    const orbit = [halfEdge];\n\n    for (let i = 0; i < orbit.length; i++) {\n      const preimage = orbit[i];\n      for (const automorphism of automorphisms) {\n        const image = automorphism.halfEdgeMap[preimage];\n        if (image != null && !orbit.includes(image))\n          orbit.push(image);\n      }\n    }\n\n    return orbit;\n  }\n\n  // The mapping of half edges under the automorphism.\n  // This mapping might not contain all half edges if the automorphism is only\n  // defined on the level of the Delaunay cells of the triangulation.\n  public readonly halfEdgeMap: HalfEdgeMap;\n}\n\n\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport HalfEdge, { HalfEdgeSchema } from \"./HalfEdge\";\nimport Vector, { VectorSchema } from \"../Vector\";\nimport CoordinateSystem from '../CoordinateSystem';\n\nexport interface SaddleConnectionSchema {\n  source: HalfEdgeSchema,\n  target: HalfEdgeSchema,\n  vector: VectorSchema,\n  crossings: {\n    halfEdge: number,\n    at: number,\n  }[]\n};\n\nexport default class SaddleConnection {\n  public static parse(yaml: SaddleConnectionSchema, coordinateSystem: CoordinateSystem): SaddleConnection {\n    return new SaddleConnection(yaml.source, yaml.target, Vector.parse(yaml.vector, coordinateSystem), yaml.crossings);\n  }\n\n  private constructor(source: HalfEdge, target: HalfEdge, vector: Vector, crossings: {halfEdge: HalfEdge, at: number}[]) {\n    this.source = source;\n    this.target = target;\n    this.vector = vector;\n    this.crossings = Object.freeze(crossings);\n  }\n\n  public readonly source: HalfEdge;\n  public readonly target: HalfEdge;\n  public readonly vector: Vector;\n  // The sequence of half edges crossed with approximate\n  // relative point of crossing in [0, 1].\n  public readonly crossings: readonly {halfEdge: HalfEdge, at: number}[];\n}\n\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport SaddleConnection, { SaddleConnectionSchema } from \"./SaddleConnection\";\nimport CoordinateSystem from '../CoordinateSystem';\nimport HalfEdge from \"./HalfEdge\";\n\nexport interface Touch {\n  halfEdge: HalfEdge;\n  index: number;\n}\n\nexport interface FlowConnectionSchema extends SaddleConnectionSchema {\n  vertical: boolean;\n  boundary: boolean;\n  touches: Touch[];\n}\n\nexport default class FlowConnection {\n  public static parse(yaml: FlowConnectionSchema, coordinateSystem: CoordinateSystem): FlowConnection {\n    return new FlowConnection(SaddleConnection.parse(yaml, coordinateSystem), yaml.vertical, yaml.boundary, yaml.touches);\n  }\n\n  private constructor(connection: SaddleConnection, vertical: boolean, boundary: boolean, touches: Touch[]) {\n    this.connection = connection;\n    this.vertical = vertical;\n    this.boundary = boundary;\n    this.touches = Object.freeze(touches);\n  }\n\n  public readonly connection: SaddleConnection;\n  public readonly vertical: boolean;\n  public readonly boundary: boolean;\n\n  // The sequence of half edges crossed/touched (most half edges show up in\n  // pairs) and the order of this crossing/touching in comparison to all the\n  // others of this component on that half edge. Typically, starts with\n  // [source half edge, 0], then the first [half edge crossed, 0] if this is\n  // the right-most crossing of that half edge, then [-half edge crossed,\n  // 0], ... until the [target half edge, 0].\n  public readonly touches: readonly Touch[];\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport CoordinateSystem from '../CoordinateSystem';\nimport FlowConnection, { FlowConnectionSchema } from \"./FlowConnection\";\nimport HalfEdge, { HalfEdgeSchema } from './HalfEdge';\n\nexport default class FlowComponent {\n  public static parse(yaml: {\n    cylinder: boolean,\n    perimeter: FlowConnectionSchema[],\n    inside: HalfEdgeSchema[],\n  }, coordinateSystem: CoordinateSystem) : FlowComponent {\n    return new FlowComponent(yaml.cylinder, yaml.perimeter.map(connection => FlowConnection.parse(connection, coordinateSystem)), yaml.inside);\n  }\n\n  private constructor(cylinder: boolean, perimeter: FlowConnection[], inside: HalfEdge[]) {\n    this.cylinder = cylinder;\n    this.perimeter = perimeter;\n    this.inside = inside;\n  }\n\n  public readonly cylinder: boolean;\n  public readonly perimeter: FlowConnection[];\n  public readonly inside: HalfEdge[];\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('svg',{ref:\"svg\",attrs:{\"width\":_vm.viewport.width,\"height\":_vm.viewport.height}},[(_vm.layout != null)?_c('flat-triangulation-component',{attrs:{\"surface\":_vm.layout}},[(_vm.layout != null)?_c('g',_vm._l((_vm.visibleComponents),function(component,i){return _c('flow-component-component',{key:i,attrs:{\"color\":_vm.palette.color(i),\"component\":component,\"layout\":_vm.layout,\"surface\":_vm.surface}})}),1):_vm._e()]):_vm._e()],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"FlatTriangulation\"},[_c('g',_vm._l((_vm.faces),function(face,i){return _c('face',{key:i,attrs:{\"vertices\":face}})}),1),_vm._t(\"default\"),_c('g',_vm._l((_vm.halfEdges),function(halfEdge){return _c('half-edge-component',{key:halfEdge,attrs:{\"inner\":_vm.surface.layout(halfEdge).inner,\"surface\":_vm.surface,\"half-edge\":halfEdge,\"source-indicator\":_vm.sourceIndicators.includes(halfEdge)}})}),1)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ngon',{attrs:{\"vertices\":_vm.vertices}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('polygon',{attrs:{\"points\":_vm.points}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\nimport { Component, Inject, Prop, Vue } from \"vue-property-decorator\";\n\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class Ngon extends Vue {\n  @Prop({ required: true, type: Array }) vertices!: Point[];\n\n  get points() {\n    return this.vertices.map((xy) => {\n      xy = this.svg(xy); \n      return `${xy.x},${xy.y}`;\n    }).join(\",\");\n  }\n\n  @Inject()\n  svg!: (xy: Point) => Point;\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Ngon.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Ngon.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Ngon.vue?vue&type=template&id=30284d09&\"\nimport script from \"./Ngon.vue?vue&type=script&lang=ts&\"\nexport * from \"./Ngon.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\n\nimport Point from \"@/geometry/Point\";\nimport Ngon from \"./svg/Ngon.vue\";\n\n@Component({\n  components: { Ngon }\n})\nexport default class Face extends Vue {\n  @Prop({ required: true, type: Array }) vertices!: Point[];\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Face.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Face.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Face.vue?vue&type=template&id=efce637c&scoped=true&\"\nimport script from \"./Face.vue?vue&type=script&lang=ts&\"\nexport * from \"./Face.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Face.vue?vue&type=style&index=0&id=efce637c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"efce637c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"HalfEdge\",class:{ inner: _vm.inner },on:{\"click\":_vm.onClick,\"mouseenter\":_vm.onMouseEnter,\"mouseleave\":_vm.onMouseLeave,\"mousemove\":_vm.onMouseMove}},[_c('extended-click-area',[(_vm.halfEdgeConfiguration(_vm.halfEdge).state.label)?_c('g',{staticClass:\"label\"},[_c('segment-label',{attrs:{\"at\":_vm.segment}},[_vm._v(_vm._s(_vm.halfEdgeConfiguration(_vm.halfEdge).state.label))])],1):_vm._e(),(_vm.indicator(_vm.halfEdge))?_c('arrow',{staticClass:\"indicator\",attrs:{\"segment\":_vm.indicator(_vm.halfEdge)}}):_vm._e(),(_vm.inner && _vm.indicator(-_vm.halfEdge))?_c('arrow',{staticClass:\"indicator\",attrs:{\"segment\":_vm.indicator(-_vm.halfEdge)}}):_vm._e(),(_vm.sourceIndicator)?_c('arrow',{staticClass:\"source\",attrs:{\"segment\":_vm.source}}):_vm._e(),_c('segment-component',{class:{ selected: _vm.selected, glued: _vm.glued },attrs:{\"segment\":_vm.segment}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('line',{attrs:{\"x1\":_vm.coords[0],\"y1\":_vm.coords[1],\"x2\":_vm.coords[2],\"y2\":_vm.coords[3]}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\nimport { Component, Inject, Prop, Vue } from \"vue-property-decorator\";\n\nimport Segmnt from \"@/geometry/Segment\";\n\n@Component\nexport default class Segment extends Vue {\n  @Prop({ required: true, type: Object }) segment!: Segmnt;\n\n  // For performance reasons we compute all coordinates at once since this\n  // gets called a lot.\n  get coords() {\n    const embedded = this.svg(this.segment);\n    return [embedded.start.x, embedded.start.y, embedded.end.x, embedded.end.y];\n  }\n\n  @Inject()\n  svg!: (s: Segmnt) => Segmnt;\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Segment.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Segment.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Segment.vue?vue&type=template&id=6290d963&\"\nimport script from \"./Segment.vue?vue&type=script&lang=ts&\"\nexport * from \"./Segment.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{attrs:{\"transform\":_vm.transformation}},[_c('text',[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nimport { Vue, Component, Inject, Prop } from \"vue-property-decorator\";\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class HalfEdgeLabel extends Vue {\n\t@Prop({required: true, type: Object}) at!: Segment;\n\n\tget position() {\n\t\tconst midpoint = this.at.middle;\n\t\tlet normal = this.svg(this.at.tangentInStart.rotate90CCW()).normalize();\n\t\treturn this.svg(midpoint).translate(normal.multiply(12));\n\t}\n\n\tget transformation() {\n\t\treturn `translate(${this.position.x} ${this.position.y}) translate(6 4)`;\n\t}\n\n  @Inject()\n  svg!: ((xy: Point) => Point) & ((xy: Vector) => Vector);\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SegmentLabel.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SegmentLabel.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SegmentLabel.vue?vue&type=template&id=03911908&scoped=true&\"\nimport script from \"./SegmentLabel.vue?vue&type=script&lang=ts&\"\nexport * from \"./SegmentLabel.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SegmentLabel.vue?vue&type=style&index=0&id=03911908&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"03911908\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"arrow\"},[_c('line',{attrs:{\"x1\":_vm.x1,\"y1\":_vm.y1,\"x2\":_vm.x2,\"y2\":_vm.y2}}),_c('path',{attrs:{\"d\":\"M 0 -3 L 12 0 L 0 3 z\",\"transform\":_vm.atEnd,\"stroke-width\":\"0\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\nimport { Prop, Vue, Component, Inject } from \"vue-property-decorator\";\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class SVGArrow extends Vue {\n\t@Prop({required: true, type: Object}) segment!: Segment;\n\n  get x1() {\n    return this.svg(this.segment.start).x;\n  }\n\n  get y1() {\n    return this.svg(this.segment.start).y;\n  }\n\n  get endWithoutHead() {\n    return this.svg(this.segment.end).translate(this.svg(this.segment.tangentInEnd).normalize().multiply(12));\n  }\n\n  get x2() {\n    return this.svg(this.endWithoutHead).x;\n  }\n\n  get y2() {\n    return this.svg(this.endWithoutHead).y;\n  }\n\n\tget atEnd() {\n    return `translate(${this.x2} ${this.y2}) rotate(${-this.segment.tangentInStart.angleTo(new Vector(this.segment.parent, 1, 0))*360 / (2*Math.PI)} 0 0)`;\n\t}\n\n  @Inject()\n  svg!: ((xy: Point) => Point) & ((xy: Vector) => Vector);\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Arrow.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Arrow.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Arrow.vue?vue&type=template&id=4e3f5919&scoped=true&\"\nimport script from \"./Arrow.vue?vue&type=script&lang=ts&\"\nexport * from \"./Arrow.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Arrow.vue?vue&type=style&index=0&id=4e3f5919&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4e3f5919\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"extended-click-area\",on:{\"mousedown\":function($event){$event.preventDefault();$event.stopPropagation();return (function (e) { return _vm.$emit('mousedown', e); }).apply(null, arguments)},\"click\":function (e) { return _vm.$emit('click', e); },\"mouseenter\":function (e) { return _vm.$emit('mouseenter', e); },\"mouseleave\":function (e) { return _vm.$emit('mouseleave', e); },\"mousemove\":function (e) { return _vm.$emit('mousemove', e); }}},[_vm._t(\"default\"),_c('g',{staticClass:\"extension\"},[_vm._t(\"default\")],2)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./ExtendedClickArea.vue?vue&type=template&id=27599fc9&scoped=true&\"\nvar script = {}\nimport style0 from \"./ExtendedClickArea.vue?vue&type=style&index=0&id=27599fc9&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"27599fc9\",\n  null\n  \n)\n\nexport default component.exports","import Segment from \"@/geometry/Segment\";\n\nexport interface IHalfEdgeConfiguration {\n  interactions: {\n    click: (ev: MouseEvent, segment: Segment) => void,\n    enter: (ev: MouseEvent, segment: Segment) => void,\n    leave: (ev: MouseEvent, segment: Segment) => void,\n    hover: (ev: MouseEvent, segment: Segment) => void,\n  },\n  state: {\n    selected: boolean,\n    glued: boolean,\n    label: string | null,\n    indicator: number | null,\n  },\n};\n\nexport const DefaultHalfEdgeConfiguration: IHalfEdgeConfiguration = {\n  interactions: {\n    click: () => {},\n    enter: () => {},\n    leave: () => {},\n    hover: () => {},\n  },\n  state: {\n    selected: false,\n    glued: false,\n    label: null,\n    indicator: null,\n  }\n};\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Inject, Vue } from \"vue-property-decorator\";\n\nimport FlatTriangulationLayout from \"../geometry/layout/FlatTriangulationLayout\";\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport SegmentComponent from \"./svg/Segment.vue\";\nimport HalfEdge from \"@/geometry/triangulation/HalfEdge\";\nimport SegmentLabel from \"./svg/SegmentLabel.vue\";\nimport Arrow from \"./svg/Arrow.vue\";\n\nimport ExtendedClickArea from \"./svg/ExtendedClickArea.vue\";\nimport { IHalfEdgeConfiguration, DefaultHalfEdgeConfiguration } from \"./HalfEdgeConfiguration\";\n\n@Component({\n  components: { Arrow, ExtendedClickArea, SegmentComponent, SegmentLabel },\n})\nexport default class HalfEdgeComponent extends Vue {\n  @Prop({required: true, type: Object}) surface!: FlatTriangulationLayout;\n  @Prop({required: true, type: Number}) halfEdge!: HalfEdge;\n  @Prop({required: true, type: Boolean}) inner!: boolean;\n  @Prop({required: false, type: Boolean, default: false}) sourceIndicator!: boolean;\n\n  onClick(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.click(ev, this.segment);\n  }\n\n  onMouseEnter(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.enter(ev, this.segment);\n  }\n\n  onMouseLeave(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.leave(ev, this.segment);\n  }\n\n  onMouseMove(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.hover(ev, this.segment);\n  }\n\n  get selected() {\n    return this.halfEdgeConfiguration(this.halfEdge).state.selected;\n  }\n\n  get glued() {\n    return this.halfEdgeConfiguration(this.halfEdge).state.glued;\n  }\n\n  get segment() {\n    return this.surface.layout(this.halfEdge).segment;\n  }\n\n  indicator(halfEdge: HalfEdge) {\n    const segment = this.surface.layout(halfEdge).segment;\n    let indicator = this.halfEdgeConfiguration(halfEdge).state.indicator;\n    if (indicator) {\n\t\t  const end = segment.at(indicator);\n\t\t  const start = end.translate(this.svg(segment.tangentInStart.rotate90CCW()).normalize().multiply(10));\n      return new Segment(start, end);\n    }\n\t}\n\n  get source() {\n    const segment = this.segment;\n\t\tconst end = segment.at(0);\n\t\tconst start = end.translate(this.svg(segment.tangentInStart.rotate90CCW()).normalize().multiply(10));\n    return new Segment(start, end);\n  }\n\n  @Inject({ default: () => DefaultHalfEdgeConfiguration })\n  halfEdgeConfiguration!: (halfEdge: HalfEdge) => IHalfEdgeConfiguration;\n\n  @Inject()\n  svg!: (xy: Vector) => Vector;\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HalfEdge.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HalfEdge.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./HalfEdge.vue?vue&type=template&id=21a2eee6&\"\nimport script from \"./HalfEdge.vue?vue&type=script&lang=ts&\"\nexport * from \"./HalfEdge.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./HalfEdge.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\nimport { Vue, Component, Prop } from \"vue-property-decorator\";\nimport Face from \"./Face.vue\";\nimport HalfEdgeComponent from \"./HalfEdge.vue\";\nimport FlatTriangulationLayout from \"../geometry/layout/FlatTriangulationLayout\";\n\n@Component({\n  components: {\n    Face,\n    HalfEdgeComponent,\n  }\n})\nexport default class FlatTriangulation extends Vue {\n  @Prop({required: true, type: Object}) surface!: FlatTriangulationLayout;\n\n  get faces() {\n    let faces = this.surface.surface.faces.cycles;\n    faces = faces.filter((face) => face.every((he) => this.surface.primary.includes(he)));\n    return faces.map((face) => face.map((he) => this.surface.layout(he).segment.end));\n  }\n\n  get halfEdges() {\n    return this.surface.surface.halfEdges.filter((halfEdge) => {\n      if (!this.surface.primary.includes(halfEdge))\n        return false;\n      if (!this.surface.layout(halfEdge).inner)\n        return true;\n      return halfEdge > 0;\n    });\n  }\n\n  // Return a list of vertex indicators where half edges meet that are almost collinear.\n  get sourceIndicators() {\n    return this.halfEdges.filter((a) => {\n      if (this.surface.layout(a).inner) return false;\n\n      const s = this.surface.layout(a).segment;\n      const v = s.tangentInStart;\n      return this.halfEdges.some((b) => {\n        if (b === a) return false;\n        if (this.surface.layout(b).inner) return false;\n\n        const t = this.surface.layout(b).segment;\n\n        if (!s.start.on(t)) return false;\n\n        const w = t.tangentInStart;\n        const angle = v.angleTo(w);\n        const degree = Math.PI / 180;\n        return angle < degree || angle > 359 * degree;\n      })\n    });\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlatTriangulation.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlatTriangulation.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FlatTriangulation.vue?vue&type=template&id=2d5dfdff&\"\nimport script from \"./FlatTriangulation.vue?vue&type=script&lang=ts&\"\nexport * from \"./FlatTriangulation.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FlatTriangulation.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"FlowComponent\"},[_c('g',{style:({ '--color': _vm.color })},_vm._l((_vm.patches),function(vertices,i){return _c('ngon',{key:i,attrs:{\"vertices\":vertices}})}),1),_c('g',{staticClass:\"boundary\"},_vm._l((_vm.perimeter),function(connection,i){return _c('saddle-connection-component',{key:i,attrs:{\"connection\":connection,\"layout\":_vm.layout,\"color\":_vm.color}})}),1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"SaddleConnection\"},_vm._l((_vm.segments),function(segment,i){return _c('segment-component',{key:i,attrs:{\"segment\":segment}})}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nimport FlatTriangulationLayout from '@/geometry/layout/FlatTriangulationLayout';\nimport  { Vue, Component, Prop } from \"vue-property-decorator\";\nimport SaddleConnectionData from \"../geometry/triangulation/SaddleConnection\";\nimport SegmentComponent from \"./svg/Segment.vue\";\nimport Segment from \"../geometry/Segment\";\nimport Point from \"../geometry/Point\";\nimport Line from \"../geometry/Line\";\nimport Vector from \"../geometry/Vector\";\n\n@Component({\n  components: {\n    SegmentComponent,\n  }\n})\nexport default class FlowComponent extends Vue {\n  @Prop({ required: true }) connection!: SaddleConnectionData;\n  @Prop({ required: true }) layout!: FlatTriangulationLayout;\n\n  get segments(): Segment[] {\n    const segments = [];\n\n    const vector = this.connection.vector;\n    const crossings = [...this.connection.crossings];\n\n    let start = this.layout.layout(this.connection.source).segment.start;\n    const end = crossings.length > 0 ? this.layout.layout(this.connection.target).segment.start : this.layout.layout(this.connection.source).segment.end;\n\n    // TODO: Use at() instead of halfEdge() to construct the point of intersection.\n    while(crossings.length) {\n\t\t  const crossing = crossings.shift()!;\n      if (this.layout.layout(crossing.halfEdge).inner)\n        continue;\n\n      // Since we are crossing an outer half edge, we compute the intersection\n      // of the saddle connection ray with it and add it to segments.\n      const line = new Line(start, start.translate(vector));\n      const crossingEdge = this.layout.layout(crossing.halfEdge).segment;\n      const crossingLine = new Line(crossingEdge.start, crossingEdge.end);\n      const intersection = line.intersect(crossingLine);\n      if (intersection === null) {\n        throw Error(\"saddle connection must intersect every crossing\");\n      }\n      segments.push(new Segment(start, intersection));\n\t\t  \n      // Now, we move the intersection point to the corresponding half-edge\n      // and repeat.\n      const alongHalfEdge = new Vector(intersection.parent, this.layout.layout(crossing.halfEdge).segment.start, intersection as Point);\n      start = this.layout.layout(-crossing.halfEdge).segment.end.translate(alongHalfEdge);\n    }\n\n    segments.push(new Segment(start, end));\n    \n    return segments;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SaddleConnection.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SaddleConnection.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SaddleConnection.vue?vue&type=template&id=bddbc200&\"\nimport script from \"./SaddleConnection.vue?vue&type=script&lang=ts&\"\nexport * from \"./SaddleConnection.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport assert from \"assert\";\nimport Flatten from \"@flatten-js/core\";\nimport  { Vue, Component, Prop, Watch } from \"vue-property-decorator\";\nimport FlowComponentData from \"../geometry/triangulation/FlowComponent\";\nimport { Touch } from \"../geometry/triangulation/FlowConnection\";\nimport SaddleConnectionComponent from \"./SaddleConnection.vue\";\nimport FlatTriangulationLayout from \"../geometry/layout/FlatTriangulationLayout\";\nimport Ngon from \"./svg/Ngon.vue\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\nimport Point from \"../geometry/Point\";\nimport FlatTriangulation from \"../geometry/triangulation/FlatTriangulation\";\n\n@Component({\n  components: {\n    SaddleConnectionComponent,\n    Ngon,\n  },\n})\nexport default class FlowComponent extends Vue {\n  @Prop({ required: true }) component!: FlowComponentData;\n  @Prop({ required: true }) layout!: FlatTriangulationLayout;\n  @Prop({ required: true }) surface!: FlatTriangulation;\n  @Prop({ required: false, type: String, default:\"orange\" }) color!: string;\n\n  ats!: {[key: number]: number[]};\n  // Maps a half edge to the touches on that half edge in order.\n  touches!: {[key: number]: Touch[]};\n\n  get perimeter() {\n    let perimeter = this.component.perimeter;\n    if (this.component.cylinder)\n      // For cylinders do not show the connections at the top & bottom of the cylinder.\n      perimeter = perimeter.filter((connection) => connection.vertical);\n    else\n      // For minimal/undetermined components, do not show the inner structure of the component.\n      perimeter = perimeter.filter((connection) => connection.boundary);\n\n    return perimeter.map((connection) => connection.connection);\n  }\n\n  @Watch(\"layout\", { immediate: true })\n  resetCaches() {\n    this.ats = undefined as any;\n    this.touches = undefined as any;\n    this.ensureCaches();\n  }\n\n  ensureCaches() {\n    if (this.touches == null) {\n      this.touches = {};\n      for (const halfEdge of this.surface.halfEdges)\n        this.touches[halfEdge] = [];\n\n      for (const connection of this.component.perimeter) {\n        for (const touch of connection.touches) {\n          this.touches[touch.halfEdge][touch.index] = touch;\n        }\n      }\n    }\n    if (this.ats == null) {\n      this.ats = {};\n      for (const connection of this.component.perimeter) {\n        for (let i = 0; i < connection.touches.length; i++) {\n          const touch = connection.touches[i];\n          let at = 0;\n          if (i != 0 && i != connection.touches.length - 1) {\n            at = connection.connection.crossings[Math.floor((i - 1) / 2)].at;\n            if (i % 2 == 0)\n              at = 1 - at;\n          }\n          if (this.ats[touch.halfEdge] === undefined) this.ats[touch.halfEdge] = [];\n          this.ats[touch.halfEdge][touch.index] = at;\n        }\n      }\n    }\n  }\n\n  // Return the relative length in [0, 1] where `touch` intersects its half edge.\n  private at(touch: Touch): number {\n    console.assert(this.ats != null);\n    return this.ats[touch.halfEdge][touch.index];\n  }\n\n  // Return the triangle [A, B, C] completing the two touches `a`, `b`.\n  private patch(a: Touch, b: Touch): Point[] | null {\n    // Given `at` in [0, 1] returns the actual point on `halfEdge` that is that far on `halfEdge`.\n    const layout = (halfEdge: HalfEdge, at: number) => this.layout.layout(halfEdge).segment.at(at);\n\n    const isHalfEdge = a.halfEdge === -b.halfEdge;\n\n    const A = layout(a.halfEdge, this.at(a));\n    let B = isHalfEdge ? layout(a.halfEdge, 1) : layout(b.halfEdge, this.at(b));\n    let C = B;\n\n    let scenario = \"undefined\";\n\n    if (isHalfEdge) {\n      console.assert(this.at(a) === 0, \"Edge-parallel connection must start at vertex.\")\n      console.assert(this.at(b) === 0, \"Edge-parallel connection must end at vertex.\");\n    } else {\n      console.assert(a.halfEdge !== b.halfEdge, `Saddle Connection cannot cross the half edge ${a.halfEdge} twice in a row.`);\n    }\n\n    const atouches = this.touches[a.halfEdge];\n    const btouches = this.touches[b.halfEdge];\n\n    if (isHalfEdge) {\n      return null;\n    } else {\n      if (b.index === btouches.length - 1) {\n        if (this.at(b) === 1) {\n          // The vertex B of the patch is an actual vertex of the triangulation. We will search for C on A's half edge.\n\n          // Search for C on A's half edge.\n          console.assert(this.at(a) !== 0);\n          if (a.index === 0) {\n            // Everything next to A is part of this patch.\n            console.assert(this.at(a) !== 0);\n            C = layout(a.halfEdge, 0);\n          } else {\n            C = layout(a.halfEdge, this.at(atouches[a.index - 1]));\n          }\n        } else {\n          // Everything next to B is part of this patch.\n          scenario = \"remaining face\";\n          C = layout(b.halfEdge, 1);\n          if (this.at(b) === 0)\n            return null;\n        }\n      } else {\n        if (this.at(b) === this.at(btouches[b.index + 1])) {\n          // The vertex B of this patch is a vertex of the component.\n          console.assert(this.at(b) === 0 || this.at(b) === 1, \"Vertices of components must be aligned with the vertices of the triangulation.\");\n\n          // Search for C on A's half edge.\n          console.assert(this.at(a) !== 0);\n          if (a.index === 0) {\n            // Everything next to A is part of this patch.\n            console.assert(this.at(a) !== 0);\n            // TODO: Is this always taken care of by something else?\n            C = layout(a.halfEdge, 0);\n            return null;\n          } else {\n            // TODO: Is this always taken care of by something else?\n            C = layout(a.halfEdge, this.at(atouches[a.index - 1]));\n            return null;\n          }\n        } else {\n          console.assert(this.at(btouches[b.index + 1]) > this.at(b), `Touches are not ordered correctly on half edge ${b.halfEdge}. The ${btouches[b.index + 1].index}th touch at ${this.at(btouches[b.index + 1])} should not be after the ${b.index}th touch at ${this.at(b)}.`);\n          C = layout(b.halfEdge, this.at(btouches[b.index + 1]));\n        }\n      }\n    }\n\n    console.assert(!A.equalTo(B), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice A == B, i.e., ${A.toString()} == ${B.toString()}.`);\n    console.assert(!A.equalTo(C), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice A == C, i.e., ${A.toString()} == ${C.toString()}.`);\n    console.assert(!B.equalTo(C), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice B == C, i.e., ${B.toString()} == ${C.toString()}.`);\n\n    return [A, B, C];\n  }\n\n  private patchHalfEdge(halfEdge: HalfEdge): Point[] | null {\n    // Given `at` in [0, 1] returns the actual point on `halfEdge` that is that far on `halfEdge`.\n    const layout = (halfEdge: HalfEdge, at: number) => this.layout.layout(halfEdge).segment.at(at);\n\n    const face = [halfEdge, this.surface.faces.image(halfEdge), this.surface.faces.preimage(halfEdge)];\n\n    const A = layout(halfEdge, 0);\n    const B = layout(halfEdge, 1);\n    let C = B;\n    let scenario = \"undefined\";\n\n    // Search for the third point of the patch on the following half edge in the face.\n    let touches = this.touches[face[1]]\n    if (touches.length === 0) {\n      // Since nothing intersects the following half edge in this face, this\n      // patch is the entire face.\n      scenario = \"entire face\";\n      C = layout(face[1], 1);\n      if (face[0] !== Math.min(...face))\n        return null;\n    } else if (this.at(touches[0]) === 0) {\n      // Something starts at the vertex joining this half edge with the\n      // following half edge...\n      touches = this.touches[-face[2]];\n      if (touches.every((touch) => this.at(touch) === 0 || this.at(touch) === 1)) {\n        // ...it is just the following half edge itself.\n        scenario = \"entire face 2\";\n        // TODO: Is this always taken care of by something else?\n        C = layout(face[1], 1);\n        if (face[0] !== Math.min(...face))\n          return null;\n      } else {\n        // It's another connection. So the patch ends at the beginning of the\n        // next half edge, none of that half edge is in the patch, i.e., the\n        // third point of the patch must be on the other half edge of this\n        // face.\n        scenario = \"on previous half edge\";\n        for (const touch of touches) {\n          if (this.at(touch) !== 0) {\n            // TODO: Is this always taken care of by something else?\n            C = layout(face[2], 1 - this.at(touch));\n            return null;\n            break;\n          }\n        }\n      }\n    } else {\n      scenario = \"on following half edge\";\n      C = layout(face[1], this.at(touches[0]));\n    }\n\n    console.assert(!A.equalTo(B), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice A == B, i.e., ${A.toString()} == ${B.toString()}.`);\n    console.assert(!A.equalTo(C), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice A == C, i.e., ${A.toString()} == ${C.toString()}.`);\n    console.assert(!B.equalTo(C), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice B == C, i.e., ${B.toString()} == ${C.toString()}.`);\n\n    return [A, B, C];\n  }\n\n  get triangles(): Point[][] {\n    const triangles = [];\n\n    for (const connection of this.component.perimeter) {\n      for (let i = 0; i < connection.touches.length; i+=2) {\n        const patch = this.patch(connection.touches[i], connection.touches[i + 1])\n        if (patch !== null)\n          triangles.push(patch);\n      }\n    }\n\n    for (const inside of this.component.inside) {\n      const patch = this.patchHalfEdge(inside);\n      if (patch != null)\n        triangles.push(patch);\n    }\n\n    return triangles;\n  }\n\n  get patches(): Point[][] {\n    const patches = [];\n    const triangles = [...this.triangles];\n\n    const epsilon = (Flatten.Utils as any).getTolerance();\n\n    // Glue triangle to ngon if possible.\n    const glue = (ngon: Point[], triangle: Point[]) => {\n      assert(triangle.length === 3);\n      for (const step of [1, 2]) {\n        for (const t of [0, 1, 2]) {\n          for (let n = 0; n < ngon.length; n++) {\n            if (triangle[t].equalTo(ngon[n], epsilon) && triangle[(t + step) % 3].equalTo(ngon[(n + 1) % ngon.length], epsilon)) {\n              // Add the third point of the triangle that gets glued to the ngon.\n              ngon.splice(n + 1, 0, triangle[(t + 2*step) % 3]);\n\n              // Simplify the ngon if it contains the same point twice.\n              for (let nn = 0; nn < ngon.length; nn++) {\n                if (ngon[nn].equalTo(ngon[(nn + 2) % ngon.length], epsilon)) {\n                  if (nn + 1 == ngon.length) {\n                    ngon.splice(0, 2);\n                  } else if (nn + 2 == ngon.length) {\n                    ngon.splice(0, 1);\n                    ngon.pop();\n                  } else\n                    ngon.splice(nn, 2);\n                  break;\n                }\n              }\n\n              return true;\n            }\n          }\n        }\n      }\n\n      return false;\n    };\n\n    while(triangles.length) {\n      // Create an ngon by gluing triangles that share two points.\n      let patch = triangles.pop()!;\n      for (let t = triangles.length; t--;) {\n        if (glue(patch, triangles[t])) {\n          triangles[t] = triangles[triangles.length - 1];\n          triangles.pop();\n          t = triangles.length;\n        }\n      }\n\n      patches.push(patch);\n    }\n\n    return patches;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlowComponent.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlowComponent.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FlowComponent.vue?vue&type=template&id=7a357317&scoped=true&\"\nimport script from \"./FlowComponent.vue?vue&type=script&lang=ts&\"\nexport * from \"./FlowComponent.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FlowComponent.vue?vue&type=style&index=0&id=7a357317&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7a357317\",\n  null\n  \n)\n\nexport default component.exports","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport iwanthue, { ColorSpacePreset } from \"iwanthue\";\n\nexport default class Palette {\n  constructor(colors: number = 2, space: ColorSpacePreset = \"fancy-light\") {\n    // TODO: Typings in iwanthue are wrong.\n    this.palette = iwanthue(colors >= 2 ? colors : 2, { seed: 1337 as any, colorSpace: space });\n  }\n\n  color(i: number) {\n    if (i >= this.palette.length)\n      console.warn(\"Color outside of palette bounds requested.\");\n    return this.palette[i % this.palette.length];\n  }\n\n  private readonly palette;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Point from \"./Point\";\n\nexport default class Polygon {\n  public constructor(parent: CoordinateSystem, value: Flatten.Polygon) {\n    this.parent = parent;\n    this.value = value;\n  }\n\n  public get convexHull(): Polygon {\n    return Polygon.convexHull(this.vertices);\n  }\n\n  // Compute the convex hull of the points (using the slow Jarvis march\n  // algorithm.)\n  public static convexHull(points: Point[]): Polygon {\n    assert(points.length !== 0);\n\n    const coordinateSystem = points[0].parent;\n\n    const vertices = points.map((p) => coordinateSystem.embed(p).value);\n\n    assert(vertices.some((p) => !p.equalTo(vertices[0])));\n\n    const hull = [vertices.reduce((p, q) => {\n      if (p.x < q.x)\n        return p;\n      if (p.x > q.x)\n        return q\n      if (p.y < q.y)\n        return p;\n      return q;\n    })];\n\n    do {\n      const last = hull[hull.length - 1];\n      let next = vertices[0].equalTo(last) ? vertices[1] : vertices[0];\n      for (let p of vertices) {\n        if (p.leftTo(new Flatten.Line(last, next)))\n          next = p;\n      }\n      hull.push(next);\n      // TODO: This is numerically too unstable (and hangs sometimes.)\n      if (hull.length > vertices.length + 1) {\n        console.error(\"Convex Hull incorrect\");\n        break;\n      }\n    } while(!hull[hull.length - 1].equalTo(hull[0]));\n\n    hull.pop();\n\n    const polygon = new Flatten.Polygon();\n    polygon.addFace(hull);\n    return new Polygon(coordinateSystem, polygon);\n  }\n\n  // Return a bounding rectangle of minimal area. (The rectangle might not be\n  // axis-aligned.)\n  public get boundingRect(): Polygon {\n    const hull = this.convexHull;\n\n    let minArea = 1./0.;\n    let minAreaRect = null;\n\n    // Algorithm: The minimal bounding rect of a convex polygon must be aligned to one of its sides.\n    for (const edge of hull.value.edges) {\n      // Rotate such that the edge is horizontal.\n      const segment: Flatten.Segment = edge.shape;\n      const direction = segment.tangentInStart();\n      const theta = new Flatten.Vector(1, 0).angleTo(direction);\n      const rotation = new Flatten.Matrix(\n        Math.cos(-theta), -Math.sin(-theta),\n        Math.sin(-theta), Math.cos(-theta),\n      );\n      const aligned = hull.value.transform(rotation);\n\n      // Compute the area of this bounding box.\n      const area = aligned.area();\n\n      if (area < minArea) {\n        minArea = area;\n\n        // Rotate the box back.\n        minAreaRect = new Polygon(this.parent, new Flatten.Polygon(aligned.box.toPoints()).transform(CoordinateSystem.inverse(rotation)));\n      }\n    }\n\n    return minAreaRect!;\n  }\n\n  public get vertices(): Point[] {\n    return this.value.vertices.map((vertex) => new Point(this.parent, vertex));\n  }\n\n  public area(): number {\n    return this.value.area();\n  }\n  \n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Polygon;\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nexport default class Progress {\n  constructor(name: string = \"\", steps: number = 0) {\n    this.name = name;\n    this.steps = steps;\n  }\n\n  public task(name: string, steps: number) {\n    this.steps += steps;\n    this.name = name;\n  }\n\n  public progress() {\n    this.step++;\n  }\n\n  public get stats(): { name: string, step?: number, steps?: number } {\n    return {\n      name: this.name,\n      step: (this.steps != null && this.step < this.steps) ? this.step : undefined,\n      steps: this.steps,\n    }\n  }\n\n  private step = 0;\n  private steps = 0;\n  private name: string;\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nexport class OperationAborted extends Error {}\n\nexport default class CancellationToken {\n  public cancellationRequested() {\n    return new Promise<boolean>((resolve, reject) => {\n      if (this.aborted) reject(new OperationAborted());\n      setTimeout(() => resolve(this.cancelled), 0);\n    });\n  }\n\n  public cancel() {\n    this.cancelled = true;\n  }\n\n  public abort() {\n    this.aborted = true;\n  }\n\n  private cancelled = false;\n  private aborted = false;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020-2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\n\nimport minBy from \"lodash-es/minBy\";\nimport Flatten from \"@flatten-js/core\";\n\nimport Vector from \"../Vector\";\nimport HalfEdge from \"../triangulation/HalfEdge\";\nimport Automorphism from \"../triangulation/Automorphism\";\nimport HalfEdgeLayout from './HalfEdgeLayout';\nimport Point from '../Point';\nimport Segment from '../Segment';\nimport Polygon from '../Polygon';\nimport FlatTriangulation from '../triangulation/FlatTriangulation';\nimport Progress from \"@/Progress\";\nimport CancellationToken from \"@/CancellationToken\";\n\nexport default class CellLayout {\n  // Create a layout by walking the boundary of the cell in counter-clockwise\n  // order on the inside and summing up the associated vectors to determine the\n  // segment corresponding to each half edge.\n  public constructor(surface: FlatTriangulation, cell: HalfEdge[], origin: Point);\n  public constructor(surface: FlatTriangulation, layout: Record<HalfEdge, HalfEdgeLayout>);\n  public constructor(surface: FlatTriangulation, cell: HalfEdge[] | Record<HalfEdge, HalfEdgeLayout>, origin?: Point) {\n    this.surface = surface;\n\n    if (cell instanceof Array) {\n      assert(origin);\n      let end = origin;\n      this.layout = Object.fromEntries(cell.map((he: HalfEdge) => {\n        const start = end;\n        end = end.translate(surface.vector(he));\n        return [he, {\n          segment: new Segment(origin.parent, start.value, end.value),\n          inner: false,\n        }];\n      }));\n    } else {\n      this.layout = cell;\n    }\n\n    this.boundingRectArea = this.polygon.boundingRect.area();\n  }\n\n  // Translate this cell so that half edge coincides with segment.\n  translate(delta: Vector): void;\n  translate(halfEdge: HalfEdge, segment: Segment): void;\n  translate(halfEdge: HalfEdge | Vector, segment?: Segment) {\n    if (halfEdge instanceof Vector) {\n      const delta = halfEdge as Vector;\n      this.halfEdges.map((halfEdge) => {\n        this.layout[halfEdge].segment = this.layout[halfEdge].segment.translate(delta);\n      });\n    } else {\n      const before = this.layout[halfEdge].segment;\n      const delta = new Vector(before.parent, before.start, segment!.start);\n      \n      // https://github.com/alexbol99/flatten-js/pull/75\n      assert(before.translate(delta).equalTo(segment!, (Flatten.Utils as any).getTolerance()));\n\n      this.translate(delta);\n    }\n  }\n\n  // Return the HalfEdges that glue correctly between this layout and `other`\n  // currently or return an empty array if something overlaps or touches\n  // incorrectly.\n  glues(other: CellLayout): HalfEdge[] {\n    const otherPolygon = other.polygon;\n\n    const glued = [];\n\n    for (const halfEdge of this.halfEdges) {\n      if (this.layout[halfEdge].segment.intersects(otherPolygon)) {\n        // This half edge and the other cell have at least a point in common.\n\n        if (this.layout[halfEdge].segment.middle.on(otherPolygon)) {\n          if (other.halfEdges.includes(-halfEdge)) {\n            // If this half edge has its counterpart in the other cell, then we\n            // want them to be glued correctly.\n            if (this.layout[halfEdge].segment.equalTo(other.layout[-halfEdge].segment.reverse(), Flatten.Utils.getTolerance())) {\n              glued.push(halfEdge);\n              continue;\n            } else {\n              return [];\n            }\n          } else {\n            return [];\n          }\n        }\n\n        const intersections = this.layout[halfEdge].segment.intersect(otherPolygon);\n        if (intersections.length === 0) {\n          // This half edge is completely inside the other cell.\n          return [];\n        }\n\n        // Check whether the intersection points are consistently glued.\n        for (const intersection of intersections) {\n          const touchConsistent = (source: HalfEdge) => {\n              for (const vertex of this.surface.vertices.cycles) {\n                if (!vertex.includes(source)) continue;\n\n                for (const touch of vertex) {\n                  if (!other.halfEdges.includes(touch)) continue;\n\n                  if (intersection.equalTo(other.layout[touch].segment.start, Flatten.Utils.getTolerance()))\n                    return true;\n              }\n            };\n            // Not touching at a vertex or not touching at this vertex.\n            return false;\n          }\n\n          if (intersection.equalTo(this.layout[halfEdge].segment.start, Flatten.Utils.getTolerance())) {\n            // The cells touch at the starting point of this half edge. We\n            // check whether what it touches is the same vertex in the other\n            // cell.\n            if (!touchConsistent(halfEdge)) {\n              return [];\n            }\n          }\n          else if (intersection.equalTo(this.layout[halfEdge].segment.end, Flatten.Utils.getTolerance())) {\n            // The cells touch at the end point of this half edge. We\n            // check whether what it touches is the same vertex in the other\n            // cell.\n            if (!touchConsistent(-halfEdge)) {\n              return [];\n            }\n          } else {\n            // The cells touch not at the end point of a half edge.\n            return [];\n          }\n        }\n      }\n    }\n\n    assert(glued.length !== 0);\n    return glued;\n  }\n\n  touches(other: CellLayout): HalfEdge[] {\n    const otherPolygon = other.polygon;\n    return this.halfEdges.filter((halfEdge) => {\n      return !this.layout[halfEdge].inner && this.layout[halfEdge].segment.intersects(otherPolygon) || this.layout[halfEdge].segment.touch(otherPolygon);\n    });\n  }\n\n  // Return the boundary polygon of this cell (might not be connected.)\n  get polygon(): Polygon {\n    const polygon = new Flatten.Polygon();\n    this.boundaries.map((boundary) => {\n      polygon.addFace(boundary.map((side) => this.parent.embed(this.layout[side].segment).value));\n    });\n    return new Polygon(this.parent, polygon);\n  }\n\n  // Return the boundary polygons of this cell.\n  get boundaries() : HalfEdge[][] {\n    let pending = new Set(this.halfEdges.filter((he) => !this.layout[he].inner));\n    const boundaries = [] as HalfEdge[][];\n\n    while(pending.size) {\n      let start!: number;\n      for (start of pending) break;\n\n      const boundary = [] as HalfEdge[];\n      let next = start;\n      do {\n        next = -next;\n\n        do {\n          next = this.surface.vertices.preimage(next);\n        } while(this.layout[next].inner);\n\n        boundary.push(next);\n        pending.delete(next);\n      } while (next !== start);\n\n      boundaries.push(boundary);\n    }\n\n    return boundaries;\n  }\n\n  private get parent() {\n    return this.layout[this.halfEdges[0]].segment.parent;\n  }\n\n  public toString(): string {\n    return \"{\" + this.halfEdges.map((he) => `${he}: ${this.layout[he].segment}`).join(\", \") + \"}\";\n  }\n\n  get halfEdges(): HalfEdge[] {\n    return Object.keys(this.layout).map((halfEdge) => Number(halfEdge));\n  }\n\n  // Merge two of the cells by identifying two opposite half edges.\n  static async merge(cells: CellLayout[], force: (he: HalfEdge) => boolean | null, automorphisms: Automorphism[], cache: Record<HalfEdge, number | null> = {}, cancellation = new CancellationToken(), _progress = new Progress()): Promise<CellLayout[]> {\n    if (cells.length === 1)\n      return cells;\n\n    let scores = [] as {\n      glue: HalfEdge;\n      cell: CellLayout;\n      other: CellLayout;\n      score: number;\n    }[];\n\n    for (const cell of cells) {\n      if (await cancellation.cancellationRequested())\n        break;\n\n      for (const glue of cell.halfEdges) {\n        if (glue < 0) continue;\n        const other = cells.find((other) => other.halfEdges.includes(-glue))!;\n        if (cell === other) continue;\n\n        if (cache[glue] === undefined) {\n          cache[glue] = CellLayout.score(glue, cell, other, cells, force, automorphisms);\n        }\n\n        const score = cache[glue];\n\n        if (score === null)\n          continue;\n\n        scores.push({ glue, cell, other, score });\n      }\n    }\n\n    if (scores.length === 0)\n      return cells;\n\n    const best = minBy(scores, 'score')!;\n\n    for (const glue of Automorphism.orbit(best.glue, automorphisms)) {\n      const cell = cells.find((cell) => cell.halfEdges.includes(glue))!;\n      const other = cells.find((other) => other.halfEdges.includes(-glue))!;\n\n      assert(cell !== other);\n\n      const glued = CellLayout.glue(glue, cell, other);\n      glued.primary = best.glue === glue;\n\n      for (let halfEdge of glued.halfEdges) {\n        delete cache[halfEdge];\n        delete cache[-halfEdge];\n      }\n\n      cells = [glued, ...cells.filter((c) => c !== cell && c !== other)];\n    }\n\n    return cells;\n  }\n\n  // Return the score (lower is better) to the visual glueing of glue of\n  // parent and -glue of other; or return null if the two cannot be glued\n  // without overlaps in the resulting picture.\n  private static score(glue: HalfEdge, parent: CellLayout, other: CellLayout, cells: CellLayout[], force?: (he: HalfEdge) => boolean | null, automorphisms: Automorphism[] = []): number | null {\n    assert(parent.halfEdges.includes(glue) && other.halfEdges.includes(-glue));\n    assert(!parent.layout[glue].inner)\n    assert(!other.layout[-glue].inner);\n\n    if (!parent.primary)\n      return null;\n\n    other.translate(-glue, parent.layout[glue].segment.reverse());\n    const glues = parent.glues(other);\n    if (glues.length === 0) {\n      return null;\n    }\n\n    // Forbid gluing cells that contain identified edges.\n    for (const preimage of parent.halfEdges)\n      for (const image of Automorphism.orbit(preimage, automorphisms))\n        if (other.halfEdges.includes(image))\n          return null;\n\n    // Prefer edges that have been explicitly selected.\n    if (force) {\n      if (force(glue) === true)\n        return -force.length;\n      if (force(glue) === false)\n        return null;\n    }\n\n    // Prefer edges that keep Delaunay cells intact.\n    {\n      const ca = parent.surface.vector(glue);\n      const cb = parent.surface.vector(parent.surface.vertices.image(glue));\n      const dc = parent.surface.vector(-parent.surface.faces.image(-glue));\n\n      const a = dc.add(ca);\n      const b = dc.add(cb);\n      const c = dc;\n\n      const det = (x00: number, x01: number, x02: number, x10: number, x11: number, x12: number, x20: number, x21: number, x22: number) => x00 * (x11 * x22 - x12 * x21) - x10 * (x01 * x22 - x21 * x02) + x20 * (x01 * x12 - x11 * x02);\n\n      const delaunay = det(a.x, a.y, a.x * a.x + a.y * a.y, b.x, b.y, b.x * b.x + b.y * b.y, c.x, c.y, c.x * c.x + c.y * c.y);\n\n      if (Math.abs(delaunay) < (Flatten.Utils as any).getTolerance())\n        return 0;\n    }\n\n    // Prefer edges that minimize the area of a bounding rectangle of the glued area.\n    {\n      const ungluedArea = cells.map((cell) => cell.boundingRectArea).reduce((a, b) => a+b);\n\n      const gluedArea = cells.filter((cell) => cell !== parent && cell !== other).map((cell) => cell.boundingRectArea).reduce((a, b) => a + b, 0)\n        + CellLayout.glue(glues, parent, other).boundingRectArea;\n\n      return gluedArea / ungluedArea;\n    }\n  }\n\n  // Glue parent and other along glue and return the resulting cell.\n  private static glue(glues: HalfEdge[], parent: CellLayout, other: CellLayout): CellLayout;\n  private static glue(glue: HalfEdge, parent: CellLayout, other: CellLayout): CellLayout;\n  private static glue(glues: HalfEdge | HalfEdge[], parent: CellLayout, other: CellLayout): CellLayout {\n    if (!Array.isArray(glues)) {\n      other.translate(-glues, parent.layout[glues].segment.reverse());\n      return CellLayout.glue(parent.glues(other), parent, other);\n    } else {\n      assert(glues.length !== 0)\n      other.translate(-glues[0], parent.layout[glues[0]].segment.reverse());\n\n      // https://github.com/alexbol99/flatten-js/pull/75\n      for (const glue of glues)\n        assert(parent.layout[glue].segment.equalTo(other.layout[-glue].segment.reverse(), (Flatten.Utils as any).getTolerance()));\n\n      assert(Object.keys(parent.layout).every((he) => !other.layout.hasOwnProperty(he)));\n      assert(Object.keys(other.layout).every((he) => !parent.layout.hasOwnProperty(he)));\n\n      const glued = {...parent.layout, ...other.layout};\n      for (const glue of glues) {\n        glued[glue] = { segment: parent.layout[glue].segment, inner: true }\n        glued[-glue] = { segment: other.layout[-glue].segment, inner: true }\n      }\n\n      return new CellLayout(parent.surface, glued);\n    }\n  }\n\n  private static packable(cells: CellLayout[], packed: CellLayout[]) {\n    for (let i = 0; i < cells.length; i++) {\n      const cell = cells[i];\n\n      // Find a half edge that connects to something that has already been packed\n      for (let halfEdge of cell.halfEdges) {\n        for (let cell_ of packed) {\n          for (let halfEdge_ of cell_.halfEdges) {\n            if (halfEdge === -halfEdge_) {\n              cells.splice(i, 1);\n              return {\n                cell,\n                cell_,\n                halfEdge,\n                halfEdge_,\n              };\n            }\n          }\n        }\n      }\n    }\n\n    assert(false, `Could not find any cells packable with ${packed} among ${cells}`);\n  }\n\n  static pack(cells: CellLayout[], progress: Progress): CellLayout[] {\n    if (cells.length <= 1) return cells;\n\n    const packed = [cells.pop()] as CellLayout[];\n\n    progress.task(\"Packing Cells\", cells.length);\n\n    while (cells.length) {\n      progress.progress();\n\n      const {cell, cell_, halfEdge, halfEdge_} = CellLayout.packable(cells, packed);\n\n      const segment = cell.layout[halfEdge].segment;\n      const segment_ = cell_.layout[halfEdge_].segment.reverse();\n\n      cell.translate(halfEdge, segment_);\n\n      // We determine a distance that two edges have to be separated from each\n      // other to make it clear that they are not glued.\n      // The idea is that the entire `packed` presumably fills a notebook cell,\n      // probably 800 x 600 pixels. A gap of 10 pixels (minus SVG borders) can\n      // easily be recognized as a gap.\n      const screen = packed.map((cell) => cell.polygon.value.box).reduce((box, cell) => box.merge(cell), new Flatten.Box());\n      const step = Math.max((screen.xmax - screen.xmin) / 800, (screen.ymax - screen.ymin) / 600) * 10;\n      const delta = segment.tangentInStart.rotate90CCW().multiply(step);\n      \n      do {\n        cell.translate(delta);\n      } while(packed.some((other) => cell.touches(other).length))\n\n      packed.push(cell);\n    }\n\n    return packed;\n  }\n\n  protected readonly surface: FlatTriangulation;\n  protected readonly boundingRectArea: number;\n  public readonly layout: Record<HalfEdge, HalfEdgeLayout>;\n  // Whether this cell should be consider the primary copy of cells that are\n  // isomorphic under the automorphisms.\n  public primary: boolean = true;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Point from '../Point';\nimport FlatTriangulation from \"../triangulation/FlatTriangulation\";\nimport Automorphism from \"../triangulation/Automorphism\";\nimport HalfEdge from '../triangulation/HalfEdge';\nimport CellLayout from './CellLayout';\nimport HalfEdgeLayout from './HalfEdgeLayout';\nimport Box from '../Box';\nimport CancellationToken from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\n\nexport default class FlatTriangulationLayout {\n  private constructor(surface: FlatTriangulation, force?: (he: HalfEdge) => boolean | null, automorphisms?: Automorphism[]) {\n    this.surface = surface;\n    this.force = force || (() => null);\n    this.automorphisms = automorphisms || [];\n    this.primary = [];\n  }\n\n  public static async layout(surface: FlatTriangulation, force?: (he: HalfEdge) => boolean | null, automorphisms: Automorphism[] = [], cancellation = new CancellationToken(), progress = new Progress()) {\n    const layout = new FlatTriangulationLayout(surface, force, automorphisms);\n    await layout.recompute(cancellation, progress);\n    return layout;\n  }\n\n  private async recompute(cancellation: CancellationToken, progress: Progress) {\n    // Layout Algorithm:\n    // (1) Start from elementary cells, i.e., triangular faces.\n    // (2) Greedily glue any two cells as long as no overlap is produced,\n    //     prefering metrics such as the gluing that minimizes the area of a\n    //     bounding rectangle.\n    // (3) Pack the resulting cells into a box by randomly aligning\n    //     corresponding half edges to create a single polygon (with self intersections)\n    //     and move the pieces away from each other orthogonally until no overlaps\n    //     happen anymore.\n\n    // (1) Elementary Cells\n    if (this.surface.halfEdges.length === 0) {\n      this.halfEdges = {};\n      return;\n    }\n\n    const origin = new Point(this.surface.vector(this.surface.halfEdges[0]).parent, 0, 0);\n    let cells = this.surface.faces.cycles.map((face) => new CellLayout(this.surface, face, origin));\n\n    // (2) Glue Cells\n    progress.task(\"Gluing Cells\", cells.length - 1);\n    const cache = {};\n    for (const _ of Array(cells.length - 1)) {\n      progress.progress();\n      cells = await CellLayout.merge(cells, this.force, this.automorphisms, cache, cancellation, progress);\n    }\n\n    // (3) Pack Cells\n    cells = CellLayout.pack(cells.filter((cell) => cell.primary), progress);\n\n    this.halfEdges = Object.assign({}, ...cells.map((cell) => cell.layout));\n    this.primary = cells.filter((cell) => cell.primary).map((cell) => cell.halfEdges).flat();\n\n    for (const he of this.surface.halfEdges) {\n      if (this.force(he) === true && !this.layout(he).inner)\n        console.log(`Half edge ${he} should be visually glued in the layout but this was not possible.`);\n      if (this.force(he) === false && this.layout(he).inner)\n        console.error(`Half edge ${he} should not be visually glued in the layout but it is.`);\n    }\n  }\n\n  public layout(halfEdge: HalfEdge): HalfEdgeLayout & { primary: boolean } {\n    return {\n      ...this.halfEdges[halfEdge],\n      primary: this.primary.includes(halfEdge),\n    };\n  }\n\n  public get bbox(): Box {\n    return Box.bbox(this.primary.map((halfEdge) => this.halfEdges[halfEdge].segment));\n  }\n\n  public readonly surface: FlatTriangulation;\n  private force: (he: HalfEdge) => boolean | null;\n  private automorphisms: Automorphism[];\n  private halfEdges!: Record<HalfEdge, HalfEdgeLayout>;\n  public primary!: HalfEdge[];\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\n\nimport { optimize } from \"svgo/dist/svgo.browser.js\";\nimport rgba from \"color-normalize\";\n\n/*\n * Turns an <svg> in an HTML document into a standalone svg.\n */\nexport default class SVGExporter {\n  constructor(svg: Element) {\n    this.svg = svg.cloneNode(true) as Element;\n    this.styles = [svg, ...svg.getElementsByTagName(\"*\")].map(this.computedStyle);\n\n    if (this.svg.tagName !== 'svg') {\n      svg = document.createElement('svg');\n      svg.appendChild(this.svg);\n      this.svg = svg;\n\n      this.styles.unshift({});\n    }\n\n    this.svg.setAttribute(\"xmlns\", \"http://www.w3.org/2000/svg\");\n    this.svg.setAttribute(\"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n  }\n\n  private get children() {\n    return [this.svg, ...this.svg.getElementsByTagName(\"*\")];\n  }\n\n  private computedStyle(element: Element) {\n    const style = window.getComputedStyle(element);\n    const computed = {} as { [key: string]: string };\n    for (let i = 0; i < style.length; i++)\n      computed[style[i]] = style.getPropertyValue(style[i]);\n    return computed;\n  }\n\n  /*\n   * Return the index of `e` in `styles`.\n   */\n  private index(e: Element) {\n    const children = this.children;\n    assert(children.length == this.styles.length);\n\n    for (let index = 0; index < children.length; index++) {\n      if (children[index] === e)\n        return index;\n    }\n\n    throw Error(\"Element not found in DOM tree.\")\n  }\n\n  /*\n   * Drop all class=\"\" attributes from all elements.\n   */\n  public dropClasses() {\n    for (const child of this.children) {\n      child.removeAttribute('class');\n    }\n  }\n\n  /*\n   * Drop all prefixed styles from all elements, i.e., things such as\n   * `-webkit-...` and `--variable`.\n   */\n  public dropPrefixedStyles() {\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, _value]) => !key.startsWith('-'))\n      );\n    });\n  }\n\n  /*\n   * Drop all elements that are not visible from the element tree.\n   */\n  public dropInvisible() {\n    const children = this.children;\n    assert(children.length === this.styles.length);\n\n    const trash = {} as {[index: number]: Element};\n\n    const addToTrash = (element: Element) => {\n      const index = this.index(element);\n\n      if (index in trash)\n        return;\n      trash[index] = element;\n\n      [...element.children].forEach(addToTrash);\n    };\n\n    for (let index = 1; index < children.length; index++) {\n      const child = children[index];\n      const style = this.styles[index];\n      if (style[\"visibility\"] === \"hidden\" || style[\"display\"] === \"none\")\n        addToTrash(child);\n    }\n\n    this.styles = this.styles.filter((_style, i) => !(i in trash));\n\n    for (const element of Object.values(trash)) {\n      if (element.parentNode != null) {\n        element.parentNode.removeChild(element);\n      }\n    }\n\n    assert(this.children.length === this.styles.length);\n\n    // Now we can drop all \"visibility: visible\" and \"display: \" which has no\n    // effect in SVG anymore.\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, _value]) => key !== \"visibility\" && key !== \"display\")\n      );\n    });\n  }\n\n  /*\n   * Drop styling that is already equally set on the parent node.\n   */\n  public dropRedundantStyles() {\n    const children = this.children;\n    assert(children.length === this.styles.length);\n\n    for (let index = children.length; index--;) {\n      const child = children[index];\n      const parent = child.parentNode as Element;\n\n      if (parent == null) continue;\n\n      const style = this.styles[this.index(parent)];\n      this.styles[index] = Object.fromEntries(\n        Object.entries(this.styles[index]).filter(([key, value]) => style[key] != value)\n      );\n    }\n  }\n\n  /*\n   * Drop custom attributes such as `data-attribute=\"\"`.\n   */\n  public dropCustomAttributes() {\n    for (const child of this.children) {\n      [...child.attributes].forEach((attribute) => {\n        if (attribute.name.includes('-'))\n          child.removeAttribute(attribute.name);\n      });\n    }\n  }\n\n  private static readonly standard = [ \"cx\", \"cy\", \"height\", \"width\", \"x\", \"y\", \"r\", \"rx\", \"ry\", \"d\", \"fill\", \"transform\", \"alignment-baseline\", \"baseline-shift\", \"clip-path\", \"clip-rule\", \"color\", \"color-interpolation\", \"color-interpolation-filters\", \"color-rendering\", \"cursor\", \"direction\", \"display\", \"dominant-baseline\", \"fill-opacity\", \"fill-rule\", \"filter\", \"flood-color\", \"flood-opacity\", \"font-family\", \"font-size\", \"font-size-adjust\", \"font-stretch\", \"font-style\", \"font-variant\", \"font-weight\", \"glyph-orientation-horizontal\", \"glyph-orientation-vertical\", \"image-rendering\", \"letter-spacing\", \"lighting-color\", \"marker-end\", \"marker-mid\", \"marker-start\", \"mask\", \"opacity\", \"overflow\", \"paint-order\", \"pointer-events\", \"shape-rendering\", \"stop-color\", \"stop-opacity\", \"stroke\", \"stroke-dasharray\", \"stroke-dashoffset\", \"stroke-linecap\", \"stroke-linejoin\", \"stroke-miterlimit\", \"stroke-opacity\", \"stroke-width\", \"text-anchor\", \"text-decoration\", \"text-overflow\", \"text-rendering\", \"unicode-bidi\", \"vector-effect\", \"visibility\", \"white-space\", \"word-spacing\", \"writing-mode\", \"display\", \"overflow\", \"visibility\", \"text-overflow\", \"clip-path\", \"clip-rule\", \"mask\", \"color\", \"opacity\", \"color-interpolation-filters\", \"filter\", \"flood-color\", \"flood-opacity\", \"lighting-color\", \"isolation\", \"transform\", \"transform-box\", \"transform-origin\", \"letter-spacing\", \"text-align\", \"text-align-last\", \"text-indent\", \"word-spacing\", \"white-space\", \"vertical-align\", \"dominant-baseline\", \"alignment-baseline\", \"baseline-shift\", \"direction\", \"text-orientation\", \"writing-mode\", \"font\", \"text-decoration\", \"text-decoration-line\", \"text-decoration-style\", \"text-decoration-color\"];\n\n  /*\n   * Drop styles that are not explititly supported by SVG 2, see\n   * https://www.w3.org/TR/SVG/styling.html#RequiredProperties\n   */\n  public dropNonStandardStyles() {\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, _value]) => {\n          if (SVGExporter.standard.includes(key))\n            return true;\n          if (key.startsWith(\"font-\"))\n            return true;\n        })\n      )\n    });\n  }\n\n  /*\n   * Rewrite style as presentation attributes.\n   * Drop all styles that can be presentation attributes from elements where they are not allowed.\n   * This helps some SVG readers and also svgo to optimize the output.\n   */\n  public usePresentationAttributes() {\n    const children = this.children;\n    assert(children.length === this.styles.length);\n\n    for (let index = children.length; index--;) {\n      const child = children[index];\n\n      const makePresentation = (key: string, value: string) => {\n        if (!child.hasAttribute(key))\n          child.setAttribute(key, value);\n      };\n\n      this.styles[index] = Object.fromEntries(\n        Object.entries(this.styles[index]).filter(([key, value]) => {\n          if ([\"cx\", \"cy\"].includes(key)) {\n            if ([\"circle\", \"ellipse\"].includes(child.tagName))\n              return makePresentation(key, value);\n            return false;\n          } else if ([\"height\", \"width\", \"x\", \"y\"].includes(key)) {\n            if ([\"foreignObject\", \"image\", \"rect\", \"svg\", \"symbol\", \"use\"].includes(child.tagName))\n              return makePresentation(key, value);\n            return false;\n          } else if ([\"r\"].includes(key)) {\n            if ([\"circle\"].includes(child.tagName))\n              return makePresentation(key, value);\n            return false;\n          } else if ([\"rx\", \"ry\"].includes(key)) {\n            if ([\"ellipse\", \"rect\"].includes(child.tagName))\n              return makePresentation(key, value);\n            return false;\n          } else if ([\"d\"].includes(key)) {\n            if ([\"path\"].includes(child.tagName))\n              makePresentation(key, value);\n            return false;\n          } else if ([\"fill\"].includes(key)) {\n            if (![\"animate\", \"set\", \"animateMotion\"].includes(child.tagName))\n              makePresentation(key, value);\n            return false;\n          } else if ([\"transform\"].includes(key) && value != \"none\") {\n            if (![\"pattern\", \"linearGradien\", \"radialGradient\"].includes(child.tagName))\n              makePresentation(key, value);\n            else if ([\"pattern\"].includes(child.tagName))\n              makePresentation(\"patternTransform\", value);\n            else if ([\"linearGradient\", \"radialGradient\"].includes(child.tagName))\n              makePresentation(\"gradientTransform\", value);\n            return false;\n          } else if ([\"alignment-baseline\", \"baseline-shift\", \"clip-path\", \"clip-rule\", \"color\", \"color-interpolation\", \"color-interpolation-filters\", \"color-rendering\", \"cursor\", \"direction\", \"display\", \"dominant-baseline\", \"fill-opacity\", \"fill-rule\", \"filter\", \"flood-color\", \"flood-opacity\", \"font-family\", \"font-size\", \"font-size-adjust\", \"font-stretch\", \"font-style\", \"font-variant\", \"font-weight\", \"glyph-orientation-horizontal\", \"glyph-orientation-vertical\", \"image-rendering\", \"letter-spacing\", \"lighting-color\", \"marker-end\", \"marker-mid\", \"marker-start\", \"mask\", \"opacity\", \"overflow\", \"paint-order\", \"pointer-events\", \"shape-rendering\", \"stop-color\", \"stop-opacity\", \"stroke\", \"stroke-dasharray\", \"stroke-dashoffset\", \"stroke-linecap\", \"stroke-linejoin\", \"stroke-miterlimit\", \"stroke-opacity\", \"stroke-width\", \"text-anchor\", \"text-decoration\", \"text-overflow\", \"text-rendering\", \"unicode-bidi\", \"vector-effect\", \"visibility\", \"white-space\", \"word-spacing\", \"writing-mode\"].includes(key)) {\n            makePresentation(key, value);\n            return false;\n          }\n          return true;\n        })\n      );\n    }\n  }\n  public simplifyColors() {\n    const children = this.children;\n    assert(children.length === this.styles.length);\n\n    const simplify = (child: Element, style: {[key: string]: string}, key: string, okey: string | null = null) => {\n      if (child.getAttribute(key))\n        delete style[key];\n      if (okey != null && child.getAttribute(okey))\n        delete style[okey];\n\n      const value = style[key];\n      if (value == null || value == \"none\")\n        return;\n\n      const color = rgba(value);\n      const opacity = color[3];\n      if (okey != null) {\n        style[okey] = String(Number(child.getAttribute(okey) || style[okey] || 1) * opacity);\n        child.removeAttribute(okey);\n      }\n\n      style[key] = `rgb(${color[0]*255}, ${color[1]*255}, ${color[2]*255})`;\n    };\n\n    for (let index = children.length; index--;) {\n      const child = children[index];\n      const style = this.styles[index];\n\n      simplify(child, style, \"fill\", \"fill-opacity\");\n      simplify(child, style, \"stroke\", \"stroke-opacity\");\n      simplify(child, style, \"color\");\n      simplify(child, style, \"text-decoration\");\n      simplify(child, style, \"text-decoration-color\");\n\n      this.styles[index] = style;\n    }\n  }\n\n  /*\n   * Drop trivial styles.\n   */\n  public dropTrivialStyles() {\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, value]) => {\n          if (key == \"transform\" && value == \"none\")\n            return false;\n          if (key == \"filter\" && value == \"none\")\n            return false;\n\n          return true;\n        })\n      )\n    });\n  }\n\n  /*\n   * Drop styles that confuse inkscape (as of 1.1)\n   */\n  public dropNonInkscapeStyles() {\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, value]) => {\n          if (key == \"font-synthesis\")\n            return false;\n          if (key == \"vertical-align\")\n            return false;\n          if (key == \"transform-origin\")\n            return false;\n          if (key == \"transform-box\")\n            return false;\n          if (key == \"text-overflow\")\n            return false;\n          if (key == \"text-align-last\")\n            return false;\n          if (key == \"mask\")\n            return false;\n          if (key == \"font-optical-sizing\")\n            return false;\n          if (key == \"font-language-override\")\n            return false;\n          if (key == \"font-kerning\")\n            return false;\n          if (key == \"clip-path\")\n            return false;\n          if (key == \"transform\" && value == \"none\")\n            return false;\n\n          if (SVGExporter.standard.includes(key))\n            return true;\n          if (key.startsWith(\"font-\"))\n            return true;\n        })\n      )\n    });\n  }\n\n  public dropInteractiveStyles() {\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, _value]) => {\n          if (key == \"cursor\")\n            return false;\n          if (key == \"pointer-events\")\n            return false;\n\n          return true;\n        })\n      )\n    });\n  }\n\n  /*\n   * Inline all styling into the elements `style` attribute.\n   * This is usually the last method to call before `toString()`.\n   */\n  public inlineStyles() {\n    const children = this.children;\n    assert(children.length == this.styles.length);\n\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      const style = Object.entries(this.styles[i]).map(([key, value]) => {\n        return `${key}: ${value};`\n      }).join(\" \");\n      if (style)\n        child.setAttribute('style', style);\n      else\n        child.removeAttribute('style');\n    }\n  }\n\n  /*\n   * Return the extracted SVG as a string.\n   */\n  public toString(svgo: boolean = true) {\n    let svg = this.svg.outerHTML;\n    if (svgo)\n      svg = optimize(svg).data;\n    return svg;\n  }\n\n  // A clone of the original SVG node from the DOM.\n  private svg: Element;\n\n  // The computed style of each node in the original SVG node in traversal order.\n  private styles: Array<{ [key: string]: string }> = [];\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Provide, Inject, Watch } from \"vue-property-decorator\";\n\nimport Viewport from \"../geometry/Viewport\";\nimport FlatTriangulation from \"../geometry/triangulation/FlatTriangulation\";\nimport FlatTriangulationComponent from \"./FlatTriangulation.vue\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\nimport FlowComponent from \"../geometry/triangulation/FlowComponent\";\nimport Automorphism from \"../geometry/triangulation/Automorphism\";\nimport FlowComponentComponent from \"./FlowComponent.vue\";\nimport Palette from \"@/Palette\";\n\nimport Point from \"@/geometry/Point\";\nimport Vector from \"@/geometry/Vector\";\nimport Segment from \"@/geometry/Segment\";\nimport FlatTriangulationLayout from '@/geometry/layout/FlatTriangulationLayout';\nimport { IHalfEdgeConfiguration } from \"./HalfEdgeConfiguration\";\n\nimport CancellationToken, { OperationAborted } from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\n\nimport SVGExporter from \"@/export/SVGExporter\";\n\nimport clamp from \"lodash-es/clamp\";\n\n@Component({\n  components: {\n    FlatTriangulationComponent,\n    FlowComponentComponent,\n  }\n})\nexport default class Surface extends Vue {\n  @Prop({ required: true }) viewport!: Viewport;\n  @Prop({ required: true }) surface!: FlatTriangulation;\n  @Prop({ required: false, default: () => [], type: Array }) components!: FlowComponent[];\n  @Prop({ required: false, default: () => [], type: Array }) inner!: HalfEdge[];\n  @Prop({ required: false, default: () => [], type: Array }) automorphisms!: Automorphism[];\n  \n  private forced = [] as HalfEdge[];\n  private selected = [] as HalfEdge[];\n  private hovered = [] as HalfEdge[];\n  private visibleComponents = [] as FlowComponent[];\n  private indicator = {} as Record<HalfEdge, number | null>;\n  private defaultLabel = {} as Record<HalfEdge, string | null>;\n  private label = {} as Record<HalfEdge, string | null>;\n  private cancellation = new CancellationToken();\n  private layout = null as FlatTriangulationLayout | null;\n\n  static _run(callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>): void {\n    callback(new CancellationToken(), new Progress());\n  }\n\n  @Inject({ from: 'run', default: () => Surface._run})\n  run!: (callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>) => void;\n\n  created() {\n    this.relayout();\n  }\n\n  private nextLabel(label: string) {\n    let chars = label.split('').map((c) => c.charCodeAt(0) - 65);\n    chars[chars.length - 1]++;\n    for (let i = chars.length; i--;) {\n      if (chars[i] == 25) {\n        chars[i] = 0;\n        if (i == 0)\n          chars = [0, ...chars];\n        else\n          chars[i - 1]++;\n      }\n    }\n\n    return chars.map((code) => String.fromCharCode(65 + code)).join('');\n  }\n\n  async relayout() {\n    this.cancellation.abort();\n    this.run(async (cancellation, progress) => {\n      this.cancellation = cancellation;\n      try {\n        this.layout = await FlatTriangulationLayout.layout(this.surface, (he: HalfEdge) => (this.forced.includes(he) || this.forced.includes(-he)) ? true : null, this.automorphisms, this.cancellation, progress);\n      } catch (e) {\n        if (e instanceof OperationAborted) return;\n        throw e;\n      }\n      \n      // Only display components whose half edges and faces have been rendered.\n      this.visibleComponents = this.components.filter((component) =>\n        !component.perimeter.some((connection) =>\n          ! this.layout!.primary.includes(connection.connection.source) && !this.layout!.primary.includes(connection.connection.target)\n        )\n      );\n      \n      // Reset indicators\n      this.indicator = Object.fromEntries(this.surface.halfEdges.map((halfEdge) => [halfEdge, null]));\n\n      // Recompute labels\n      let nextLabel = \"A\";\n      const componentInnerHalfEdges = [...this.visibleComponents.filter((component) => component.cylinder).map((component) => component.inside)];\n      const cylinderInnerHalfEdges = componentInnerHalfEdges.map((halfEdges) => halfEdges.filter((halfEdge) => halfEdges.includes(-halfEdge))).flat();\n\n      this.defaultLabel = {};\n      for (const halfEdge of this.surface.halfEdges) {\n        if (this.defaultLabel[halfEdge] !== undefined)\n          continue;\n\n        if (!this.layout!.layout(halfEdge).primary)\n          continue\n\n        // Do not show labels for half edges in the interior of cylinders.\n        if (cylinderInnerHalfEdges.includes(halfEdge)) {\n          this.defaultLabel[halfEdge] = null;\n          continue;\n        }\n\n        if (this.layout!.layout(halfEdge).inner) {\n          this.defaultLabel[halfEdge] = null;\n          continue;\n        }\n        \n        for (const orbit of Automorphism.orbit(halfEdge, this.automorphisms)) {\n          this.defaultLabel[orbit] = nextLabel;\n          this.defaultLabel[-orbit] = nextLabel;\n        }\n\n        nextLabel = this.nextLabel(nextLabel);\n      }\n\n      // Reset labels\n      this.label = Object.fromEntries(this.surface.halfEdges.map((halfEdge) => [halfEdge, this.defaultLabel[halfEdge]]));\n\n      this.$emit('layout', this.layout);\n      this.$nextTick(() => {\n        // TODO: Maybe we should not always export the SVG but only do so on demand.\n        const exporter = new SVGExporter(this.$refs.svg as HTMLElement);\n        exporter.simplifyColors();\n        exporter.dropNonStandardStyles();\n        exporter.dropNonInkscapeStyles();\n        exporter.dropTrivialStyles();\n        exporter.dropRedundantStyles();\n        exporter.dropClasses();\n        exporter.dropPrefixedStyles();\n        exporter.dropInvisible();\n        exporter.dropInteractiveStyles();\n        exporter.dropCustomAttributes();\n        exporter.usePresentationAttributes();\n        exporter.inlineStyles();\n        this.$emit('svg', exporter.toString());\n      });\n    });\n  }\n\n  get palette() {\n    return new Palette(this.visibleComponents.length);\n  }\n\n  @Provide()\n  svg(xy: Vector | Point | Segment) : Vector | Point | Segment {\n    if (xy instanceof Vector)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    if (xy instanceof Point)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    if (xy instanceof Segment)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    throw new Error(\"Cannot embed this type into the SVG coordinate system yet.\");\n  }\n\n  @Watch(\"forced\")\n  onForcedChanged() {\n    this.relayout();\n  }\n\n  @Watch(\"inner\", {immediate: true})\n  onInnerChanged() {\n    this.forced = this.inner;\n  }\n\n  forceHalfEdge(halfEdge: HalfEdge) {\n    this.forced.push(halfEdge);\n  }\n\n  async glue(halfEdge: HalfEdge) {\n    if (this.forced.includes(halfEdge) || this.forced.includes(-halfEdge))\n      this.forced = this.forced.filter((he) => he !== halfEdge && he !== -halfEdge);\n    else\n      this.forced.unshift(halfEdge);\n\n    this.selected.push(halfEdge); \n\n    await new Promise(resolve => this.$once(\"layout\", resolve));\n\n    await new Promise(resolve => setTimeout(resolve, 500));\n\n    this.selected = this.selected.filter((he) => he !== halfEdge && he !== -halfEdge);\n  }\n\n  hover(hover: HalfEdge, at: number) {\n    at = clamp(at, 0, 1);\n    for (const halfEdge of Automorphism.orbit(hover, this.automorphisms)) {\n      this.hovered.push(halfEdge);\n      this.indicator[halfEdge] = at;\n      this.indicator[-halfEdge] = 1 - at;\n      this.label[halfEdge] = String(halfEdge);\n      this.label[-halfEdge] = String(-halfEdge);\n    }\n  }\n\n  unhover(hover: HalfEdge) {\n    for (const halfEdge of Automorphism.orbit(hover, this.automorphisms)) {\n      this.hovered = this.hovered.filter((he) => he !== halfEdge && he !== -halfEdge);\n      this.indicator[halfEdge] = null;\n      this.indicator[-halfEdge] = null;\n      this.label[halfEdge] = this.defaultLabel[halfEdge];\n      this.label[-halfEdge] = this.defaultLabel[-halfEdge];\n    }\n  }\n\n  // TODO: This should live in a more generic place.\n  private relativizeOntoSegment(segment: Segment, point: Point): number {\n    const e = segment.value.tangentInStart();\n    const toPoint = new Vector(segment.parent, segment.start, point).value;\n    return e.dot(toPoint) / segment.value.length;\n  }\n\n  // TODO: This is a weird name.\n  @Provide()\n  halfEdgeConfiguration(halfEdge: HalfEdge): IHalfEdgeConfiguration {\n    return {\n      interactions: {\n        click: () => {\n          this.unhover(halfEdge)\n          this.glue(halfEdge)\n        },\n        // TODO: This assumes that this component fills the viewport coordinate system. That's probably always in practice true but maybe we should inject the offset.\n        enter: (ev: MouseEvent, segment: Segment) => this.hover(halfEdge, this.relativizeOntoSegment(segment, new Point(this.viewport.viewportCoordinateSystem, ev.clientX - this.$el.getBoundingClientRect().left, ev.clientY - this.$el.getBoundingClientRect().top))),\n        leave: () => this.unhover(halfEdge),\n        hover: (ev: MouseEvent, segment: Segment) => this.hover(halfEdge, this.relativizeOntoSegment(segment, new Point(this.viewport.viewportCoordinateSystem, ev.clientX - this.$el.getBoundingClientRect().left, ev.clientY - this.$el.getBoundingClientRect().top))),\n      },\n      state: {\n        selected: this.selected.includes(halfEdge) || this.selected.includes(-halfEdge),\n        glued: this.forced.includes(halfEdge) || this.forced.includes(-halfEdge),\n        label: this.label[halfEdge],\n        indicator: this.indicator[halfEdge],\n      },\n    };\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Surface.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Surface.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Surface.vue?vue&type=template&id=4ba7b6be&\"\nimport script from \"./Surface.vue?vue&type=script&lang=ts&\"\nexport * from \"./Surface.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport YAML from \"yaml\";\n\nimport CoordinateSystem from \"@/geometry/CoordinateSystem\";\nimport FlatTriangulation from \"@/geometry/triangulation/FlatTriangulation\";\nimport Automorphism from \"@/geometry/triangulation/Automorphism\";\nimport FlowComponent from \"@/geometry/triangulation/FlowComponent\";\nimport FlatTriangulationLayout from \"@/geometry/layout/FlatTriangulationLayout\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\n\nimport PanZoom from \"./PanZoom.vue\";\nimport Surface from \"./Surface.vue\";\n\n@Component({\n  components: {\n    Surface,\n    PanZoom,\n  }\n})\nexport default class SurfaceViewer extends Vue {\n  @Prop({ required: true }) raw!: string;\n  @Prop({ required: false, default: () => [], type: Array }) inner!: HalfEdge[];\n\n  private readonly idealCoordinateSystem = new CoordinateSystem(true);\n  protected surface: FlatTriangulation | null = null;\n  protected components: FlowComponent[] = [];\n  protected automorphisms: Automorphism[] = [];\n\n  focus = this.idealCoordinateSystem.box([-1, -1], [1, 1]);\n\n  protected onLayoutChanged(layout: FlatTriangulationLayout) {\n    if (!this.focus.equalTo(layout.bbox))\n      this.focus = layout.bbox;\n    this.$emit('layout', layout)\n    this.$emit('update:inner', this.surface!.halfEdges.filter((he) => layout.layout(he).inner));\n  }\n\n  protected onSVGChanged(svg: string) {\n    this.$emit('svg', svg);\n  }\n\n  @Watch(\"raw\", { immediate: true })\n  onRawChanged() {\n    try {\n      const parsed = YAML.parse(this.raw);\n      this.surface = FlatTriangulation.parse(parsed, this.idealCoordinateSystem);\n      this.components = (parsed.components || []).map((component: any) => FlowComponent.parse(component, this.idealCoordinateSystem));\n      this.automorphisms = (parsed.automorphisms || []).map((automorphism: any) => Automorphism.parse(automorphism));\n      this.$emit('ok');\n    } catch(e) {\n      this.$emit('error', e.message);\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SurfaceViewer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SurfaceViewer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SurfaceViewer.vue?vue&type=template&id=e5c2940a&\"\nimport script from \"./SurfaceViewer.vue?vue&type=script&lang=ts&\"\nexport * from \"./SurfaceViewer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default \"vertices:\\n- - 1\\n  - -3\\n  - -9\\n  - -21\\n  - 14\\n  - 6\\n  - -7\\n  - -17\\n  - -27\\n  - 25\\n  - -26\\n  - 23\\n  - 12\\n  - -13\\n  - 18\\n  - -19\\n  - 10\\n  - 4\\n- - -1\\n  - -5\\n  - -12\\n  - 16\\n  - 7\\n  - 2\\n- - -2\\n  - -6\\n  - -15\\n  - -25\\n  - 24\\n  - 13\\n  - 5\\n  - -4\\n  - -11\\n  - 21\\n  - -20\\n  - 17\\n  - -16\\n  - -23\\n  - 22\\n  - 19\\n  - 8\\n  - 3\\n- - -8\\n  - -18\\n  - -24\\n  - 27\\n  - 20\\n  - 9\\n- - -10\\n  - -22\\n  - 26\\n  - 15\\n  - -14\\n  - 11\\nvectors:\\n  1:\\n    x: 1.0\\n    y: 0.0\\n  2:\\n    x: -0.32635182233306964\\n    y: 0.565257937423568\\n  3:\\n    x: -0.6736481776669303\\n    y: -0.565257937423568\\n  4:\\n    x: 0.6736481776669303\\n    y: -0.565257937423568\\n  5:\\n    x: 0.32635182233306964\\n    y: 0.565257937423568\\n  6:\\n    x: -0.8263518223330697\\n    y: -0.3007674663608706\\n  7:\\n    x: 0.5\\n    y: 0.8660254037844386\\n  8:\\n    x: -0.5\\n    y: 0.41954981558864\\n  9:\\n    x: -0.17364817766693036\\n    y: -0.984807753012208\\n  10:\\n    x: 0.17364817766693036\\n    y: -0.984807753012208\\n  11:\\n    x: 0.5\\n    y: 0.41954981558864\\n  12:\\n    x: -0.5\\n    y: 0.8660254037844386\\n  13:\\n    x: 0.8263518223330697\\n    y: -0.3007674663608706\\n  14:\\n    x: -0.9396926207859084\\n    y: 0.3420201433256687\\n  15:\\n    x: 0.11334079845283873\\n    y: -0.6427876096865394\\n  16:\\n    x: 0.6527036446661393\\n    y: 0.0\\n  17:\\n    x: -0.1527036446661393\\n    y: 0.8660254037844386\\n  18:\\n    x: -0.9396926207859084\\n    y: -0.3420201433256687\\n  19:\\n    x: 0.4396926207859084\\n    y: 0.7615699589143088\\n  20:\\n    x: -0.6133407984528387\\n    y: -0.22323779409789932\\n  21:\\n    x: 0.4396926207859084\\n    y: -0.7615699589143088\\n  22:\\n    x: 0.6133407984528387\\n    y: -0.22323779409789932\\n  23:\\n    x: 0.1527036446661393\\n    y: 0.8660254037844386\\n  24:\\n    x: -0.11334079845283873\\n    y: -0.6427876096865394\\n  25:\\n    x: 0.8793852415718167\\n    y: 0.0\\n  26:\\n    x: -0.766044443118978\\n    y: -0.6427876096865394\\n  27:\\n    x: -0.766044443118978\\n    y: 0.6427876096865394\\ncomponents:\\n- cylinder: true\\n  perimeter:\\n  - source: 25\\n    target: -25\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.8793852415718167\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 25\\n      index: 0\\n    - halfEdge: -25\\n      index: 1\\n  - source: -15\\n    target: 13\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -1.7057370639048863\\n      y: 0.3007674663608706\\n    crossings:\\n    - halfEdge: 26\\n      at: 0.8006595491452156\\n    - halfEdge: -23\\n      at: 0.8263518223330697\\n    - halfEdge: -12\\n      at: 0.8006595491452156\\n    touches:\\n    - halfEdge: -15\\n      index: 0\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: 13\\n      index: 0\\n  - source: -25\\n    target: 25\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.8793852415718167\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -25\\n      index: 0\\n    - halfEdge: 25\\n      index: 1\\n  - source: -27\\n    target: -13\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 1.7057370639048863\\n      y: -0.3007674663608706\\n    crossings:\\n    - halfEdge: -24\\n      at: 0.766044443118978\\n    touches:\\n    - halfEdge: -27\\n      index: 0\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -13\\n      index: 0\\n  inside:\\n  - 13\\n  - -13\\n  - 25\\n  - -25\\n- cylinder: true\\n  perimeter:\\n  - source: 1\\n    target: -1\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 1.0\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 1\\n      index: 0\\n    - halfEdge: -1\\n      index: 1\\n  - source: 16\\n    target: -16\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.6527036446661393\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 16\\n      index: 0\\n    - halfEdge: -16\\n      index: 1\\n  - source: 17\\n    target: 22\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: -7\\n      at: 0.8793852415718167\\n    - halfEdge: -2\\n      at: 0.7733184030943225\\n    - halfEdge: 3\\n      at: 0.5739779522395382\\n    - halfEdge: 9\\n      at: 0.713011023880231\\n    - halfEdge: 21\\n      at: 0.5739779522395382\\n    - halfEdge: -11\\n      at: 0.7733184030943225\\n    - halfEdge: 10\\n      at: 0.8793852415718167\\n    touches:\\n    - halfEdge: 17\\n      index: 0\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -2\\n      index: 0\\n    - halfEdge: 2\\n      index: 0\\n    - halfEdge: 3\\n      index: 0\\n    - halfEdge: -3\\n      index: 0\\n    - halfEdge: 9\\n      index: 0\\n    - halfEdge: -9\\n      index: 0\\n    - halfEdge: 21\\n      index: 0\\n    - halfEdge: -21\\n      index: 0\\n    - halfEdge: -11\\n      index: 0\\n    - halfEdge: 11\\n      index: 0\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 22\\n      index: 0\\n  - source: -16\\n    target: 16\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.6527036446661393\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -16\\n      index: 0\\n    - halfEdge: 16\\n      index: 1\\n  - source: -1\\n    target: 1\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -1.0\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -1\\n      index: 0\\n    - halfEdge: 1\\n      index: 1\\n  - source: 4\\n    target: 14\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: 5\\n      at: 0.7168814171420514\\n    - halfEdge: 12\\n      at: 0.7733184030943225\\n    - halfEdge: 23\\n      at: 0.6736481776669303\\n    - halfEdge: -26\\n      at: 0.7733184030943225\\n    - halfEdge: -15\\n      at: 0.7168814171420514\\n    touches:\\n    - halfEdge: 4\\n      index: 0\\n    - halfEdge: 5\\n      index: 0\\n    - halfEdge: -5\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -15\\n      index: 0\\n    - halfEdge: 15\\n      index: 0\\n    - halfEdge: 14\\n      index: 0\\n  inside:\\n  - 1\\n  - -1\\n  - 14\\n  - -14\\n  - 16\\n  - -16\\n  - 22\\n  - -22\\n- cylinder: true\\n  perimeter:\\n  - source: 22\\n    target: -4\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 1.1133407984528387\\n      y: 0.19631202149074067\\n    crossings:\\n    - halfEdge: -10\\n      at: 0.32635182233306964\\n    touches:\\n    - halfEdge: 22\\n      index: 0\\n    - halfEdge: -10\\n      index: 2\\n    - halfEdge: 10\\n      index: 1\\n    - halfEdge: -4\\n      index: 1\\n  - source: -4\\n    target: -2\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: 10\\n      at: 0.4679111137620439\\n    - halfEdge: -19\\n      at: 0.532088886237956\\n    - halfEdge: 18\\n      at: 0.8793852415718167\\n    - halfEdge: 24\\n      at: 0.9076037345479523\\n    - halfEdge: -27\\n      at: 0.8793852415718167\\n    - halfEdge: -17\\n      at: 0.532088886237956\\n    - halfEdge: -7\\n      at: 0.4679111137620439\\n    touches:\\n    - halfEdge: -4\\n      index: 2\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -10\\n      index: 3\\n    - halfEdge: -19\\n      index: 0\\n    - halfEdge: 19\\n      index: 0\\n    - halfEdge: 18\\n      index: 0\\n    - halfEdge: -18\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: -27\\n      index: 0\\n    - halfEdge: 27\\n      index: 0\\n    - halfEdge: -17\\n      index: 0\\n    - halfEdge: 17\\n      index: 1\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 7\\n      index: 1\\n    - halfEdge: -2\\n      index: 0\\n  - source: 8\\n    target: 21\\n    vertical: true\\n    boundary: false\\n    vector:\\n      x: -1.1133407984528387\\n      y: 0.19631202149074067\\n    crossings:\\n    - halfEdge: 9\\n      at: 0.32635182233306964\\n    touches:\\n    - halfEdge: 8\\n      index: 0\\n    - halfEdge: 9\\n      index: 1\\n    - halfEdge: -9\\n      index: 1\\n    - halfEdge: 21\\n      index: 1\\n  - source: -4\\n    target: 22\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -1.1133407984528387\\n      y: -0.19631202149074067\\n    crossings:\\n    - halfEdge: 10\\n      at: 0.6736481776669303\\n    touches:\\n    - halfEdge: -4\\n      index: 0\\n    - halfEdge: 10\\n      index: 2\\n    - halfEdge: -10\\n      index: 1\\n    - halfEdge: 22\\n      index: 1\\n  - source: 22\\n    target: 17\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: -10\\n      at: 0.12061475842818323\\n    - halfEdge: 11\\n      at: 0.22668159690567746\\n    - halfEdge: -21\\n      at: 0.4260220477604618\\n    - halfEdge: -9\\n      at: 0.2869889761197691\\n    - halfEdge: -3\\n      at: 0.4260220477604618\\n    - halfEdge: 2\\n      at: 0.22668159690567746\\n    - halfEdge: 7\\n      at: 0.12061475842818323\\n    touches:\\n    - halfEdge: 22\\n      index: 2\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 10\\n      index: 3\\n    - halfEdge: 11\\n      index: 0\\n    - halfEdge: -11\\n      index: 0\\n    - halfEdge: -21\\n      index: 0\\n    - halfEdge: 21\\n      index: 2\\n    - halfEdge: -9\\n      index: 0\\n    - halfEdge: 9\\n      index: 2\\n    - halfEdge: -3\\n      index: 0\\n    - halfEdge: 3\\n      index: 0\\n    - halfEdge: 2\\n      index: 0\\n    - halfEdge: -2\\n      index: 1\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -7\\n      index: 1\\n    - halfEdge: 17\\n      index: 0\\n  - source: 21\\n    target: 8\\n    vertical: true\\n    boundary: false\\n    vector:\\n      x: 1.1133407984528387\\n      y: -0.19631202149074067\\n    crossings:\\n    - halfEdge: -9\\n      at: 0.6736481776669303\\n    touches:\\n    - halfEdge: 21\\n      index: 0\\n    - halfEdge: -9\\n      index: 2\\n    - halfEdge: 9\\n      index: 0\\n    - halfEdge: 8\\n      index: 1\\n  inside:\\n  - 8\\n  - -8\\n  - 20\\n  - -20\\n- cylinder: true\\n  perimeter:\\n  - source: -6\\n    target: 6\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.8263518223330697\\n      y: 0.3007674663608706\\n    crossings: []\\n    touches:\\n    - halfEdge: -6\\n      index: 0\\n    - halfEdge: 6\\n      index: 1\\n  - source: 14\\n    target: 4\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: 15\\n      at: 0.28311858285794855\\n    - halfEdge: 26\\n      at: 0.22668159690567746\\n    - halfEdge: -23\\n      at: 0.32635182233306964\\n    - halfEdge: -12\\n      at: 0.22668159690567746\\n    - halfEdge: -5\\n      at: 0.28311858285794855\\n    touches:\\n    - halfEdge: 14\\n      index: 0\\n    - halfEdge: 15\\n      index: 0\\n    - halfEdge: -15\\n      index: 1\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -26\\n      index: 1\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: 23\\n      index: 1\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 12\\n      index: 1\\n    - halfEdge: -5\\n      index: 0\\n    - halfEdge: 5\\n      index: 0\\n    - halfEdge: 4\\n      index: 0\\n  - source: -13\\n    target: -27\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -1.7057370639048863\\n      y: 0.3007674663608706\\n    crossings:\\n    - halfEdge: 24\\n      at: 0.23395555688102196\\n    touches:\\n    - halfEdge: -13\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -24\\n      index: 1\\n    - halfEdge: -27\\n      index: 0\\n  - source: 6\\n    target: -6\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.8263518223330697\\n      y: -0.3007674663608706\\n    crossings: []\\n    touches:\\n    - halfEdge: 6\\n      index: 0\\n    - halfEdge: -6\\n      index: 1\\n  - source: -2\\n    target: -4\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: 7\\n      at: 0.532088886237956\\n    - halfEdge: 17\\n      at: 0.4679111137620439\\n    - halfEdge: 27\\n      at: 0.12061475842818323\\n    - halfEdge: -24\\n      at: 0.09239626545204768\\n    - halfEdge: -18\\n      at: 0.12061475842818323\\n    - halfEdge: 19\\n      at: 0.4679111137620439\\n    - halfEdge: -10\\n      at: 0.532088886237956\\n    touches:\\n    - halfEdge: -2\\n      index: 0\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 17\\n      index: 0\\n    - halfEdge: -17\\n      index: 0\\n    - halfEdge: 27\\n      index: 0\\n    - halfEdge: -27\\n      index: 1\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: 24\\n      index: 1\\n    - halfEdge: -18\\n      index: 0\\n    - halfEdge: 18\\n      index: 0\\n    - halfEdge: 19\\n      index: 0\\n    - halfEdge: -19\\n      index: 0\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -4\\n      index: 0\\n  - source: 13\\n    target: -15\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 1.7057370639048863\\n      y: -0.3007674663608706\\n    crossings:\\n    - halfEdge: 12\\n      at: 0.19934045085478438\\n    - halfEdge: 23\\n      at: 0.17364817766693036\\n    - halfEdge: -26\\n      at: 0.19934045085478438\\n    touches:\\n    - halfEdge: 13\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: -12\\n      index: 1\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -23\\n      index: 1\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: 26\\n      index: 1\\n    - halfEdge: -15\\n      index: 0\\n  inside:\\n  - 4\\n  - -4\\n  - 6\\n  - -6\\n\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.cancellation != null && _vm.visible)?_c('v-overlay',{staticClass:\"loading-overlay\",attrs:{\"opacity\":.2,\"z-index\":0}},[_c('v-container',[_c('v-row',[_c('v-col',[_vm._v(\" \"+_vm._s(_vm.name)+\"… \"),_c('v-progress-circular',{attrs:{\"indeterminate\":_vm.value == null,\"value\":_vm.value}})],1)],1),_c('v-row',[_c('v-col',[_c('v-btn',{attrs:{\"color\":\"error\",\"dark\":\"\",\"disabled\":_vm.cancellation.cancelled},on:{\"click\":function () { return _vm.cancellation.cancel(); }}},[_vm._v(\"Cancel\")])],1)],1)],1)],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport CancellationToken from \"../src/CancellationToken\";\nimport Progress from \"../src/Progress\";\n\n@Component\nexport default class Overlay extends Vue {\n  @Prop({required: true}) cancellation!: CancellationToken | null;\n  @Prop({required: true}) progress!: Progress | null;\n\n  visible = false;\n\n  @Watch(\"cancellation\", {immediate: true})\n  onCancellation(value: CancellationToken) {\n    if (value == null)\n      this.visible = false;\n    else\n      setTimeout(() => {\n        if (this.cancellation === value)\n          this.visible = true\n      }, 150);\n  }\n\n  get name() {\n    return this.progress!.stats.name;\n  }\n\n  get value() : number | null {\n    if (this.progress!.stats.step == null || this.progress!.stats.steps == null)\n      return null;\n    return this.progress!.stats.step / this.progress!.stats.steps * 100;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Overlay.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Overlay.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Overlay.vue?vue&type=template&id=3e466302&scoped=true&\"\nimport script from \"./Overlay.vue?vue&type=script&lang=ts&\"\nexport * from \"./Overlay.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Overlay.vue?vue&type=style&index=0&id=3e466302&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3e466302\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VOverlay } from 'vuetify/lib/components/VOverlay';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCol,VContainer,VOverlay,VProgressCircular,VRow})\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Provide, Vue } from \"vue-property-decorator\";\nimport PanZoom from \"@/components/PanZoom.vue\";\nimport SurfaceViewer from \"@/components/SurfaceViewer.vue\";\nimport dump from \"!!raw-loader!./2-3-4-pullback-flow.txt\";\nimport CancellationToken from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\nimport Overlay from \"./Overlay.vue\";\n\n@Component({\n  components: {\n    Overlay,\n    PanZoom,\n    SurfaceViewer,\n  }\n})\nexport default class App extends Vue {\n  raw = dump;\n  editor = false;\n  svg = false;\n  svgExport = null;\n  overlay = null as CancellationToken | null;\n  error = null as string | null;\n  progress = null as Progress | null;\n\n  @Provide()\n  async run(callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>) {\n    // Any previous run is supposedly cancelled already so we can safely throw\n    // away its cancellation and progress tokens.\n    const cancellation = new CancellationToken();\n    this.overlay = cancellation;\n    this.progress = new Progress();\n    try {\n      await callback(this.overlay, this.progress);\n    } finally {\n      if (this.overlay === cancellation)\n        // We came here because this process completed. Remove the overlay.\n        this.overlay = null;\n    }\n  }\n\n  onError(message: string | null = null) {\n    this.error= message;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=34a12f70&scoped=true&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=34a12f70&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"34a12f70\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VMain } from 'vuetify/lib/components/VMain';\nimport { VTextarea } from 'vuetify/lib/components/VTextarea';\nimport { VToolbar } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VApp,VBtn,VCard,VCardTitle,VContainer,VDialog,VForm,VIcon,VMain,VTextarea,VToolbar})\n","import Vue, { VNode } from 'vue';\nimport App from './App.vue';\nimport Vuetify from 'vuetify/lib';\nimport '@mdi/font/css/materialdesignicons.css'\n\nVue.config.productionTip = false;\n\nVue.use(Vuetify);\n\nnew Vue({\n    render: (h): VNode => h(App),\n    vuetify: new Vuetify({}),\n}).$mount('#app');\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkvue_flatsurf\"] = self[\"webpackChunkvue_flatsurf\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(7457); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}