{"version":3,"sources":["webpack://vue-flatsurf/./demo/App.vue?89a8","webpack://vue-flatsurf/./src/components/PanZoom.vue?7c96","webpack://vue-flatsurf/./src/geometry/Point.ts","webpack://vue-flatsurf/./src/geometry/Box.ts","webpack://vue-flatsurf/./src/geometry/Vector.ts","webpack://vue-flatsurf/./src/geometry/Segment.ts","webpack://vue-flatsurf/./src/geometry/Line.ts","webpack://vue-flatsurf/./src/geometry/CoordinateSystem.ts","webpack://vue-flatsurf/./src/geometry/Viewport.ts","webpack://vue-flatsurf/./src/components/PanZoom.vue","webpack://vue-flatsurf/./src/components/PanZoom.vue?9fa1","webpack://vue-flatsurf/./src/components/PanZoom.vue?7336","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?359f","webpack://vue-flatsurf/./src/geometry/triangulation/Permutation.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlatTriangulation.ts","webpack://vue-flatsurf/./src/geometry/triangulation/SaddleConnection.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlowConnection.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlowComponent.ts","webpack://vue-flatsurf/./src/components/Surface.vue?6716","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?52c0","webpack://vue-flatsurf/./src/components/Face.vue?15c5","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?5e9a","webpack://vue-flatsurf/./src/components/svg/Ngon.vue","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?259e","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?ed49","webpack://vue-flatsurf/./src/components/Face.vue","webpack://vue-flatsurf/./src/components/Face.vue?dab4","webpack://vue-flatsurf/./src/components/Face.vue?1bf1","webpack://vue-flatsurf/./src/components/HalfEdge.vue?8482","webpack://vue-flatsurf/./src/components/svg/Segment.vue?e756","webpack://vue-flatsurf/./src/components/svg/Segment.vue","webpack://vue-flatsurf/./src/components/svg/Segment.vue?4ff6","webpack://vue-flatsurf/./src/components/svg/Segment.vue?c246","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?8f92","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?f6d6","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?aaf3","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?319a","webpack://vue-flatsurf/./src/components/svg/Arrow.vue","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?d680","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?5da5","webpack://vue-flatsurf/./src/components/svg/ExtendedClickArea.vue?3bfa","webpack://vue-flatsurf/./src/components/svg/ExtendedClickArea.vue","webpack://vue-flatsurf/./src/components/HalfEdgeConfiguration.ts","webpack://vue-flatsurf/./src/components/HalfEdge.vue","webpack://vue-flatsurf/./src/components/HalfEdge.vue?2ee5","webpack://vue-flatsurf/./src/components/HalfEdge.vue?fa65","webpack://vue-flatsurf/./src/geometry/Polygon.ts","webpack://vue-flatsurf/./src/Progress.ts","webpack://vue-flatsurf/./src/CancellationToken.ts","webpack://vue-flatsurf/./src/geometry/layout/CellLayout.ts","webpack://vue-flatsurf/./src/geometry/layout/FlatTriangulationLayout.ts","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?e38e","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?9e07","webpack://vue-flatsurf/./src/components/FlowComponent.vue?277f","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?5ae3","webpack://vue-flatsurf/./src/components/SaddleConnection.vue","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?4ee1","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?5a2a","webpack://vue-flatsurf/./src/components/FlowComponent.vue","webpack://vue-flatsurf/./src/components/FlowComponent.vue?4dde","webpack://vue-flatsurf/./src/components/FlowComponent.vue?bd31","webpack://vue-flatsurf/./src/Palette.ts","webpack://vue-flatsurf/./src/components/Surface.vue","webpack://vue-flatsurf/./src/components/Surface.vue?3189","webpack://vue-flatsurf/./src/components/Surface.vue?94ad","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?1ac1","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?3274","webpack://vue-flatsurf/./demo/2-3-4-pullback-flow.txt","webpack://vue-flatsurf/./demo/Overlay.vue?dac6","webpack://vue-flatsurf/./demo/Overlay.vue","webpack://vue-flatsurf/./demo/Overlay.vue?3854","webpack://vue-flatsurf/./demo/Overlay.vue?d4f7","webpack://vue-flatsurf/./demo/App.vue","webpack://vue-flatsurf/./demo/App.vue?2c48","webpack://vue-flatsurf/./demo/App.vue?7ebf","webpack://vue-flatsurf/./demo/main.ts","webpack://vue-flatsurf/webpack/bootstrap","webpack://vue-flatsurf/webpack/runtime/chunk loaded","webpack://vue-flatsurf/webpack/runtime/compat get default export","webpack://vue-flatsurf/webpack/runtime/define property getters","webpack://vue-flatsurf/webpack/runtime/global","webpack://vue-flatsurf/webpack/runtime/hasOwnProperty shorthand","webpack://vue-flatsurf/webpack/runtime/make namespace object","webpack://vue-flatsurf/webpack/runtime/jsonp chunk loading","webpack://vue-flatsurf/webpack/startup"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","overlay","progress","raw","on","onError","scopedSlots","_u","key","fn","ref","_g","_b","error","_v","model","value","callback","$$v","editor","expression","$event","staticClass","staticRenderFns","class","pan","onMouseDown","onMouseUp","_t","viewport","Point","parent","x","y","equalTo","rhs","epsilon","Math","abs","embed","toString","shape","translate","vector","Box","xy0","xy1","Array","min","max","shapes","length","Error","boxes","map","box","reduce","a","b","merge","contain","aspectRatio","xmin","height","width","ymin","xmax","ymax","other","low","high","Vector","yaml","coordinateSystem","rotate90CW","positive","rotate90CCW","normalize","multiply","scalar","angleTo","ccw","invert","add","v","Segment","end","CoordinateSystem","console","assert","undefined","start","middle","tangentInStart","tangentInEnd","at","relative","delta","intersect","intersections","push","intersects","touch","reverse","Line","pt","norm","intersection","A","a00","a01","a02","a10","a11","a12","a20","a21","a22","c","tx","d","ty","adj","det","inv","affine","embeddedInto","embedding","embedInto","into","point","xy","transform","JSON","stringify","inverse","origin","Viewport","ideal","idealCoordinateSystem","viewportCoordinateSystem","visible","focused","resize","focus","zoom","factor","center","centerBefore","centerAfter","PanZoom","observer","ResizeObserver","unpanzoom","$refs","clientWidth","window","innerWidth","clientHeight","innerHeight","refocus","mounted","$el","panzoom","observe","beforeDestroy","unobserve","e","dz","exp","dx","dy","required","type","immediate","component","surface","components","inner","onLayoutChanged","Permutation","cycles","mapping","cycle","i","fromMapping","entry","String","xor","Object","keys","find","includes","pop","image","preimage","values","FlatTriangulation","fromCycles","vertices","fromEntries","entries","vectors","halfEdge","parse","halfEdges","domain","faces","he","Number","face","sum","SaddleConnection","source","target","crossings","freeze","FlowConnection","vertical","boundary","touches","connection","FlowComponent","cylinder","perimeter","inside","layout","_l","palette","color","_e","forced","segment","points","Ngon","svg","join","Face","indicator","halfEdgeConfiguration","state","labeled","_s","onClick","onMouseEnter","onMouseLeave","onMouseMove","selected","glued","coords","embedded","transformation","HalfEdgeLabel","midpoint","normal","position","x1","y1","x2","y2","atEnd","SVGArrow","endWithoutHead","PI","preventDefault","stopPropagation","$emit","apply","arguments","script","DefaultHalfEdgeConfiguration","interactions","click","enter","leave","hover","HalfEdgeComponent","ev","default","Arrow","ExtendedClickArea","SegmentComponent","SegmentLabel","Polygon","convexHull","p","some","hull","q","last","next","leftTo","polygon","addFace","minArea","minAreaRect","edge","edges","direction","theta","rotation","cos","sin","aligned","area","toPoints","vertex","Progress","constructor","name","steps","task","step","OperationAborted","CancellationToken","cancellationRequested","Promise","resolve","reject","aborted","setTimeout","cancelled","cancel","abort","CellLayout","cell","boundingRectArea","boundingRect","before","glues","otherPolygon","touchConsistent","filter","boundaries","side","pending","Set","size","delete","cells","force","cache","cancellation","_progress","scores","glue","score","best","minBy","ca","cb","dc","x00","x01","x02","x10","x11","x12","x20","x21","x22","delaunay","ungluedArea","gluedArea","isArray","every","hasOwnProperty","packed","cell_","halfEdge_","splice","packable","segment_","screen","FlatTriangulationLayout","recompute","_","pack","assign","log","bbox","created","relayout","surfaceChanged","forcedChanged","run","async","from","_run","style","segments","crossing","shift","line","crossingEdge","crossingLine","alongHalfEdge","ats","resetCaches","ensureCaches","index","floor","patch","isHalfEdge","B","C","scenario","atouches","btouches","patchHalfEdge","patches","SaddleConnectionComponent","Palette","colors","seed","warn","Surface","hovered","onInnerChanged","forceHalfEdge","unshift","$once","unhover","relativizeOntoSegment","toPoint","dot","clientX","getBoundingClientRect","left","clientY","top","FlatTriangulationComponent","FlowComponentComponent","SurfaceViewer","onRawChanged","parsed","message","Overlay","onCancellation","stats","VBtn","App","VApp","h","vuetify","$mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","deferred","O","result","chunkIds","priority","notFulfilled","Infinity","fulfilled","j","r","n","getter","__esModule","definition","o","defineProperty","enumerable","get","g","globalThis","Function","obj","prop","prototype","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","chunkLoadingGlobal","self","forEach","bind","__webpack_exports__"],"mappings":"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","file":"js/app-legacy.b37ac3cb.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',[_c('v-main',[_c('v-container',{attrs:{\"fluid\":\"\",\"fill-height\":\"\"}},[_c('overlay',{attrs:{\"cancellation\":_vm.overlay,\"progress\":_vm.progress}}),_c('surface-viewer',{attrs:{\"raw\":_vm.raw},on:{\"error\":_vm.onError,\"ok\":function () { return _vm.onError(); }}})],1),_c('v-dialog',{attrs:{\"fullscreen\":\"\",\"hide-overlay\":\"\",\"transition\":\"dialog-bottom-transition\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({attrs:{\"color\":_vm.error ? 'red': 'green',\"dark\":\"\",\"dense\":\"\",\"small\":\"\",\"fixed\":\"\",\"bottom\":\"\",\"right\":\"\",\"fab\":\"\"}},'v-btn',attrs,false),on),[(!_vm.error)?_c('v-icon',[_vm._v(\"mdi-pencil\")]):_c('v-icon',[_vm._v(\"mdi-alert-circle-outline\")])],1)]}}]),model:{value:(_vm.editor),callback:function ($$v) {_vm.editor=$$v},expression:\"editor\"}},[_c('v-card',[_c('v-toolbar',{attrs:{\"dark\":\"\",\"cards\":\"\",\"color\":_vm.error ? 'red' : 'green'}},[_c('v-btn',{attrs:{\"icon\":\"\",\"dark\":\"\"},on:{\"click\":function($event){_vm.editor = false}}},[_c('v-icon',[_vm._v(\"mdi-arrow-left\")])],1),_c('v-card-title',[_vm._v(\"Flat Triangulation Data\")])],1),_c('v-form',{staticClass:\"pa-6 pt-6\"},[_c('v-textarea',{staticClass:\"editor\",attrs:{\"error-messages\":_vm.error,\"auto-grow\":\"\",\"filled\":\"\",\"rows\":\"1\"},model:{value:(_vm.raw),callback:function ($$v) {_vm.raw=$$v},expression:\"raw\"}})],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"viewport\",class:{ pan: _vm.pan },on:{\"mousedown\":_vm.onMouseDown,\"mouseup\":_vm.onMouseUp}},[_vm._t(\"default\",null,{\"viewport\":_vm.viewport})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Vector from './Vector';\nimport Polygon from './Polygon';\n\nexport default class Point {\n  public constructor(parent: CoordinateSystem, x: Coordinate, y: Coordinate);\n  public constructor(parent: CoordinateSystem, p: Flatten.Point);\n  public constructor(parent: CoordinateSystem, x: Coordinate | Flatten.Point, y?: Coordinate) {\n    this.parent = parent;\n    if (typeof(x) === \"number\")\n      this.value = new Flatten.Point(x, y);\n    else\n      this.value = x;\n  }\n  \n  public get x() { return this.value.x; }\n  public get y() { return this.value.y; }\n  public get xy() : [Coordinate, Coordinate] { return [this.x, this.y]; }\n\n  public equalTo(rhs: Point, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return Math.abs(this.x - rhs.x) <= epsilon && Math.abs(this.y - rhs.y) <= epsilon;\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public toString(): string {\n    return `(${this.x}, ${this.y})`;\n  }\n\n  public on(shape: Polygon): boolean {\n    return shape.parent.embed(this).value.on(shape.value);\n  }\n\n  public translate(vector: Vector): Point {\n    return new Point(this.parent, this.value.translate(this.parent.embed(vector).value));\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Point;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Point from \"./Point\";\nimport Segment from './Segment';\n\nexport default class Box {\n  public constructor(parent: CoordinateSystem, box: Flatten.Box);\n  public constructor(parent: CoordinateSystem, xy0: [Coordinate, Coordinate], xy1: [Coordinate, Coordinate]);\n  public constructor(parent: CoordinateSystem, xy0: [Coordinate, Coordinate] | Flatten.Box, xy1?: [Coordinate, Coordinate]) {\n    this.parent = parent;\n\n    if (xy0 instanceof Flatten.Box) {\n      this.value = xy0;\n    } else {\n      assert(xy1 instanceof Array);\n      this.value = new Flatten.Box(Math.min(xy0[0], xy1[0]), Math.min(xy0[1], xy1[1]), Math.max(xy0[0], xy1[0]), Math.max(xy0[1], xy1[1]));\n    }\n  }\n\n  public static bbox(shapes: Array<Point|Segment>): Box {\n    if (shapes.length === 0)\n      throw Error(\"cannot create bounding box of nothing\");\n\n    const boxes = shapes.map((shape) => {\n      if (shape instanceof Point)\n        return new Box(shape.parent, [shape.value.x, shape.value.y], [shape.value.x, shape.value.y]);\n      else\n        return new Box(shape.parent, shape.value.box);\n    });\n    return boxes.reduce((a: Box, b: Box) => a.merge(b));\n  }\n\n  // Return an enlargened version of this box that has the prescribed aspect\n  // ratio (leaving one of its dimensions untouched and centering it in the\n  // other dimension.)\n  public contain(aspectRatio: number) {\n    if (this.aspectRatio < aspectRatio)\n      return new Box(this.parent, [this.value.xmin - (this.height * aspectRatio - this.width) / 2, this.value.ymin], [this.value.xmax + (this.height * aspectRatio - this.width) / 2, this.value.ymax]);\n    else\n      return new Box(this.parent, [this.value.xmin, this.value.ymin - (this.width / aspectRatio - this.height) / 2], [this.value.xmax, this.value.ymax + (this.width / aspectRatio - this.height) / 2]);\n  }\n\n  public merge(other: Box): Box {\n    return new Box(this.parent, this.value.merge(this.parent.embed(other).value));\n  }\n\n  public translate(x: Coordinate, y: Coordinate) {\n    return new Box(this.parent, [this.value.xmin + x, this.value.ymin + y], [this.value.xmax + x, this.value.ymax + y]);\n  }\n\n  public get low() {\n    return new Point(this.parent, this.value.xmin, this.value.ymin);\n  }\n\n  public get high() {\n    return new Point(this.parent, this.value.xmax, this.value.ymax);\n  }\n\n  public get aspectRatio() {\n    return this.width / this.height;\n  }\n\n  public get width() {\n    return this.value.xmax - this.value.xmin;\n  }\n\n  public get center() {\n    return new Point(this.parent, (this.value.xmin + this.value.xmax) / 2, (this.value.ymin + this.value.ymax) / 2);\n  }\n\n  public get height() {\n    return this.value.ymax - this.value.ymin;\n  }\n\n  public equalTo(rhs: Box, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return this.low.equalTo(rhs.low, epsilon) && this.high.equalTo(rhs.high, epsilon);\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Box;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Point from './Point';\n\nexport interface VectorSchema {\n  x: number,\n  y: number,\n};\n\nexport default class Vector {\n  public constructor(parent: CoordinateSystem, x: Coordinate, y: Coordinate);\n  public constructor(parent: CoordinateSystem, p: Flatten.Vector);\n  public constructor(parent: CoordinateSystem, a: Point, b: Point);\n  public constructor(parent: CoordinateSystem, x: Coordinate | Flatten.Vector | Point, y?: Coordinate | Point) {\n    this.parent = parent;\n    if (typeof(x) === \"number\") {\n      assert(typeof(y) === \"number\");\n      this.value = new Flatten.Vector(x, y);\n    } else if (x instanceof Flatten.Vector) {\n      assert(y == null);\n      this.value = x;\n    } else {\n      assert(x instanceof Point);\n      assert(y instanceof Point);\n      const a = parent.embed(x);\n      const b = parent.embed(y);\n      this.value = new Flatten.Vector(a.value, b.value);\n    }\n  }\n\n  public static parse(yaml: VectorSchema, coordinateSystem: CoordinateSystem): Vector {\n    return new Vector(coordinateSystem, yaml.x, yaml.y);\n  }\n  \n  public get x() { return this.value.x; }\n  public get y() { return this.value.y; }\n  public get xy() : [Coordinate, Coordinate] { return [this.x, this.y]; }\n\n  public rotate90CW() {\n    return new Vector(this.parent, this.parent.positive ? this.value.rotate90CW(): this.value.rotate90CCW());\n  }\n\n  public rotate90CCW() {\n    return new Vector(this.parent, this.parent.positive ? this.value.rotate90CCW(): this.value.rotate90CW());\n  }\n\n  public normalize() {\n    return new Vector(this.parent, this.value.normalize());\n  }\n\n  public multiply(scalar: number) {\n    return new Vector(this.parent, this.value.multiply(scalar));\n  }\n\n  public angleTo(ccw: Vector) {\n    return this.parent.positive ? this.parent.embed(ccw).value.angleTo(this.value) : this.value.angleTo(this.parent.embed(ccw).value);\n  }\n\n  public invert() {\n    return new Vector(this.parent, this.value.invert());\n  }\n\n  public add(v: Vector) {\n    return new Vector(this.parent, this.value.add(this.parent.embed(v).value));\n  }\n\n  public equalTo(rhs: Vector, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return Math.abs(this.x - rhs.x) <= epsilon && Math.abs(this.y - rhs.y) <= epsilon;\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Vector;\n}\n\n\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Point from \"./Point\";\nimport Polygon from './Polygon';\nimport Vector from './Vector';\n\nexport default class Segment {\n  public constructor(start: Point, end: Point);\n  public constructor(parent: CoordinateSystem, value: Flatten.Segment);\n  public constructor(parent: CoordinateSystem, start: Flatten.Point, end: Flatten.Point);\n  public constructor(parent: CoordinateSystem | Point, value: Point | Flatten.Point | Flatten.Segment, end?: Flatten.Point){\n    if (!(parent instanceof CoordinateSystem)) {\n      console.assert(value instanceof Point, value);\n      ({parent, value, end} = {\n        parent: parent.parent,\n        value: parent.value,\n        end: parent.parent.embed(value as Point).value,\n      });\n    }\n\n    this.parent = parent;\n    if (end !== undefined) {\n      const start = value as Flatten.Point;\n      this.value = new Flatten.Segment(start, end);\n    } else {\n      this.value = value as Flatten.Segment;\n    }\n  }\n  \n  public get start() { return new Point(this.parent, this.value.start); }\n  public get middle() { return new Point(this.parent, this.value.middle()); }\n  public get end() { return new Point(this.parent, this.value.end); }\n  public get tangentInStart() { return new Vector(this.parent, this.value.tangentInStart()); }\n  public get tangentInEnd() { return new Vector(this.parent, this.value.tangentInEnd()); }\n\n  public at(relative: number) {\n    return this.start.translate(new Vector(this.parent, this.start, this.end).multiply(relative));\n  }\n\n  public translate(delta: Vector): Segment {\n    delta = this.parent.embed(delta);\n    return new Segment(this.parent, this.value.translate(delta.value));\n  }\n\n  // Return the points of intersection between this segment and the segments\n  // forming the boundary of the polygon. If this segment overlaps with one of\n  // the boundary segments, the end points of the overlap are included. If it\n  // touches, the point of touching is included.\n  public intersect(shape: Polygon): Point[] {\n    const intersections = shape.parent.embed(this).value.intersect(shape.value).map(value => new Point(shape.parent, value));\n    if(this.start.on(shape))\n      // TODO: Bug in flatten.\n      intersections.push(this.start);\n    if (this.end.on(shape))\n      // TODO: Bug in flatten.\n      intersections.push(this.end);\n    return intersections;\n  }\n\n  // Return whether this segment and the (filled) shape have at least one point\n  // in common.\n  public intersects(shape: Polygon): boolean {\n    return Flatten.Relations.intersect(shape.parent.embed(this).value, shape.value);\n  }\n\n  public touch(shape: Polygon): boolean {\n    return Flatten.Relations.touch(shape.parent.embed(this).value, shape.value);\n  }\n\n  public toString(): string {\n    return `((${this.value.start.x}, ${this.value.start.y}), (${this.value.end.x}, ${this.value.end.y}))`;\n  }\n\n  public get length() {\n    return this.value.length;\n  }\n\n  public equalTo(rhs: Segment, epsilon: number = 0): boolean {\n    return this.start.equalTo(rhs.start, epsilon) && this.end.equalTo(rhs.end, epsilon);\n  }\n\n  public reverse(): Segment {\n    return new Segment(this.parent, this.value.reverse());\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Segment;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport Point from \"./Point\";\nimport Vector from \"./Vector\";\nimport CoordinateSystem from \"./CoordinateSystem\";\n\nexport default class Line {\n  constructor(pt: Point, norm: Vector);\n  constructor(a: Point, b: Point);\n  public constructor(pt: Point, norm: Point | Vector) {\n    this.parent = pt.parent;\n    if (norm instanceof Point)\n      this.value = new Flatten.Line(pt.value, this.parent.embed(norm).value);\n    else\n      this.value = new Flatten.Line(pt.value, this.parent.embed(norm).value);\n  }\n\n  public intersect(other: Line): Point | null {\n    const intersections = other.parent.embed(this).value.intersect(other.value).map((intersection) => new Point(other.parent, intersection));\n    if (intersections.length === 0) return null;\n    if (intersections.length !== 1) throw Error(\"not implemented: Line.intersection()\");\n    return intersections[0];\n  }\n\n  public get pt() { return new Point(this.parent, this.value.pt); }\n  public get norm() { return new Vector(this.parent, this.value.norm); }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Line;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport Point from \"./Point\";\nimport Box from \"./Box\";\nimport Vector from \"./Vector\";\nimport Segment from \"./Segment\";\nimport Line from \"./Line\";\n\nexport type Coordinate = number;\n\nexport default class CoordinateSystem {\n  public constructor(positive: boolean) {\n    this.positive = positive;\n  }\n\n  public static inverse(A: Flatten.Matrix) {\n    const [a00, a01, a02, a10, a11, a12, a20, a21, a22] = [A.a, A.c, A.tx, A.b, A.d, A.ty, 0, 0, 1];\n    const adj = [a11*a22 - a21*a12, a10*a22 - a20*a12, a10*a21 - a20*a11, a01*a22 - a21*a02, a00*a22 - a20*a02, a00*a21 - a20*a01, a01*a12 - a11*a02, a00*a12 - a10*a02, a00*a11 - a10*a01];\n    const det = a00*adj[0] - a01*adj[1] + a02*adj[2];\n    const inv = [adj[0], -adj[3], adj[6], -adj[1], adj[4], -adj[7], adj[2], -adj[5], adj[8]].map(a => a / det);\n    const affine = inv.map(a => a / inv[8]);\n    return new Flatten.Matrix(affine[0], affine[3], affine[1], affine[4], affine[2], affine[5]);\n  }\n\n  public readonly positive: boolean;\n  private embeddedInto: CoordinateSystem | null = null;\n  private embedding: Flatten.Matrix | null = null;\n\n  public embedInto(into: CoordinateSystem, embedding?: Flatten.Matrix) {\n    if (embedding === undefined) {\n      embedding = new Flatten.Matrix();\n      if (this.positive !== into.positive)\n        embedding = new Flatten.Matrix(1, 0, 0, -1);\n    }\n    if (this.embeddedInto !== null && this.embeddedInto !== into)\n        throw Error(\"not implemented: cannot have more than one embedding but this coordinate system is already embedded into another one\")\n    this.embeddedInto = into;\n    this.embedding = embedding;\n  }\n\n  public box(xy0: [Coordinate, Coordinate], xy1: [Coordinate, Coordinate]) {\n    return new Box(this, xy0, xy1);\n  }\n\n  public point(x: Coordinate, y: Coordinate) {\n    return new Point(this, x, y);\n  }\n\n  public embed(box: Box): Box;\n  public embed(point: Point): Point;\n  public embed(vector: Vector): Vector;\n  public embed(segment: Segment): Segment;\n  public embed(line: Line): Line;\n  public embed(value: Box | Point | Vector | Segment | Line) : Box | Point | Vector | Segment | Line {\n    if (value instanceof Box) {\n      let box = value as Box;\n      return new Box(this, this.embed(box.low).xy, this.embed(box.high).xy);\n    } else if (value instanceof Point) {\n      let point = value as Point;\n      while(true) {\n        if (this === point.parent)\n          return point;\n\n        if (point.parent.embeddedInto === null)\n          break;\n\n        point = new Point(point.parent.embeddedInto,\n          point.value.transform(point.parent.embedding!));\n      }\n\n      if (this.embeddedInto === null) {\n        throw Error(`point (${point.value.x}, ${point.value.y}) cannot be embedded from coordinate system ${JSON.stringify(point.parent)} into this coordinate system ${JSON.stringify(this)}; no relation between the coordinate systems could be established.`)\n      }\n\n      point = this.embeddedInto.embed(point);\n\n      return new Point(this, ...CoordinateSystem.inverse(this.embedding!).transform([point.x, point.y]));\n    } else if (value instanceof Vector) {\n      const point = this.embed(new Point(value.parent, value.x, value.y));\n      const origin = this.embed(new Point(value.parent, 0, 0));\n      return new Vector(this, point.x - origin.x, point.y - origin.y);\n    } else if (value instanceof Segment) {\n      return new Segment(this, this.embed(value.start).value, this.embed(value.end).value);\n    } else if (value instanceof Line) {\n      return new Line(this.embed(value.pt), this.embed(value.norm));\n    }\n\n    throw Error(`cannot embed this type of object into coordinate system yet`);\n  }\n}\n\n\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Box from \"./Box\";\nimport Point from \"./Point\";\n\nexport default class Viewport {\n  public constructor(ideal?: CoordinateSystem, width: number = 640, height: number = 640) {\n    this.idealCoordinateSystem = ideal || new CoordinateSystem(true);\n    if (!this.idealCoordinateSystem.positive)\n      throw new Error(\"ideal coordinate system must be positive\");\n    this.viewportCoordinateSystem = new CoordinateSystem(false);\n    this.width = width;\n    this.height = height;\n    this.visible = new Box(this.viewportCoordinateSystem, [0, 0], [width, height]);\n    this.focused = this.visible;\n\n    this.idealCoordinateSystem.embedInto(this.viewportCoordinateSystem);\n  }\n\n  // Resize the viewport while keeping the currently focused box unchanged.\n  public resize(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n\n    this.focus(this.focused);\n  }\n\n  public focus(focused: Box) {\n    this.focused = this.idealCoordinateSystem.embed(focused);\n    this.visible = this.idealCoordinateSystem.embed(this.focused.contain(this.width / this.height));\n    // We now need to embed the \"ideal\" coordinate system into the actual\n    // \"viewport\" coordinate system so that the \"visible\" box fills the (0,\n    // 0), (width, height) box.\n    this.idealCoordinateSystem.embedInto(this.viewportCoordinateSystem, new Flatten.Matrix(\n      this.width / this.visible.width, 0,\n      0, -this.height / this.visible.height,\n      -this.visible.low.x * this.width / this.visible.width,\n      this.visible.high.y * this.height / this.visible.height,\n    ));\n  }\n\n  public zoom(factor: number, center?: Point) {\n    if (center === undefined) {\n      center = this.viewport.center;\n      center = this.focused.parent.embed(center);\n\n      const width = this.focused.width / factor;\n      const height = this.focused.height / factor;\n\n      this.focus(new Box(this.focused.parent,\n        [center.x - width / 2, center.y - height / 2],\n        [center.x + width / 2, center.y + height / 2]));\n    } else {\n      center = this.idealCoordinateSystem.embed(center);\n      const centerBefore = this.viewportCoordinateSystem.embed(center);\n      this.zoom(factor);\n      const centerAfter = this.viewportCoordinateSystem.embed(center);\n      \n      this.focus(this.viewport.translate(centerAfter.x - centerBefore.x, centerAfter.y - centerBefore.y));\n    }\n  }\n\n  public embed(point: Point) : Point;\n  public embed(box: Box) : Box;\n  public embed(value: Point | Box) : Point | Box {\n    return this.viewportCoordinateSystem.embed(value as any);\n  }\n\n  public get viewport() : Box {\n    return this.viewportCoordinateSystem.embed(this.visible);\n  }\n\n  private width: number;\n  private height: number;\n  // The underlying ideal coordinate system that is stable under resizing the\n  // viewport, translating it and such.\n  public readonly idealCoordinateSystem: CoordinateSystem;\n  // Coordinates on screen, i.e., inside the viewport starting at (0, 0) in\n  // the top-left corner.\n  public readonly viewportCoordinateSystem: CoordinateSystem;\n  // The currently focused rectangle, centered in the viewport.\n  private focused: Box;\n  // The currently visible rectangle.\n  private visible: Box;\n};\n","\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport Viewport from \"../geometry/Viewport\";\nimport CoordinateSystem from \"../geometry/CoordinateSystem\";\nimport Point from \"../geometry/Point\";\nimport Box from \"../geometry/Box\";\nimport panzoom from \"pan-zoom/index.js\";\n\n@Component\nexport default class PanZoom extends Vue {\n  @Prop({required: true, type: CoordinateSystem}) coordinateSystem!: CoordinateSystem;\n  @Prop({required: true, type: Box}) focus!: Box;\n\n  private observer = new ResizeObserver(this.resize);\n  private unpanzoom = () => {};\n  protected pan = false;\n\n  private resize() {\n    this.viewport.resize(\n      Math.min((this.$refs.viewport as HTMLElement).clientWidth, window.innerWidth),\n      Math.min((this.$refs.viewport as HTMLElement).clientHeight, window.innerHeight));\n  }\n\n  @Watch(\"focus\", {immediate: true})\n  refocus() {\n    this.viewport.focus(this.focus); \n  }\n\n  mounted() {\n    this.unpanzoom = panzoom(this.$el, this.panzoom);\n    this.observer.observe(this.$el);\n    this.resize();\n  }\n\n  beforeDestroy() {\n    this.unpanzoom();\n    this.observer.unobserve(this.$el);\n  }\n\n  onMouseDown() {\n    this.pan = true;\n  }\n\n  onMouseUp() {\n    this.pan = false;\n  }\n\n  get viewport() {\n    return new Viewport(this.coordinateSystem);\n  }\n\n  private panzoom(e: any) {\n    // We either zoom or pan; mixing this is probably confusing.\n    if (e.dz !== 0) {\n      this.viewport.zoom(Math.exp(-e.dz/96), new Point(this.viewport.viewportCoordinateSystem, e.x, e.y));\n    } else {\n      this.viewport.focus(this.viewport.viewport.translate(-e.dx, -e.dy));\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PanZoom.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PanZoom.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./PanZoom.vue?vue&type=template&id=43f8a8ee&scoped=true&\"\nimport script from \"./PanZoom.vue?vue&type=script&lang=ts&\"\nexport * from \"./PanZoom.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./PanZoom.vue?vue&type=style&index=0&id=43f8a8ee&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"43f8a8ee\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('pan-zoom',{staticClass:\"surface\",attrs:{\"coordinate-system\":_vm.idealCoordinateSystem,\"focus\":_vm.focus},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar viewport = ref.viewport;\nreturn [_c('surface',{attrs:{\"viewport\":viewport,\"surface\":_vm.surface,\"components\":_vm.components,\"inner\":_vm.inner},on:{\"layout\":_vm.onLayoutChanged}})]}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport xor from \"lodash-es/xor\";\n\n// A permutation of T where T is something that can be safely converted to a\n// key in an object, i.e., T should probably be number or string.\nexport default class Permutation<T> {\n  public static fromCycles<T>(cycles: Array<T[]>) : Permutation<T> {\n    const mapping = [] as Array<[T, T]>;\n    for (let cycle of cycles)\n      for (let i = 0; i < cycle.length; i++)\n        mapping.push([cycle[i], cycle[(i + 1) % cycle.length]]);\n    return Permutation.fromMapping(mapping);\n  }\n\n  public static fromMapping<T>(mapping: Array<[T, T]>) : Permutation<T> {\n    return new Permutation<T>(mapping);\n  }\n\n  private constructor(mapping: Array<[T, T]>) {\n    this.mapping = {};\n    this.inverse = {};\n\n    for (let entry of mapping) {\n      if (entry[0] in this.mapping)\n        throw Error(`${entry} specified more than once in mapping domain`);\n      if (entry[1] in this.inverse)\n        throw Error(`${entry} specified more than once in mapping codomain`);\n      this.mapping[String(entry[0])] = entry[1];\n      this.inverse[String(entry[1])] = entry[0];\n    }\n\n    if (xor(Object.keys(this.mapping), Object.keys(this.inverse)).length !== 0)\n      throw Error(`domain {${Object.keys(this.mapping)}} and codomain {${Object.keys(this.inverse)}} of permutation are not identical`);\n\n    this.cycles = [];\n    for (let [a, b] of mapping) {\n      if (this.cycles.find((cycle) => cycle.includes(a)))\n        continue;\n      const cycle = [a, b];\n      while(true) {\n        const x = cycle[cycle.length - 1];\n        if (cycle[0] == x) {\n          cycle.pop();\n          break;\n        }\n        cycle.push(this.mapping[String(x)]);\n      }\n      this.cycles.push(cycle);\n    }\n  }\n\n  public image(x: T) {\n    return this.mapping[String(x)];\n  }\n\n  public preimage(x: T) {\n    return this.inverse[String(x)];\n  }\n\n  public get domain() : T[] {\n    return Object.values(this.mapping);\n  }\n\n  public readonly cycles : Array<T[]>;\n\n  private readonly mapping : { [key: string]: T }; \n  private readonly inverse : { [key: string]: T };\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport xor from \"lodash-es/xor\";\n\nimport HalfEdge from \"./HalfEdge\";\nimport Permutation from \"./Permutation\";\n\nimport Vector, { VectorSchema } from \"../Vector\";\nimport Point from \"../Point\";\nimport CoordinateSystem from '../CoordinateSystem';\n\nexport interface FlatTriangulationSchema {\n  vertices: Array<HalfEdge[]>,\n  vectors: { [key: number]: VectorSchema }\n};\n\nexport default class FlatTriangulation {\n  public static parse(yaml: FlatTriangulationSchema, coordinateSystem: CoordinateSystem) : FlatTriangulation {\n    return new FlatTriangulation(\n      Permutation.fromCycles(yaml.vertices),\n      Object.fromEntries(Object.entries(yaml.vectors).map(([halfEdge, vector]) => [halfEdge, Vector.parse(vector, coordinateSystem)]))\n    );\n  }\n\n  private constructor(vertices: Permutation<HalfEdge>, vectors: {[key: string]: Vector}) {\n    this.vertices = vertices;\n    this.halfEdges = vertices.domain;\n    this.faces = Permutation.fromMapping(this.halfEdges.map((he) => [-this.vertices.image(he), he]));\n\n    this.vectors = vectors;\n\n    if (xor(\n      [...Object.keys(this.vectors), ...Object.keys(this.vectors).map((he) => String(-Number(he)))],\n      this.halfEdges.map((he) => String(he))\n    ).length !== 0)\n      throw Error(`Provided vectors {${Object.keys(this.vectors)}} and present half edges {${this.halfEdges}} do not coincide.`);\n\n    const coordinateSystem = this.vectors['1'].parent;\n\n    for (const face of this.faces.cycles) {\n      const sum = face.reduce((sum, he) => sum.translate(this.vector(he)), new Point(coordinateSystem, 0, 0));\n      if (!sum.equalTo(new Point(coordinateSystem, 0, 0), 1e-6))\n        throw Error(`Face ${face} is not closed. Going around the face gives (${sum.x}, ${sum.y}) but should be zero.`);\n      // TODO: Wiggle the half edges to a place to make the faces closed in double coordinates.\n    }\n  }\n\n  public vector(halfEdge: HalfEdge): Vector {\n    return this.vectors[halfEdge] || this.vectors[-halfEdge].invert();\n  }\n\n  public readonly vertices: Permutation<HalfEdge>;\n  public readonly halfEdges : HalfEdge[];\n  public readonly faces : Permutation<HalfEdge>;\n  private readonly vectors : {[key: string]: Vector };\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport HalfEdge, { HalfEdgeSchema } from \"./HalfEdge\";\nimport Vector, { VectorSchema } from \"../Vector\";\nimport CoordinateSystem from '../CoordinateSystem';\n\nexport interface SaddleConnectionSchema {\n  source: HalfEdgeSchema,\n  target: HalfEdgeSchema,\n  vector: VectorSchema,\n  crossings: {\n    halfEdge: number,\n    at: number,\n  }[]\n};\n\nexport default class SaddleConnection {\n  public static parse(yaml: SaddleConnectionSchema, coordinateSystem: CoordinateSystem): SaddleConnection {\n    return new SaddleConnection(yaml.source, yaml.target, Vector.parse(yaml.vector, coordinateSystem), yaml.crossings);\n  }\n\n  private constructor(source: HalfEdge, target: HalfEdge, vector: Vector, crossings: {halfEdge: HalfEdge, at: number}[]) {\n    this.source = source;\n    this.target = target;\n    this.vector = vector;\n    this.crossings = Object.freeze(crossings);\n  }\n\n  public readonly source: HalfEdge;\n  public readonly target: HalfEdge;\n  public readonly vector: Vector;\n  // The sequence of half edges crossed with approximate\n  // relative point of crossing in [0, 1].\n  public readonly crossings: readonly {halfEdge: HalfEdge, at: number}[];\n}\n\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport SaddleConnection, { SaddleConnectionSchema } from \"./SaddleConnection\";\nimport CoordinateSystem from '../CoordinateSystem';\nimport HalfEdge from \"./HalfEdge\";\n\nexport interface Touch {\n  halfEdge: HalfEdge;\n  index: number;\n}\n\nexport interface FlowConnectionSchema extends SaddleConnectionSchema {\n  vertical: boolean;\n  boundary: boolean;\n  touches: Touch[];\n}\n\nexport default class FlowConnection {\n  public static parse(yaml: FlowConnectionSchema, coordinateSystem: CoordinateSystem): FlowConnection {\n    return new FlowConnection(SaddleConnection.parse(yaml, coordinateSystem), yaml.vertical, yaml.boundary, yaml.touches);\n  }\n\n  private constructor(connection: SaddleConnection, vertical: boolean, boundary: boolean, touches: Touch[]) {\n    this.connection = connection;\n    this.vertical = vertical;\n    this.boundary = boundary;\n    this.touches = Object.freeze(touches);\n  }\n\n  public readonly connection: SaddleConnection;\n  public readonly vertical: boolean;\n  public readonly boundary: boolean;\n\n  // The sequence of half edges crossed/touched (most half edges show up in\n  // pairs) and the order of this crossing/touching in comparison to all the\n  // others of this component on that half edge. Typically, starts with\n  // [source half edge, 0], then the first [half edge crossed, 0] if this is\n  // the right-most crossing of that half edge, then [-half edge crossed,\n  // 0], ... until the [target half edge, 0].\n  public readonly touches: readonly Touch[];\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport CoordinateSystem from '../CoordinateSystem';\nimport FlowConnection, { FlowConnectionSchema } from \"./FlowConnection\";\nimport HalfEdge, { HalfEdgeSchema } from './HalfEdge';\n\nexport default class FlowComponent {\n  public static parse(yaml: {\n    cylinder: boolean,\n    perimeter: FlowConnectionSchema[],\n    inside: HalfEdgeSchema[],\n  }, coordinateSystem: CoordinateSystem) : FlowComponent {\n    return new FlowComponent(yaml.cylinder, yaml.perimeter.map(connection => FlowConnection.parse(connection, coordinateSystem)), yaml.inside);\n  }\n\n  private constructor(cylinder: boolean, perimeter: FlowConnection[], inside: HalfEdge[]) {\n    this.cylinder = cylinder;\n    this.perimeter = perimeter;\n    this.inside = inside;\n  }\n\n  public readonly cylinder: boolean;\n  public readonly perimeter: FlowConnection[];\n  public readonly inside: HalfEdge[];\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{attrs:{\"width\":_vm.viewport.width,\"height\":_vm.viewport.height}},[(_vm.layout != null)?_c('g',_vm._l((_vm.components),function(component,i){return _c('flow-component-component',{key:i,attrs:{\"color\":_vm.palette.color(i),\"component\":component,\"layout\":_vm.layout,\"surface\":_vm.surface}})}),1):_vm._e(),_c('flat-triangulation-component',{attrs:{\"surface\":_vm.surface,\"forced\":_vm.forced},on:{\"layout\":_vm.onLayoutChanged}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.layout != null)?_c('g',{staticClass:\"FlatTriangulation\"},[_c('g',_vm._l((_vm.faces),function(face,i){return _c('face',{key:i,attrs:{\"vertices\":face}})}),1),_c('g',_vm._l((_vm.halfEdges),function(halfEdge){return _c('half-edge-component',{key:halfEdge,class:{ inner: _vm.layout.layout(halfEdge).inner },attrs:{\"segment\":_vm.layout.layout(halfEdge).segment,\"half-edge\":halfEdge}})}),1)]):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ngon',{attrs:{\"vertices\":_vm.vertices}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('polygon',{attrs:{\"points\":_vm.points}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\nimport { Component, Inject, Prop, Vue } from \"vue-property-decorator\";\n\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class Ngon extends Vue {\n  @Prop({ required: true, type: Array }) vertices!: Point[];\n\n  get points() {\n    return this.vertices.map((xy) => {\n      xy = this.svg(xy); \n      return `${xy.x},${xy.y}`;\n    }).join(\",\");\n  }\n\n  @Inject()\n  svg!: (xy: Point) => Point;\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Ngon.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Ngon.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Ngon.vue?vue&type=template&id=30284d09&\"\nimport script from \"./Ngon.vue?vue&type=script&lang=ts&\"\nexport * from \"./Ngon.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\n\nimport Point from \"@/geometry/Point\";\nimport Ngon from \"./svg/Ngon.vue\";\n\n@Component({\n  components: { Ngon }\n})\nexport default class Face extends Vue {\n  @Prop({ required: true, type: Array }) vertices!: Point[];\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Face.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Face.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Face.vue?vue&type=template&id=efce637c&scoped=true&\"\nimport script from \"./Face.vue?vue&type=script&lang=ts&\"\nexport * from \"./Face.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Face.vue?vue&type=style&index=0&id=efce637c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"efce637c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',[(_vm.indicator)?_c('arrow',{staticClass:\"indicator\",attrs:{\"segment\":_vm.indicator}}):_vm._e(),(_vm.halfEdgeConfiguration(_vm.halfEdge).state.labeled || true)?_c('segment-label',{attrs:{\"at\":_vm.segment}},[_vm._v(_vm._s(_vm.halfEdge))]):_vm._e(),_c('extended-click-area',{on:{\"click\":_vm.onClick,\"mouseenter\":_vm.onMouseEnter,\"mouseleave\":_vm.onMouseLeave,\"mousemove\":_vm.onMouseMove}},[_c('segment-component',{class:{ selected: _vm.selected, glued: _vm.glued },attrs:{\"segment\":_vm.segment}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('line',{attrs:{\"x1\":_vm.coords[0],\"y1\":_vm.coords[1],\"x2\":_vm.coords[2],\"y2\":_vm.coords[3]}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\nimport { Component, Inject, Prop, Vue } from \"vue-property-decorator\";\n\nimport Segmnt from \"@/geometry/Segment\";\n\n@Component\nexport default class Segment extends Vue {\n  @Prop({ required: true, type: Object }) segment!: Segmnt;\n\n  // For performance reasons we compute all coordinates at once since this\n  // gets called a lot.\n  get coords() {\n    const embedded = this.svg(this.segment);\n    return [embedded.start.x, embedded.start.y, embedded.end.x, embedded.end.y];\n  }\n\n  @Inject()\n  svg!: (s: Segmnt) => Segmnt;\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Segment.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Segment.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Segment.vue?vue&type=template&id=6290d963&\"\nimport script from \"./Segment.vue?vue&type=script&lang=ts&\"\nexport * from \"./Segment.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{attrs:{\"transform\":_vm.transformation}},[_c('text',[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nimport { Vue, Component, Inject, Prop } from \"vue-property-decorator\";\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class HalfEdgeLabel extends Vue {\n\t@Prop({required: true, type: Object}) at!: Segment;\n\n\tget position() {\n\t\tconst midpoint = this.at.middle;\n\t\tlet normal = this.svg(this.at.tangentInStart.rotate90CCW()).normalize();\n\t\treturn this.svg(midpoint).translate(normal.multiply(12));\n\t}\n\n\tget transformation() {\n\t\treturn `translate(${this.position.x} ${this.position.y}) translate(6 4)`;\n\t}\n\n  @Inject()\n  svg!: ((xy: Point) => Point) & ((xy: Vector) => Vector);\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SegmentLabel.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SegmentLabel.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SegmentLabel.vue?vue&type=template&id=03911908&scoped=true&\"\nimport script from \"./SegmentLabel.vue?vue&type=script&lang=ts&\"\nexport * from \"./SegmentLabel.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SegmentLabel.vue?vue&type=style&index=0&id=03911908&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"03911908\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"arrow\"},[_c('line',{attrs:{\"x1\":_vm.x1,\"y1\":_vm.y1,\"x2\":_vm.x2,\"y2\":_vm.y2}}),_c('path',{attrs:{\"d\":\"M 0 -3 L 12 0 L 0 3 z\",\"transform\":_vm.atEnd,\"stroke-width\":\"0\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\nimport { Prop, Vue, Component, Inject } from \"vue-property-decorator\";\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class SVGArrow extends Vue {\n\t@Prop({required: true, type: Object}) segment!: Segment;\n\n  get x1() {\n    return this.svg(this.segment.start).x;\n  }\n\n  get y1() {\n    return this.svg(this.segment.start).y;\n  }\n\n  get endWithoutHead() {\n    return this.svg(this.segment.end).translate(this.svg(this.segment.tangentInEnd).normalize().multiply(12));\n  }\n\n  get x2() {\n    return this.svg(this.endWithoutHead).x;\n  }\n\n  get y2() {\n    return this.svg(this.endWithoutHead).y;\n  }\n\n\tget atEnd() {\n    return `translate(${this.x2} ${this.y2}) rotate(${-this.segment.tangentInStart.angleTo(new Vector(this.segment.parent, 1, 0))*360 / (2*Math.PI)} 0 0)`;\n\t}\n\n  @Inject()\n  svg!: ((xy: Point) => Point) & ((xy: Vector) => Vector);\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Arrow.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Arrow.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Arrow.vue?vue&type=template&id=4e3f5919&scoped=true&\"\nimport script from \"./Arrow.vue?vue&type=script&lang=ts&\"\nexport * from \"./Arrow.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Arrow.vue?vue&type=style&index=0&id=4e3f5919&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4e3f5919\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"extended-click-area\",on:{\"mousedown\":function($event){$event.preventDefault();$event.stopPropagation();return (function (e) { return _vm.$emit('mousedown', e); }).apply(null, arguments)},\"click\":function (e) { return _vm.$emit('click', e); },\"mouseenter\":function (e) { return _vm.$emit('mouseenter', e); },\"mouseleave\":function (e) { return _vm.$emit('mouseleave', e); },\"mousemove\":function (e) { return _vm.$emit('mousemove', e); }}},[_vm._t(\"default\"),_c('g',{staticClass:\"extension\"},[_vm._t(\"default\")],2)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./ExtendedClickArea.vue?vue&type=template&id=7941a33e&scoped=true&\"\nvar script = {}\nimport style0 from \"./ExtendedClickArea.vue?vue&type=style&index=0&id=7941a33e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7941a33e\",\n  null\n  \n)\n\nexport default component.exports","import Segment from \"@/geometry/Segment\";\n\nexport interface IHalfEdgeConfiguration {\n  interactions: {\n    click: (ev: MouseEvent, segment: Segment) => void,\n    enter: (ev: MouseEvent, segment: Segment) => void,\n    leave: (ev: MouseEvent, segment: Segment) => void,\n    hover: (ev: MouseEvent, segment: Segment) => void,\n  },\n  state: {\n    selected: boolean,\n    glued: boolean,\n    labeled: boolean,\n    indicator: number | null,\n  },\n};\n\nexport const DefaultHalfEdgeConfiguration: IHalfEdgeConfiguration = {\n  interactions: {\n    click: () => {},\n    enter: () => {},\n    leave: () => {},\n    hover: () => {},\n  },\n  state: {\n    selected: false,\n    glued: false,\n    labeled: false,\n    indicator: null,\n  }\n};\n","\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Inject, Vue } from \"vue-property-decorator\";\n\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport SegmentComponent from \"./svg/Segment.vue\";\nimport HalfEdge from \"@/geometry/triangulation/HalfEdge\";\nimport SegmentLabel from \"./svg/SegmentLabel.vue\";\nimport Arrow from \"./svg/Arrow.vue\";\n\nimport ExtendedClickArea from \"./svg/ExtendedClickArea.vue\";\nimport { IHalfEdgeConfiguration, DefaultHalfEdgeConfiguration } from \"./HalfEdgeConfiguration\";\n\n@Component({\n  components: { Arrow, ExtendedClickArea, SegmentComponent, SegmentLabel },\n})\nexport default class HalfEdgeComponent extends Vue {\n  @Prop({required: true, type: Number}) halfEdge!: HalfEdge;\n  // TODO: We should compute the segment here from the layout object instead.\n  @Prop({required: true, type: Object}) segment!: Segment;\n\n  onClick(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.click(ev, this.segment);\n  }\n\n  onMouseEnter(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.enter(ev, this.segment);\n  }\n\n  onMouseLeave(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.leave(ev, this.segment);\n  }\n\n  onMouseMove(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.hover(ev, this.segment);\n  }\n\n  get selected() {\n    return this.halfEdgeConfiguration(this.halfEdge).state.selected;\n  }\n\n  get glued() {\n    return this.halfEdgeConfiguration(this.halfEdge).state.glued;\n  }\n\n\tget indicator() {\n    let indicator = this.halfEdgeConfiguration(this.halfEdge).state.indicator;\n    if (indicator) {\n\t\t  const end = this.segment.at(indicator);\n\t\t  const start = end.translate(this.svg(this.segment.tangentInStart.rotate90CCW()).normalize().multiply(10));\n      return new Segment(start, end);\n    }\n\t}\n\n  @Inject({ default: () => DefaultHalfEdgeConfiguration })\n  halfEdgeConfiguration!: (halfEdge: HalfEdge) => IHalfEdgeConfiguration;\n\n  @Inject()\n  svg!: (xy: Vector) => Vector;\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HalfEdge.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HalfEdge.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./HalfEdge.vue?vue&type=template&id=d533d4e2&scoped=true&\"\nimport script from \"./HalfEdge.vue?vue&type=script&lang=ts&\"\nexport * from \"./HalfEdge.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./HalfEdge.vue?vue&type=style&index=0&id=d533d4e2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d533d4e2\",\n  null\n  \n)\n\nexport default component.exports","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Point from \"./Point\";\n\nexport default class Polygon {\n  public constructor(parent: CoordinateSystem, value: Flatten.Polygon) {\n    this.parent = parent;\n    this.value = value;\n  }\n\n  public get convexHull(): Polygon {\n    return Polygon.convexHull(this.vertices);\n  }\n\n  // Compute the convex hull of the points (using the slow Jarvis march\n  // algorithm.)\n  public static convexHull(points: Point[]): Polygon {\n    assert(points.length !== 0);\n\n    const coordinateSystem = points[0].parent;\n\n    const vertices = points.map((p) => coordinateSystem.embed(p).value);\n\n    assert(vertices.some((p) => !p.equalTo(vertices[0])));\n\n    const hull = [vertices.reduce((p, q) => {\n      if (p.x < q.x)\n        return p;\n      if (p.x > q.x)\n        return q\n      if (p.y < q.y)\n        return p;\n      return q;\n    })];\n\n    do {\n      const last = hull[hull.length - 1];\n      let next = vertices[0].equalTo(last) ? vertices[1] : vertices[0];\n      for (let p of vertices) {\n        if (p.leftTo(new Flatten.Line(last, next)))\n          next = p;\n      }\n      hull.push(next);\n      // TODO: This is numerically too unstable (and hangs sometimes.)\n      if (hull.length > vertices.length + 1) {\n        console.error(\"Convex Hull incorrect\");\n        break;\n      }\n    } while(!hull[hull.length - 1].equalTo(hull[0]));\n\n    hull.pop();\n\n    const polygon = new Flatten.Polygon();\n    polygon.addFace(hull);\n    return new Polygon(coordinateSystem, polygon);\n  }\n\n  // Return a bounding rectangle of minimal area. (The rectangle might not be\n  // axis-aligned.)\n  public get boundingRect(): Polygon {\n    const hull = this.convexHull;\n\n    let minArea = 1./0.;\n    let minAreaRect = null;\n\n    // Algorithm: The minimal bounding rect of a convex polygon must be aligned to one of its sides.\n    for (const edge of hull.value.edges) {\n      // Rotate such that the edge is horizontal.\n      const segment: Flatten.Segment = edge.shape;\n      const direction = segment.tangentInStart();\n      const theta = new Flatten.Vector(1, 0).angleTo(direction);\n      const rotation = new Flatten.Matrix(\n        Math.cos(-theta), -Math.sin(-theta),\n        Math.sin(-theta), Math.cos(-theta),\n      );\n      const aligned = hull.value.transform(rotation);\n\n      // Compute the area of this bounding box.\n      const area = aligned.area();\n\n      if (area < minArea) {\n        minArea = area;\n\n        // Rotate the box back.\n        minAreaRect = new Polygon(this.parent, new Flatten.Polygon(aligned.box.toPoints()).transform(CoordinateSystem.inverse(rotation)));\n      }\n    }\n\n    return minAreaRect!;\n  }\n\n  public get vertices(): Point[] {\n    return this.value.vertices.map((vertex) => new Point(this.parent, vertex));\n  }\n\n  public area(): number {\n    return this.value.area();\n  }\n  \n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Polygon;\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nexport default class Progress {\n  constructor(name: string = \"\", steps: number = 0) {\n    this.name = name;\n    this.steps = steps;\n  }\n\n  public task(name: string, steps: number) {\n    this.steps += steps;\n    this.name = name;\n  }\n\n  public progress() {\n    this.step++;\n  }\n\n  public get stats(): { name: string, step?: number, steps?: number } {\n    return {\n      name: this.name,\n      step: (this.steps != null && this.step < this.steps) ? this.step : undefined,\n      steps: this.steps,\n    }\n  }\n\n  private step = 0;\n  private steps = 0;\n  private name: string;\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nexport class OperationAborted extends Error {}\n\nexport default class CancellationToken {\n  public cancellationRequested() {\n    return new Promise<boolean>((resolve, reject) => {\n      if (this.aborted) reject(new OperationAborted());\n      setTimeout(() => resolve(this.cancelled), 0);\n    });\n  }\n\n  public cancel() {\n    this.cancelled = true;\n  }\n\n  public abort() {\n    this.aborted = true;\n  }\n\n  private cancelled = false;\n  private aborted = false;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020-2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\nimport minBy from \"lodash-es/minBy\";\nimport Flatten from \"@flatten-js/core\";\n\nimport Vector from \"../Vector\";\nimport HalfEdge from \"../triangulation/HalfEdge\";\nimport HalfEdgeLayout from './HalfEdgeLayout';\nimport Point from '../Point';\nimport Segment from '../Segment';\nimport Polygon from '../Polygon';\nimport FlatTriangulation from '../triangulation/FlatTriangulation';\nimport Progress from \"@/Progress\";\nimport CancellationToken from \"@/CancellationToken\";\n\nexport default class CellLayout {\n  // Create a layout by walking the boundary of the cell in counter-clockwise\n  // order on the inside and summing up the associated vectors to determine the\n  // segment corresponding to each half edge.\n  public constructor(surface: FlatTriangulation, cell: HalfEdge[], origin: Point);\n  public constructor(surface: FlatTriangulation, layout: Record<HalfEdge, HalfEdgeLayout>);\n  public constructor(surface: FlatTriangulation, cell: HalfEdge[] | Record<HalfEdge, HalfEdgeLayout>, origin?: Point) {\n    this.surface = surface;\n\n    if (cell instanceof Array) {\n      assert(origin);\n      let end = origin;\n      this.layout = Object.fromEntries(cell.map((he: HalfEdge) => {\n        const start = end;\n        end = end.translate(surface.vector(he));\n        return [he, {\n          segment: new Segment(origin.parent, start.value, end.value),\n          inner: false,\n        }];\n      }));\n    } else {\n      this.layout = cell;\n    }\n\n    this.boundingRectArea = this.polygon.boundingRect.area();\n  }\n\n  // Translate this cell so that half edge coincides with segment.\n  translate(delta: Vector): void;\n  translate(halfEdge: HalfEdge, segment: Segment): void;\n  translate(halfEdge: HalfEdge | Vector, segment?: Segment) {\n    if (halfEdge instanceof Vector) {\n      const delta = halfEdge as Vector;\n      this.halfEdges.map((halfEdge) => {\n        this.layout[halfEdge].segment = this.layout[halfEdge].segment.translate(delta);\n      });\n    } else {\n      const before = this.layout[halfEdge].segment;\n      const delta = new Vector(before.parent, before.start, segment!.start);\n      \n      // https://github.com/alexbol99/flatten-js/pull/75\n      assert(before.translate(delta).equalTo(segment!, (Flatten.Utils as any).getTolerance()));\n\n      this.translate(delta);\n    }\n  }\n\n  // Return the HalfEdges that glue correctly between this layout and `other`\n  // currently or return an empty array if something overlaps or touches\n  // incorrectly.\n  glues(other: CellLayout): HalfEdge[] {\n    const otherPolygon = other.polygon;\n\n    const glued = [];\n\n    for (const halfEdge of this.halfEdges) {\n      if (this.layout[halfEdge].segment.intersects(otherPolygon)) {\n        // This half edge and the other cell have at least a point in common.\n\n        if (this.layout[halfEdge].segment.middle.on(otherPolygon)) {\n          if (other.halfEdges.includes(-halfEdge)) {\n            // If this half edge has its counterpart in the other cell, then we\n            // want them to be glued correctly.\n            if (this.layout[halfEdge].segment.equalTo(other.layout[-halfEdge].segment.reverse(), Flatten.Utils.getTolerance())) {\n              glued.push(halfEdge);\n              continue;\n            } else {\n              return [];\n            }\n          } else {\n            return [];\n          }\n        }\n\n        const intersections = this.layout[halfEdge].segment.intersect(otherPolygon);\n        if (intersections.length === 0) {\n          // This half edge is completely inside the other cell.\n          return [];\n        }\n\n        // Check whether the intersection points are consistently glued.\n        for (const intersection of intersections) {\n          const touchConsistent = (source: HalfEdge) => {\n              for (const vertex of this.surface.vertices.cycles) {\n                if (!vertex.includes(source)) continue;\n\n                for (const touch of vertex) {\n                  if (!other.halfEdges.includes(touch)) continue;\n\n                  if (intersection.equalTo(other.layout[touch].segment.start, Flatten.Utils.getTolerance()))\n                    return true;\n              }\n            };\n            // Not touching at a vertex or not touching at this vertex.\n            return false;\n          }\n\n          if (intersection.equalTo(this.layout[halfEdge].segment.start, Flatten.Utils.getTolerance())) {\n            // The cells touch at the starting point of this half edge. We\n            // check whether what it touches is the same vertex in the other\n            // cell.\n            if (!touchConsistent(halfEdge)) {\n              return [];\n            }\n          }\n          else if (intersection.equalTo(this.layout[halfEdge].segment.end, Flatten.Utils.getTolerance())) {\n            // The cells touch at the end point of this half edge. We\n            // check whether what it touches is the same vertex in the other\n            // cell.\n            if (!touchConsistent(-halfEdge)) {\n              return [];\n            }\n          } else {\n            // The cells touch not at the end point of a half edge.\n            return [];\n          }\n        }\n      }\n    }\n\n    assert(glued.length !== 0);\n    return glued;\n  }\n\n  touches(other: CellLayout): HalfEdge[] {\n    const otherPolygon = other.polygon;\n    return this.halfEdges.filter((halfEdge) => {\n      return !this.layout[halfEdge].inner && this.layout[halfEdge].segment.intersects(otherPolygon) || this.layout[halfEdge].segment.touch(otherPolygon);\n    });\n  }\n\n  // Return the boundary polygon of this cell (might not be connected.)\n  get polygon(): Polygon {\n    const polygon = new Flatten.Polygon();\n    this.boundaries.map((boundary) => {\n      polygon.addFace(boundary.map((side) => this.parent.embed(this.layout[side].segment).value));\n    });\n    return new Polygon(this.parent, polygon);\n  }\n\n  // Return the boundary polygons of this cell.\n  get boundaries() : HalfEdge[][] {\n    let pending = new Set(this.halfEdges.filter((he) => !this.layout[he].inner));\n    const boundaries = [] as HalfEdge[][];\n\n    while(pending.size) {\n      let start!: number;\n      for (start of pending) break;\n\n      const boundary = [] as HalfEdge[];\n      let next = start;\n      do {\n        next = -next;\n\n        do {\n          next = this.surface.vertices.preimage(next);\n        } while(this.layout[next].inner);\n\n        boundary.push(next);\n        pending.delete(next);\n      } while (next !== start);\n\n      boundaries.push(boundary);\n    }\n\n    return boundaries;\n  }\n\n  private get parent() {\n    return this.layout[this.halfEdges[0]].segment.parent;\n  }\n\n  public toString(): string {\n    return \"{\" + this.halfEdges.map((he) => `${he}: ${this.layout[he].segment}`).join(\", \") + \"}\";\n  }\n\n  get halfEdges(): HalfEdge[] {\n    return Object.keys(this.layout).map((halfEdge) => Number(halfEdge));\n  }\n\n  // Merge two of the cells by identifying two opposite half edges.\n  static async merge(cells: CellLayout[], force: (he: HalfEdge) => boolean | null, cache: Record<HalfEdge, number | null> = {}, cancellation = new CancellationToken(), _progress = new Progress()): Promise<CellLayout[]> {\n    if (cells.length === 1)\n      return cells;\n\n    let scores = [] as {\n      glue: HalfEdge;\n      cell: CellLayout;\n      other: CellLayout;\n      score: number;\n    }[];\n\n    for (const cell of cells) {\n      if (await cancellation.cancellationRequested())\n        break;\n\n      for (const glue of cell.halfEdges) {\n        if (glue < 0) continue;\n        const other = cells.find((other) => other.halfEdges.includes(-glue))!;\n        if (cell === other) continue;\n\n        if (cache[glue] === undefined) {\n          cache[glue] = CellLayout.score(glue, cell, other, cells, force);\n        }\n\n        const score = cache[glue];\n\n        if (score === null)\n          continue;\n\n        scores.push({ glue, cell, other, score });\n      }\n    }\n\n    if (scores.length === 0)\n      return cells;\n\n    const best = minBy(scores, 'score')!;\n\n    const cell = CellLayout.glue(best.glue, best.cell, best.other);\n\n    for (let halfEdge of cell.halfEdges) {\n      delete cache[halfEdge];\n      delete cache[-halfEdge];\n    }\n\n    return [cell, ...cells.filter((c) => c !== best.cell && c !== best.other)];\n  }\n\n  // Return the score (lower is better) to the visual glueing of glue of\n  // parent and -glue of other; or return null if the two cannot be glued\n  // without overlaps in the resulting picture.\n  private static score(glue: HalfEdge, parent: CellLayout, other: CellLayout, cells: CellLayout[], force?: (he: HalfEdge) => boolean | null): number | null {\n    assert(parent.halfEdges.includes(glue) && other.halfEdges.includes(-glue));\n    assert(!parent.layout[glue].inner && !other.layout[-glue].inner);\n\n    other.translate(-glue, parent.layout[glue].segment.reverse());\n    const glues = parent.glues(other);\n    if (glues.length === 0) {\n      return null;\n    }\n\n\n    // Prefer edges that have been explicitly selected.\n    if (force) {\n      if (force(glue) === true)\n        return -force.length;\n      if (force(glue) === false)\n        return null;\n    }\n\n    // Prefer edges that keep Delaunay cells intact.\n    {\n      const ca = parent.surface.vector(glue);\n      const cb = parent.surface.vector(parent.surface.vertices.image(glue));\n      const dc = parent.surface.vector(-parent.surface.faces.image(-glue));\n\n      const a = dc.add(ca);\n      const b = dc.add(cb);\n      const c = dc;\n\n      const det = (x00: number, x01: number, x02: number, x10: number, x11: number, x12: number, x20: number, x21: number, x22: number) => x00 * (x11 * x22 - x12 * x21) - x10 * (x01 * x22 - x21 * x02) + x20 * (x01 * x12 - x11 * x02);\n\n      const delaunay = det(a.x, a.y, a.x * a.x + a.y * a.y, b.x, b.y, b.x * b.x + b.y * b.y, c.x, c.y, c.x * c.x + c.y * c.y);\n\n      if (Math.abs(delaunay) < (Flatten.Utils as any).getTolerance())\n        return 0;\n    }\n\n    // Prefer edges that minimize the area of a bounding rectangle of the glued area.\n    {\n      const ungluedArea = cells.map((cell) => cell.boundingRectArea).reduce((a, b) => a+b);\n\n      const gluedArea = cells.filter((cell) => cell !== parent && cell !== other).map((cell) => cell.boundingRectArea).reduce((a, b) => a + b, 0)\n        + CellLayout.glue(glues, parent, other).boundingRectArea;\n\n      return gluedArea / ungluedArea;\n    }\n  }\n\n  // Glue parent and other along glue and return the resulting cell.\n  private static glue(glues: HalfEdge[], parent: CellLayout, other: CellLayout): CellLayout;\n  private static glue(glue: HalfEdge, parent: CellLayout, other: CellLayout): CellLayout;\n  private static glue(glues: HalfEdge | HalfEdge[], parent: CellLayout, other: CellLayout): CellLayout {\n    if (!Array.isArray(glues)) {\n      other.translate(-glues, parent.layout[glues].segment.reverse());\n      return CellLayout.glue(parent.glues(other), parent, other);\n    } else {\n      assert(glues.length !== 0)\n      other.translate(-glues[0], parent.layout[glues[0]].segment.reverse());\n\n      // https://github.com/alexbol99/flatten-js/pull/75\n      for (const glue of glues)\n        assert(parent.layout[glue].segment.equalTo(other.layout[-glue].segment.reverse(), (Flatten.Utils as any).getTolerance()));\n\n      assert(Object.keys(parent.layout).every((he) => !other.layout.hasOwnProperty(he)));\n      assert(Object.keys(other.layout).every((he) => !parent.layout.hasOwnProperty(he)));\n\n      const glued = {...parent.layout, ...other.layout};\n      for (const glue of glues) {\n        glued[glue] = { segment: parent.layout[glue].segment, inner: true }\n        glued[-glue] = { segment: other.layout[-glue].segment, inner: true }\n      }\n\n      return new CellLayout(parent.surface, glued);\n    }\n  }\n\n  private static packable(cells: CellLayout[], packed: CellLayout[]) {\n    for (let i = 0; i < cells.length; i++) {\n      const cell = cells[i];\n\n      // Find a half edge that connects to something that has already been packed\n      for (let halfEdge of cell.halfEdges) {\n        for (let cell_ of packed) {\n          for (let halfEdge_ of cell_.halfEdges) {\n            if (halfEdge === -halfEdge_) {\n              cells.splice(i, 1);\n              return {\n                cell,\n                cell_,\n                halfEdge,\n                halfEdge_,\n              };\n            }\n          }\n        }\n      }\n    }\n\n    assert(false, `Could not find any cells packable with ${packed} among ${cells}`);\n  }\n\n  static pack(cells: CellLayout[], progress: Progress): CellLayout[] {\n    if (cells.length <= 1) return cells;\n\n    const packed = [cells.pop()] as CellLayout[];\n\n    progress.task(\"Packing Cells\", cells.length);\n\n    while (cells.length) {\n      progress.progress();\n\n      const {cell, cell_, halfEdge, halfEdge_} = CellLayout.packable(cells, packed);\n\n      const segment = cell.layout[halfEdge].segment;\n      const segment_ = cell_.layout[halfEdge_].segment.reverse();\n\n      cell.translate(halfEdge, segment_);\n\n      // We determine a distance that two edges have to be separated from each\n      // other to make it clear that they are not glued.\n      // The idea is that the entire `packed` presumably fills a notebook cell,\n      // probably 800 x 600 pixels. A gap of 5 pixels can easily be recognized\n      // as a gap.\n      const screen = packed.map((cell) => cell.polygon.value.box).reduce((box, cell) => box.merge(cell), new Flatten.Box());\n      const step = Math.max((screen.xmax - screen.xmin) / 800, (screen.ymax - screen.ymin) / 600) * 5;\n      const delta = segment.tangentInStart.rotate90CCW().multiply(step);\n      \n      do {\n        cell.translate(delta);\n      } while(packed.some((other) => cell.touches(other).length))\n\n      packed.push(cell);\n    }\n\n    return packed;\n  }\n\n  protected readonly surface: FlatTriangulation;\n  protected readonly boundingRectArea: number;\n  public readonly layout: Record<HalfEdge, HalfEdgeLayout>;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Point from '../Point';\nimport FlatTriangulation from \"../triangulation/FlatTriangulation\";\nimport HalfEdge from '../triangulation/HalfEdge';\nimport CellLayout from './CellLayout';\nimport HalfEdgeLayout from './HalfEdgeLayout';\nimport Box from '../Box';\nimport CancellationToken from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\n\nexport default class FlatTriangulationLayout {\n  private constructor(surface: FlatTriangulation, force?: (he: HalfEdge) => boolean | null) {\n    this.surface = surface;\n    this.force = force || (() => null);\n  }\n\n  public static async layout(surface: FlatTriangulation, force?: (he: HalfEdge) => boolean | null, cancellation = new CancellationToken(), progress = new Progress()) {\n    const layout = new FlatTriangulationLayout(surface, force);\n    await layout.recompute(cancellation, progress);\n    return layout;\n  }\n\n  private async recompute(cancellation: CancellationToken, progress: Progress) {\n    // Layout Algorithm:\n    // (1) Start from elementary cells, i.e., triangular faces.\n    // (2) Greedily glue any two cells as long as no overlap is produced,\n    //     prefering metrics such as the gluing that minimizes the area of a\n    //     bounding rectangle.\n    // (3) Pack the resulting cells into a box by randomly aligning\n    //     corresponding half edges to create a single polygon (with self intersections)\n    //     and move the pieces away from each other orthogonally until no overlaps\n    //     happen anymore.\n\n    // (1) Elementary Cells\n    if (this.surface.halfEdges.length === 0) {\n      this.halfEdges = {};\n      return;\n    }\n\n    const origin = new Point(this.surface.vector(this.surface.halfEdges[0]).parent, 0, 0);\n    let cells = this.surface.faces.cycles.map((face) => new CellLayout(this.surface, face, origin));\n\n    // (2) Glue Cells\n    progress.task(\"Gluing Cells\", cells.length - 1);\n    const cache = {};\n    for (const _ of Array(cells.length - 1)) {\n      progress.progress();\n      cells = await CellLayout.merge(cells, this.force, cache, cancellation, progress);\n    }\n\n    // (3) Pack Cells\n    cells = CellLayout.pack(cells, progress);\n\n    this.halfEdges = Object.assign({}, ...cells.map((cell) => cell.layout));\n\n    // Complain about unsatisfied forcings.\n    for (const he of this.surface.halfEdges) {\n      if (this.force(he) === true && !this.layout(he).inner)\n        console.log(`Half edge ${he} should be visually glued in the layout but this was not possible.`);\n      if (this.force(he) === false && this.layout(he).inner)\n        console.error(`Half edge ${he} should not be visually glued in the layout but it is.`);\n    }\n\n  }\n\n  public layout(halfEdge: HalfEdge): HalfEdgeLayout {\n    return this.halfEdges[halfEdge];\n  }\n\n  public get bbox(): Box {\n    return Box.bbox(Object.values(this.halfEdges).map((layout) => layout.segment));\n  }\n\n  private readonly surface: FlatTriangulation;\n  private force: (he: HalfEdge) => boolean | null;\n  private halfEdges!: Record<HalfEdge, HalfEdgeLayout>;\n}\n","\n\n\n\n\n\n\n\n\n\n\nimport { Vue, Component, Inject, Prop, Watch } from \"vue-property-decorator\";\nimport Triangulation from \"../geometry/triangulation/FlatTriangulation\";\nimport Face from \"./Face.vue\";\nimport Point from \"../geometry/Point\";\nimport HalfEdgeComponent from \"./HalfEdge.vue\";\nimport FlatTriangulationLayout from \"../geometry/layout/FlatTriangulationLayout\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\nimport CancellationToken, { OperationAborted } from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\n\n@Component({\n  components: {\n    Face,\n    HalfEdgeComponent,\n  }\n})\nexport default class FlatTriangulation extends Vue {\n  @Prop({required: true, type: Object}) surface!: Triangulation;\n  @Prop({required: false, type: Array, default: []}) forced!: HalfEdge[];\n\n  private layout = null as FlatTriangulationLayout | null;\n  private cancellation = new CancellationToken();\n  protected halfEdges = [] as HalfEdge[];\n  protected faces = [] as Point[];\n\n  created() {\n    this.relayout();\n  }\n\n  @Watch(\"surface\")\n  surfaceChanged() {\n    this.relayout();\n  }\n\n  @Watch(\"forced\")\n  forcedChanged() {\n    this.relayout();\n  }\n\n  static _run(callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>): void {\n    callback(new CancellationToken(), new Progress());\n  }\n\n  @Inject({ from: 'run', default: () => FlatTriangulation._run})\n  run!: (callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>) => void;\n\n  async relayout() {\n    this.cancellation.abort();\n    this.run(async (cancellation, progress) => {\n      this.cancellation = cancellation;\n      try {\n        this.layout = await FlatTriangulationLayout.layout(this.surface, (he: HalfEdge) => (this.forced.includes(he) || this.forced.includes(-he)) ? true : null, this.cancellation, progress);\n      } catch (e) {\n        if (e instanceof OperationAborted) return;\n        throw e;\n      }\n      this.$emit(\"layout\", this.layout);\n      this.halfEdges = this.surface.halfEdges;\n      this.faces = this.surface.faces.cycles.map((face) => face.map((he) => this.layout!.layout(he).segment.end)) as any;\n    });\n\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlatTriangulation.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlatTriangulation.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FlatTriangulation.vue?vue&type=template&id=146858f4&\"\nimport script from \"./FlatTriangulation.vue?vue&type=script&lang=ts&\"\nexport * from \"./FlatTriangulation.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FlatTriangulation.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',[_c('g',{style:({ '--color': _vm.color })},_vm._l((_vm.patches),function(vertices,i){return _c('ngon',{key:i,attrs:{\"vertices\":vertices}})}),1),_c('g',{staticClass:\"boundary\"},_vm._l((_vm.perimeter),function(connection,i){return _c('saddle-connection-component',{key:i,attrs:{\"connection\":connection,\"layout\":_vm.layout}})}),1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{style:({ '--color': _vm.color })},_vm._l((_vm.segments),function(segment,i){return _c('segment-component',{key:i,attrs:{\"segment\":segment}})}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nimport FlatTriangulationLayout from '@/geometry/layout/FlatTriangulationLayout';\nimport  { Vue, Component, Prop } from \"vue-property-decorator\";\nimport SaddleConnectionData from \"../geometry/triangulation/SaddleConnection\";\nimport SegmentComponent from \"./svg/Segment.vue\";\nimport Segment from \"../geometry/Segment\";\nimport Point from \"../geometry/Point\";\nimport Line from \"../geometry/Line\";\nimport Vector from \"../geometry/Vector\";\n\n@Component({\n  components: {\n    SegmentComponent,\n  }\n})\nexport default class FlowComponent extends Vue {\n  @Prop({ required: true }) connection!: SaddleConnectionData;\n  @Prop({ required: true }) layout!: FlatTriangulationLayout;\n  @Prop({ required: false, type: String, default:\"orange\" }) color!: string;\n\n  get segments(): Segment[] {\n    const segments = [];\n\n    const vector = this.connection.vector;\n    const crossings = [...this.connection.crossings];\n\n    let start = this.layout.layout(this.connection.source).segment.start;\n    const end = crossings.length > 0 ? this.layout.layout(this.connection.target).segment.start : this.layout.layout(this.connection.source).segment.end;\n\n    // TODO: Use at() instead of halfEdge() to construct the point of intersection.\n    while(crossings.length) {\n\t\t  const crossing = crossings.shift()!;\n      if (this.layout.layout(crossing.halfEdge).inner)\n        continue;\n\n      // Since we are crossing an outer half edge, we compute the intersection\n      // of the saddle connection ray with it and add it to segments.\n      const line = new Line(start, start.translate(vector));\n      const crossingEdge = this.layout.layout(crossing.halfEdge).segment;\n      const crossingLine = new Line(crossingEdge.start, crossingEdge.end);\n      const intersection = line.intersect(crossingLine);\n      if (intersection === null) {\n        throw Error(\"saddle connection must intersect every crossing\");\n      }\n      segments.push(new Segment(start, intersection));\n\t\t  \n      // Now, we move the intersection point to the corresponding half-edge\n      // and repeat.\n      const alongHalfEdge = new Vector(intersection.parent, this.layout.layout(crossing.halfEdge).segment.start, intersection as Point);\n      start = this.layout.layout(-crossing.halfEdge).segment.end.translate(alongHalfEdge);\n    }\n\n    segments.push(new Segment(start, end));\n    \n    return segments;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SaddleConnection.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SaddleConnection.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SaddleConnection.vue?vue&type=template&id=18dfc604&scoped=true&\"\nimport script from \"./SaddleConnection.vue?vue&type=script&lang=ts&\"\nexport * from \"./SaddleConnection.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SaddleConnection.vue?vue&type=style&index=0&id=18dfc604&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"18dfc604\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport  { Vue, Component, Prop, Watch } from \"vue-property-decorator\";\nimport FlowComponentData from \"../geometry/triangulation/FlowComponent\";\nimport { Touch } from \"../geometry/triangulation/FlowConnection\";\nimport SaddleConnectionComponent from \"./SaddleConnection.vue\";\nimport FlatTriangulationLayout from \"../geometry/layout/FlatTriangulationLayout\";\nimport Ngon from \"./svg/Ngon.vue\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\nimport Point from \"../geometry/Point\";\nimport FlatTriangulation from \"../geometry/triangulation/FlatTriangulation\";\n\n@Component({\n  components: {\n    SaddleConnectionComponent,\n    Ngon,\n  },\n})\nexport default class FlowComponent extends Vue {\n  @Prop({ required: true }) component!: FlowComponentData;\n  @Prop({ required: true }) layout!: FlatTriangulationLayout;\n  @Prop({ required: true }) surface!: FlatTriangulation;\n  @Prop({ required: false, type: String, default:\"orange\" }) color!: string;\n\n  ats!: {[key: number]: number[]};\n  // Maps a half edge to the touches on that half edge in order.\n  touches!: {[key: number]: Touch[]};\n\n  get perimeter() {\n    let perimeter = this.component.perimeter;\n    if (this.component.cylinder)\n      // For cylinders do not show the connections at the top & bottom of the cylinder.\n      perimeter = perimeter.filter((connection) => connection.vertical);\n    else\n      // For minimal/undetermined components, do not show the inner structure of the component.\n      perimeter = perimeter.filter((connection) => connection.boundary);\n\n    return perimeter.map((connection) => connection.connection);\n  }\n\n  @Watch(\"layout\", { immediate: true })\n  resetCaches() {\n    this.ats = undefined as any;\n    this.touches = undefined as any;\n    this.ensureCaches();\n  }\n\n  ensureCaches() {\n    if (this.touches == null) {\n      this.touches = {};\n      for (const halfEdge of this.surface.halfEdges)\n        this.touches[halfEdge] = [];\n\n      for (const connection of this.component.perimeter) {\n        for (const touch of connection.touches) {\n          this.touches[touch.halfEdge][touch.index] = touch;\n        }\n      }\n    }\n    if (this.ats == null) {\n      this.ats = {};\n      for (const connection of this.component.perimeter) {\n        for (let i = 0; i < connection.touches.length; i++) {\n          const touch = connection.touches[i];\n          let at = 0;\n          if (i != 0 && i != connection.touches.length - 1) {\n            at = connection.connection.crossings[Math.floor((i - 1) / 2)].at;\n            if (i % 2 == 0)\n              at = 1 - at;\n          }\n          if (this.ats[touch.halfEdge] === undefined) this.ats[touch.halfEdge] = [];\n          this.ats[touch.halfEdge][touch.index] = at;\n        }\n      }\n    }\n  }\n\n  // Return the relative length in [0, 1] where `touch` intersects its half edge.\n  private at(touch: Touch): number {\n    console.assert(this.ats != null);\n    return this.ats[touch.halfEdge][touch.index];\n  }\n\n  // Return the triangle [A, B, C] completing the two touches `a`, `b`.\n  private patch(a: Touch, b: Touch): Point[] | null {\n    // Given `at` in [0, 1] returns the actual point on `halfEdge` that is that far on `halfEdge`.\n    const layout = (halfEdge: HalfEdge, at: number) => this.layout.layout(halfEdge).segment.at(at);\n\n    const isHalfEdge = a.halfEdge === -b.halfEdge;\n\n    const A = layout(a.halfEdge, this.at(a));\n    let B = isHalfEdge ? layout(a.halfEdge, 1) : layout(b.halfEdge, this.at(b));\n    let C = B;\n\n    let scenario = \"undefined\";\n\n    if (isHalfEdge) {\n      console.assert(this.at(a) === 0, \"Edge-parallel connection must start at vertex.\")\n      console.assert(this.at(b) === 0, \"Edge-parallel connection must end at vertex.\");\n    } else {\n      console.assert(a.halfEdge !== b.halfEdge, `Saddle Connection cannot cross the half edge ${a.halfEdge} twice in a row.`);\n    }\n\n    const atouches = this.touches[a.halfEdge];\n    const btouches = this.touches[b.halfEdge];\n\n    if (isHalfEdge) {\n      return null;\n    } else {\n      if (b.index === btouches.length - 1) {\n        if (this.at(b) === 1) {\n          // The vertex B of the patch is an actual vertex of the triangulation. We will search for C on A's half edge.\n\n          // Search for C on A's half edge.\n          console.assert(this.at(a) !== 0);\n          if (a.index === 0) {\n            // Everything next to A is part of this patch.\n            console.assert(this.at(a) !== 0);\n            C = layout(a.halfEdge, 0);\n          } else {\n            C = layout(a.halfEdge, this.at(atouches[a.index - 1]));\n          }\n        } else {\n          // Everything next to B is part of this patch.\n          scenario = \"remaining face\";\n          C = layout(b.halfEdge, 1);\n          if (this.at(b) === 0)\n            return null;\n        }\n      } else {\n        if (this.at(b) === this.at(btouches[b.index + 1])) {\n          // The vertex B of this patch is a vertex of the component.\n          console.assert(this.at(b) === 0 || this.at(b) === 1, \"Vertices of components must be aligned with the vertices of the triangulation.\");\n\n          // Search for C on A's half edge.\n          console.assert(this.at(a) !== 0);\n          if (a.index === 0) {\n            // Everything next to A is part of this patch.\n            console.assert(this.at(a) !== 0);\n            // TODO: Is this always taken care of by something else?\n            C = layout(a.halfEdge, 0);\n            return null;\n          } else {\n            // TODO: Is this always taken care of by something else?\n            C = layout(a.halfEdge, this.at(atouches[a.index - 1]));\n            return null;\n          }\n        } else {\n          console.assert(this.at(btouches[b.index + 1]) > this.at(b), `Touches are not ordered correctly on half edge ${b.halfEdge}. The ${btouches[b.index + 1].index}th touch at ${this.at(btouches[b.index + 1])} should not be after the ${b.index}th touch at ${this.at(b)}.`);\n          C = layout(b.halfEdge, this.at(btouches[b.index + 1]));\n        }\n      }\n    }\n\n    console.assert(!A.equalTo(B), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice A == B, i.e., ${A.toString()} == ${B.toString()}.`);\n    console.assert(!A.equalTo(C), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice A == C, i.e., ${A.toString()} == ${C.toString()}.`);\n    console.assert(!B.equalTo(C), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice B == C, i.e., ${B.toString()} == ${C.toString()}.`);\n\n    return [A, B, C];\n  }\n\n  private patchHalfEdge(halfEdge: HalfEdge): Point[] | null {\n    // Given `at` in [0, 1] returns the actual point on `halfEdge` that is that far on `halfEdge`.\n    const layout = (halfEdge: HalfEdge, at: number) => this.layout.layout(halfEdge).segment.at(at);\n\n    const face = [halfEdge, this.surface.faces.image(halfEdge), this.surface.faces.preimage(halfEdge)];\n\n    const A = layout(halfEdge, 0);\n    const B = layout(halfEdge, 1);\n    let C = B;\n    let scenario = \"undefined\";\n\n    // Search for the third point of the patch on the following half edge in the face.\n    let touches = this.touches[face[1]]\n    if (touches.length === 0) {\n      // Since nothing intersects the following half edge in this face, this\n      // patch is the entire face.\n      scenario = \"entire face\";\n      C = layout(face[1], 1);\n      if (face[0] !== Math.min(...face))\n        return null;\n    } else if (this.at(touches[0]) === 0) {\n      // Something starts at the vertex joining this half edge with the\n      // following half edge...\n      touches = this.touches[-face[2]];\n      if (touches.every((touch) => this.at(touch) === 0 || this.at(touch) === 1)) {\n        // ...it is just the following half edge itself.\n        scenario = \"entire face 2\";\n        // TODO: Is this always taken care of by something else?\n        C = layout(face[1], 1);\n        if (face[0] !== Math.min(...face))\n          return null;\n      } else {\n        // It's another connection. So the patch ends at the beginning of the\n        // next half edge, none of that half edge is in the patch, i.e., the\n        // third point of the patch must be on the other half edge of this\n        // face.\n        scenario = \"on previous half edge\";\n        for (const touch of touches) {\n          if (this.at(touch) !== 0) {\n            // TODO: Is this always taken care of by something else?\n            C = layout(face[2], 1 - this.at(touch));\n            return null;\n            break;\n          }\n        }\n      }\n    } else {\n      scenario = \"on following half edge\";\n      C = layout(face[1], this.at(touches[0]));\n    }\n\n    console.assert(!A.equalTo(B), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice A == B, i.e., ${A.toString()} == ${B.toString()}.`);\n    console.assert(!A.equalTo(C), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice A == C, i.e., ${A.toString()} == ${C.toString()}.`);\n    console.assert(!B.equalTo(C), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice B == C, i.e., ${B.toString()} == ${C.toString()}.`);\n\n    return [A, B, C];\n  }\n\n  get patches() {\n    let /* TODO const */ patches = [];\n\n    for (const connection of this.component.perimeter) {\n      for (let i = 0; i < connection.touches.length; i+=2) {\n        const patch = this.patch(connection.touches[i], connection.touches[i + 1])\n        if (patch !== null)\n          patches.push(patch);\n      }\n    }\n\n    for (const inside of this.component.inside) {\n      const patch = this.patchHalfEdge(inside);\n      if (patch != null)\n        patches.push(patch);\n    }\n\n    return patches;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlowComponent.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlowComponent.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FlowComponent.vue?vue&type=template&id=622cb8ef&scoped=true&\"\nimport script from \"./FlowComponent.vue?vue&type=script&lang=ts&\"\nexport * from \"./FlowComponent.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FlowComponent.vue?vue&type=style&index=0&id=622cb8ef&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"622cb8ef\",\n  null\n  \n)\n\nexport default component.exports","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rüth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport iwanthue from \"iwanthue\";\n\nexport default class Palette {\n  constructor(colors: number = 2) {\n    // TODO: Typings in iwanthue are wrong.\n    this.palette = iwanthue(colors >= 2 ? colors : 2, { seed: 1337 as any });\n  }\n\n  color(i: number) {\n    if (i >= this.palette.length)\n      console.warn(\"Color outside of palette bounds requested.\");\n    return this.palette[i % this.palette.length];\n  }\n\n  private readonly palette;\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Provide, Watch } from \"vue-property-decorator\";\n\nimport Viewport from \"../geometry/Viewport\";\nimport FlatTriangulation from \"../geometry/triangulation/FlatTriangulation\";\nimport FlatTriangulationComponent from \"./FlatTriangulation.vue\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\nimport FlowComponent from \"../geometry/triangulation/FlowComponent\";\nimport FlowComponentComponent from \"./FlowComponent.vue\";\nimport Palette from \"@/Palette\";\n\nimport Point from \"@/geometry/Point\";\nimport Vector from \"@/geometry/Vector\";\nimport Segment from \"@/geometry/Segment\";\nimport FlatTriangulationLayout from '@/geometry/layout/FlatTriangulationLayout';\nimport { IHalfEdgeConfiguration } from \"./HalfEdgeConfiguration\";\n\n@Component({\n  components: {\n    FlatTriangulationComponent,\n    FlowComponentComponent,\n  }\n})\nexport default class Surface extends Vue {\n  @Prop({ required: true }) viewport!: Viewport;\n  @Prop({ required: true }) surface!: FlatTriangulation;\n  @Prop({ required: false, default: () => [], type: Array }) components!: FlowComponent[];\n  @Prop({ required: false, default: () => [], type: Array }) inner!: HalfEdge[];\n  \n  layout = null as FlatTriangulationLayout | null;\n  forced = [] as HalfEdge[];\n  selected = [] as HalfEdge[];\n  hovered = [] as HalfEdge[];\n  indicator = {} as Record<HalfEdge, number | null>;\n\n  // TODO: It is a strange pattern to hide the updates behind the layout updates.\n  palette = new Palette();\n\n  @Provide()\n  svg(xy: Vector | Point | Segment) : Vector | Point | Segment {\n    if (xy instanceof Vector)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    if (xy instanceof Point)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    if (xy instanceof Segment)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    throw new Error(\"Cannot embed this type into the SVG coordinate system yet.\");\n  }\n\n  @Watch(\"inner\", {immediate: true})\n  onInnerChanged() {\n    this.forced = this.inner;\n  }\n\n  forceHalfEdge(halfEdge: HalfEdge) {\n    this.forced.push(halfEdge);\n  }\n\n  onLayoutChanged(layout: FlatTriangulationLayout) {\n    this.layout = layout;\n    this.palette = new Palette(this.components.length);\n    this.$emit('layout', layout);\n  }\n\n  async glue(halfEdge: HalfEdge) {\n    if (this.forced.includes(halfEdge) || this.forced.includes(-halfEdge))\n      this.forced = this.forced.filter((he) => he !== halfEdge && he !== -halfEdge);\n    else\n      this.forced.unshift(halfEdge);\n\n    this.selected.push(halfEdge); \n\n    await new Promise(resolve => this.$once(\"layout\", resolve));\n\n    await new Promise(resolve => setTimeout(resolve, 500));\n\n    this.selected = this.selected.filter((he) => he !== halfEdge && he !== -halfEdge);\n  }\n\n  hover(halfEdge: HalfEdge, at: number) {\n    this.hovered.push(halfEdge);\n    this.indicator[halfEdge] = at;\n    this.indicator[-halfEdge] = 1 - at;\n  }\n\n  unhover(halfEdge: HalfEdge) {\n    this.hovered = this.hovered.filter((he) => he !== halfEdge && he !== -halfEdge);\n    this.indicator[halfEdge] = null;\n    this.indicator[-halfEdge] = null;\n  }\n\n  // TODO: This should live in a more generic place.\n  private relativizeOntoSegment(segment: Segment, point: Point): number {\n    const e = segment.value.tangentInStart();\n    const toPoint = new Vector(segment.parent, segment.start, point).value;\n    return e.dot(toPoint) / segment.value.length;\n  }\n\n  // TODO: This is a weird name.\n  @Provide()\n  halfEdgeConfiguration(halfEdge: HalfEdge): IHalfEdgeConfiguration {\n    return {\n      interactions: {\n        click: () => {\n          this.unhover(halfEdge)\n          this.glue(halfEdge)\n        },\n        // TODO: This assumes that this component fills the viewport coordinate system. That's probably always in practice true but maybe we should inject the offset.\n        enter: (ev: MouseEvent, segment: Segment) => this.hover(halfEdge, this.relativizeOntoSegment(segment, new Point(this.viewport.viewportCoordinateSystem, ev.clientX - this.$el.getBoundingClientRect().left, ev.clientY - this.$el.getBoundingClientRect().top))),\n        leave: () => this.unhover(halfEdge),\n        hover: (ev: MouseEvent, segment: Segment) => this.hover(halfEdge, this.relativizeOntoSegment(segment, new Point(this.viewport.viewportCoordinateSystem, ev.clientX - this.$el.getBoundingClientRect().left, ev.clientY - this.$el.getBoundingClientRect().top))),\n      },\n      state: {\n        selected: this.selected.includes(halfEdge) || this.selected.includes(-halfEdge),\n        glued: this.forced.includes(halfEdge) || this.forced.includes(-halfEdge),\n        labeled: this.hovered.includes(halfEdge) || this.hovered.includes(-halfEdge),\n        indicator: this.indicator[halfEdge],\n      },\n    };\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Surface.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Surface.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Surface.vue?vue&type=template&id=aa4316c8&\"\nimport script from \"./Surface.vue?vue&type=script&lang=ts&\"\nexport * from \"./Surface.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport YAML from \"yaml\";\n\nimport CoordinateSystem from \"@/geometry/CoordinateSystem\";\nimport FlatTriangulation from \"@/geometry/triangulation/FlatTriangulation\";\nimport FlowComponent from \"@/geometry/triangulation/FlowComponent\";\nimport FlatTriangulationLayout from \"@/geometry/layout/FlatTriangulationLayout\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\n\nimport PanZoom from \"./PanZoom.vue\";\nimport Surface from \"./Surface.vue\";\n\n@Component({\n  components: {\n    Surface,\n    PanZoom,\n  }\n})\nexport default class SurfaceViewer extends Vue {\n  @Prop({ required: true }) raw!: string;\n  @Prop({ required: false, default: () => [], type: Array }) inner!: HalfEdge[];\n\n  private readonly idealCoordinateSystem = new CoordinateSystem(true);\n  protected surface: FlatTriangulation | null = null;\n  protected components: FlowComponent[] = [];\n\n  focus = this.idealCoordinateSystem.box([-1, -1], [1, 1]);\n\n  protected onLayoutChanged(layout: FlatTriangulationLayout) {\n    if (!this.focus.equalTo(layout.bbox))\n      this.focus = layout.bbox;\n    this.$emit('layout', layout)\n    this.$emit('update:inner', this.surface!.halfEdges.filter((he) => layout.layout(he).inner));\n  }\n\n  @Watch(\"raw\", { immediate: true })\n  onRawChanged() {\n    try {\n      const parsed = YAML.parse(this.raw);\n      this.surface = FlatTriangulation.parse(parsed, this.idealCoordinateSystem);\n      this.components = (parsed.components || []).map((component: any) => FlowComponent.parse(component, this.idealCoordinateSystem));\n      this.$emit('ok');\n    } catch(e) {\n      this.$emit('error', e.message);\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SurfaceViewer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SurfaceViewer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SurfaceViewer.vue?vue&type=template&id=1ec7ae56&\"\nimport script from \"./SurfaceViewer.vue?vue&type=script&lang=ts&\"\nexport * from \"./SurfaceViewer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default \"vertices:\\n- - 1\\n  - -3\\n  - -9\\n  - -21\\n  - 14\\n  - 6\\n  - -7\\n  - -17\\n  - -27\\n  - 25\\n  - -26\\n  - 23\\n  - 12\\n  - -13\\n  - 18\\n  - -19\\n  - 10\\n  - 4\\n- - -1\\n  - -5\\n  - -12\\n  - 16\\n  - 7\\n  - 2\\n- - -2\\n  - -6\\n  - -15\\n  - -25\\n  - 24\\n  - 13\\n  - 5\\n  - -4\\n  - -11\\n  - 21\\n  - -20\\n  - 17\\n  - -16\\n  - -23\\n  - 22\\n  - 19\\n  - 8\\n  - 3\\n- - -8\\n  - -18\\n  - -24\\n  - 27\\n  - 20\\n  - 9\\n- - -10\\n  - -22\\n  - 26\\n  - 15\\n  - -14\\n  - 11\\nvectors:\\n  1:\\n    x: 1.0\\n    y: 0.0\\n  2:\\n    x: -0.32635182233306964\\n    y: 0.565257937423568\\n  3:\\n    x: -0.6736481776669303\\n    y: -0.565257937423568\\n  4:\\n    x: 0.6736481776669303\\n    y: -0.565257937423568\\n  5:\\n    x: 0.32635182233306964\\n    y: 0.565257937423568\\n  6:\\n    x: -0.8263518223330697\\n    y: -0.3007674663608706\\n  7:\\n    x: 0.5\\n    y: 0.8660254037844386\\n  8:\\n    x: -0.5\\n    y: 0.41954981558864\\n  9:\\n    x: -0.17364817766693036\\n    y: -0.984807753012208\\n  10:\\n    x: 0.17364817766693036\\n    y: -0.984807753012208\\n  11:\\n    x: 0.5\\n    y: 0.41954981558864\\n  12:\\n    x: -0.5\\n    y: 0.8660254037844386\\n  13:\\n    x: 0.8263518223330697\\n    y: -0.3007674663608706\\n  14:\\n    x: -0.9396926207859084\\n    y: 0.3420201433256687\\n  15:\\n    x: 0.11334079845283873\\n    y: -0.6427876096865394\\n  16:\\n    x: 0.6527036446661393\\n    y: 0.0\\n  17:\\n    x: -0.1527036446661393\\n    y: 0.8660254037844386\\n  18:\\n    x: -0.9396926207859084\\n    y: -0.3420201433256687\\n  19:\\n    x: 0.4396926207859084\\n    y: 0.7615699589143088\\n  20:\\n    x: -0.6133407984528387\\n    y: -0.22323779409789932\\n  21:\\n    x: 0.4396926207859084\\n    y: -0.7615699589143088\\n  22:\\n    x: 0.6133407984528387\\n    y: -0.22323779409789932\\n  23:\\n    x: 0.1527036446661393\\n    y: 0.8660254037844386\\n  24:\\n    x: -0.11334079845283873\\n    y: -0.6427876096865394\\n  25:\\n    x: 0.8793852415718167\\n    y: 0.0\\n  26:\\n    x: -0.766044443118978\\n    y: -0.6427876096865394\\n  27:\\n    x: -0.766044443118978\\n    y: 0.6427876096865394\\ncomponents:\\n- cylinder: true\\n  perimeter:\\n  - source: 25\\n    target: -25\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.8793852415718167\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 25\\n      index: 0\\n    - halfEdge: -25\\n      index: 1\\n  - source: -15\\n    target: 13\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -1.7057370639048863\\n      y: 0.3007674663608706\\n    crossings:\\n    - halfEdge: 26\\n      at: 0.8006595491452156\\n    - halfEdge: -23\\n      at: 0.8263518223330697\\n    - halfEdge: -12\\n      at: 0.8006595491452156\\n    touches:\\n    - halfEdge: -15\\n      index: 0\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: 13\\n      index: 0\\n  - source: -25\\n    target: 25\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.8793852415718167\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -25\\n      index: 0\\n    - halfEdge: 25\\n      index: 1\\n  - source: -27\\n    target: -13\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 1.7057370639048863\\n      y: -0.3007674663608706\\n    crossings:\\n    - halfEdge: -24\\n      at: 0.766044443118978\\n    touches:\\n    - halfEdge: -27\\n      index: 0\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -13\\n      index: 0\\n  inside:\\n  - 13\\n  - -13\\n  - 25\\n  - -25\\n- cylinder: true\\n  perimeter:\\n  - source: 1\\n    target: -1\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 1.0\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 1\\n      index: 0\\n    - halfEdge: -1\\n      index: 1\\n  - source: 16\\n    target: -16\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.6527036446661393\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 16\\n      index: 0\\n    - halfEdge: -16\\n      index: 1\\n  - source: 17\\n    target: 22\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: -7\\n      at: 0.8793852415718167\\n    - halfEdge: -2\\n      at: 0.7733184030943225\\n    - halfEdge: 3\\n      at: 0.5739779522395382\\n    - halfEdge: 9\\n      at: 0.713011023880231\\n    - halfEdge: 21\\n      at: 0.5739779522395382\\n    - halfEdge: -11\\n      at: 0.7733184030943225\\n    - halfEdge: 10\\n      at: 0.8793852415718167\\n    touches:\\n    - halfEdge: 17\\n      index: 0\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -2\\n      index: 0\\n    - halfEdge: 2\\n      index: 0\\n    - halfEdge: 3\\n      index: 0\\n    - halfEdge: -3\\n      index: 0\\n    - halfEdge: 9\\n      index: 0\\n    - halfEdge: -9\\n      index: 0\\n    - halfEdge: 21\\n      index: 0\\n    - halfEdge: -21\\n      index: 0\\n    - halfEdge: -11\\n      index: 0\\n    - halfEdge: 11\\n      index: 0\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 22\\n      index: 0\\n  - source: -16\\n    target: 16\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.6527036446661393\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -16\\n      index: 0\\n    - halfEdge: 16\\n      index: 1\\n  - source: -1\\n    target: 1\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -1.0\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -1\\n      index: 0\\n    - halfEdge: 1\\n      index: 1\\n  - source: 4\\n    target: 14\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: 5\\n      at: 0.7168814171420514\\n    - halfEdge: 12\\n      at: 0.7733184030943225\\n    - halfEdge: 23\\n      at: 0.6736481776669303\\n    - halfEdge: -26\\n      at: 0.7733184030943225\\n    - halfEdge: -15\\n      at: 0.7168814171420514\\n    touches:\\n    - halfEdge: 4\\n      index: 0\\n    - halfEdge: 5\\n      index: 0\\n    - halfEdge: -5\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -15\\n      index: 0\\n    - halfEdge: 15\\n      index: 0\\n    - halfEdge: 14\\n      index: 0\\n  inside:\\n  - 1\\n  - -1\\n  - 14\\n  - -14\\n  - 16\\n  - -16\\n  - 22\\n  - -22\\n- cylinder: true\\n  perimeter:\\n  - source: 22\\n    target: -4\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 1.1133407984528387\\n      y: 0.19631202149074067\\n    crossings:\\n    - halfEdge: -10\\n      at: 0.32635182233306964\\n    touches:\\n    - halfEdge: 22\\n      index: 0\\n    - halfEdge: -10\\n      index: 2\\n    - halfEdge: 10\\n      index: 1\\n    - halfEdge: -4\\n      index: 1\\n  - source: -4\\n    target: -2\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: 10\\n      at: 0.4679111137620439\\n    - halfEdge: -19\\n      at: 0.532088886237956\\n    - halfEdge: 18\\n      at: 0.8793852415718167\\n    - halfEdge: 24\\n      at: 0.9076037345479523\\n    - halfEdge: -27\\n      at: 0.8793852415718167\\n    - halfEdge: -17\\n      at: 0.532088886237956\\n    - halfEdge: -7\\n      at: 0.4679111137620439\\n    touches:\\n    - halfEdge: -4\\n      index: 2\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -10\\n      index: 3\\n    - halfEdge: -19\\n      index: 0\\n    - halfEdge: 19\\n      index: 0\\n    - halfEdge: 18\\n      index: 0\\n    - halfEdge: -18\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: -27\\n      index: 0\\n    - halfEdge: 27\\n      index: 0\\n    - halfEdge: -17\\n      index: 0\\n    - halfEdge: 17\\n      index: 1\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 7\\n      index: 1\\n    - halfEdge: -2\\n      index: 0\\n  - source: 8\\n    target: 21\\n    vertical: true\\n    boundary: false\\n    vector:\\n      x: -1.1133407984528387\\n      y: 0.19631202149074067\\n    crossings:\\n    - halfEdge: 9\\n      at: 0.32635182233306964\\n    touches:\\n    - halfEdge: 8\\n      index: 0\\n    - halfEdge: 9\\n      index: 1\\n    - halfEdge: -9\\n      index: 1\\n    - halfEdge: 21\\n      index: 1\\n  - source: -4\\n    target: 22\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -1.1133407984528387\\n      y: -0.19631202149074067\\n    crossings:\\n    - halfEdge: 10\\n      at: 0.6736481776669303\\n    touches:\\n    - halfEdge: -4\\n      index: 0\\n    - halfEdge: 10\\n      index: 2\\n    - halfEdge: -10\\n      index: 1\\n    - halfEdge: 22\\n      index: 1\\n  - source: 22\\n    target: 17\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: -10\\n      at: 0.12061475842818323\\n    - halfEdge: 11\\n      at: 0.22668159690567746\\n    - halfEdge: -21\\n      at: 0.4260220477604618\\n    - halfEdge: -9\\n      at: 0.2869889761197691\\n    - halfEdge: -3\\n      at: 0.4260220477604618\\n    - halfEdge: 2\\n      at: 0.22668159690567746\\n    - halfEdge: 7\\n      at: 0.12061475842818323\\n    touches:\\n    - halfEdge: 22\\n      index: 2\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 10\\n      index: 3\\n    - halfEdge: 11\\n      index: 0\\n    - halfEdge: -11\\n      index: 0\\n    - halfEdge: -21\\n      index: 0\\n    - halfEdge: 21\\n      index: 2\\n    - halfEdge: -9\\n      index: 0\\n    - halfEdge: 9\\n      index: 2\\n    - halfEdge: -3\\n      index: 0\\n    - halfEdge: 3\\n      index: 0\\n    - halfEdge: 2\\n      index: 0\\n    - halfEdge: -2\\n      index: 1\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -7\\n      index: 1\\n    - halfEdge: 17\\n      index: 0\\n  - source: 21\\n    target: 8\\n    vertical: true\\n    boundary: false\\n    vector:\\n      x: 1.1133407984528387\\n      y: -0.19631202149074067\\n    crossings:\\n    - halfEdge: -9\\n      at: 0.6736481776669303\\n    touches:\\n    - halfEdge: 21\\n      index: 0\\n    - halfEdge: -9\\n      index: 2\\n    - halfEdge: 9\\n      index: 0\\n    - halfEdge: 8\\n      index: 1\\n  inside:\\n  - 8\\n  - -8\\n  - 20\\n  - -20\\n- cylinder: true\\n  perimeter:\\n  - source: -6\\n    target: 6\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.8263518223330697\\n      y: 0.3007674663608706\\n    crossings: []\\n    touches:\\n    - halfEdge: -6\\n      index: 0\\n    - halfEdge: 6\\n      index: 1\\n  - source: 14\\n    target: 4\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: 15\\n      at: 0.28311858285794855\\n    - halfEdge: 26\\n      at: 0.22668159690567746\\n    - halfEdge: -23\\n      at: 0.32635182233306964\\n    - halfEdge: -12\\n      at: 0.22668159690567746\\n    - halfEdge: -5\\n      at: 0.28311858285794855\\n    touches:\\n    - halfEdge: 14\\n      index: 0\\n    - halfEdge: 15\\n      index: 0\\n    - halfEdge: -15\\n      index: 1\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -26\\n      index: 1\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: 23\\n      index: 1\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 12\\n      index: 1\\n    - halfEdge: -5\\n      index: 0\\n    - halfEdge: 5\\n      index: 0\\n    - halfEdge: 4\\n      index: 0\\n  - source: -13\\n    target: -27\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -1.7057370639048863\\n      y: 0.3007674663608706\\n    crossings:\\n    - halfEdge: 24\\n      at: 0.23395555688102196\\n    touches:\\n    - halfEdge: -13\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -24\\n      index: 1\\n    - halfEdge: -27\\n      index: 0\\n  - source: 6\\n    target: -6\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.8263518223330697\\n      y: -0.3007674663608706\\n    crossings: []\\n    touches:\\n    - halfEdge: 6\\n      index: 0\\n    - halfEdge: -6\\n      index: 1\\n  - source: -2\\n    target: -4\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: 7\\n      at: 0.532088886237956\\n    - halfEdge: 17\\n      at: 0.4679111137620439\\n    - halfEdge: 27\\n      at: 0.12061475842818323\\n    - halfEdge: -24\\n      at: 0.09239626545204768\\n    - halfEdge: -18\\n      at: 0.12061475842818323\\n    - halfEdge: 19\\n      at: 0.4679111137620439\\n    - halfEdge: -10\\n      at: 0.532088886237956\\n    touches:\\n    - halfEdge: -2\\n      index: 0\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 17\\n      index: 0\\n    - halfEdge: -17\\n      index: 0\\n    - halfEdge: 27\\n      index: 0\\n    - halfEdge: -27\\n      index: 1\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: 24\\n      index: 1\\n    - halfEdge: -18\\n      index: 0\\n    - halfEdge: 18\\n      index: 0\\n    - halfEdge: 19\\n      index: 0\\n    - halfEdge: -19\\n      index: 0\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -4\\n      index: 0\\n  - source: 13\\n    target: -15\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 1.7057370639048863\\n      y: -0.3007674663608706\\n    crossings:\\n    - halfEdge: 12\\n      at: 0.19934045085478438\\n    - halfEdge: 23\\n      at: 0.17364817766693036\\n    - halfEdge: -26\\n      at: 0.19934045085478438\\n    touches:\\n    - halfEdge: 13\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: -12\\n      index: 1\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -23\\n      index: 1\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: 26\\n      index: 1\\n    - halfEdge: -15\\n      index: 0\\n  inside:\\n  - 4\\n  - -4\\n  - 6\\n  - -6\\n\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.cancellation != null && _vm.visible)?_c('v-overlay',{staticClass:\"loading-overlay\",attrs:{\"opacity\":.2,\"z-index\":0}},[_c('v-container',[_c('v-row',[_c('v-col',[_vm._v(\" \"+_vm._s(_vm.name)+\"… \"),_c('v-progress-circular',{attrs:{\"indeterminate\":_vm.value == null,\"value\":_vm.value}})],1)],1),_c('v-row',[_c('v-col',[_c('v-btn',{attrs:{\"color\":\"error\",\"dark\":\"\",\"disabled\":_vm.cancellation.cancelled},on:{\"click\":function () { return _vm.cancellation.cancel(); }}},[_vm._v(\"Cancel\")])],1)],1)],1)],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport CancellationToken from \"../src/CancellationToken\";\nimport Progress from \"../src/Progress\";\n\n@Component\nexport default class Overlay extends Vue {\n  @Prop({required: true}) cancellation!: CancellationToken | null;\n  @Prop({required: true}) progress!: Progress | null;\n\n  visible = false;\n\n  @Watch(\"cancellation\", {immediate: true})\n  onCancellation(value: CancellationToken) {\n    if (value == null)\n      this.visible = false;\n    else\n      setTimeout(() => {\n        if (this.cancellation === value)\n          this.visible = true\n      }, 150);\n  }\n\n  get name() {\n    return this.progress!.stats.name;\n  }\n\n  get value() : number | null {\n    if (this.progress!.stats.step == null || this.progress!.stats.steps == null)\n      return null;\n    return this.progress!.stats.step / this.progress!.stats.steps * 100;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Overlay.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Overlay.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Overlay.vue?vue&type=template&id=3e466302&scoped=true&\"\nimport script from \"./Overlay.vue?vue&type=script&lang=ts&\"\nexport * from \"./Overlay.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Overlay.vue?vue&type=style&index=0&id=3e466302&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3e466302\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VOverlay } from 'vuetify/lib/components/VOverlay';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCol,VContainer,VOverlay,VProgressCircular,VRow})\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Provide, Vue } from \"vue-property-decorator\";\nimport PanZoom from \"@/components/PanZoom.vue\";\nimport SurfaceViewer from \"@/components/SurfaceViewer.vue\";\nimport dump from \"!!raw-loader!./2-3-4-pullback-flow.txt\";\nimport CancellationToken from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\nimport Overlay from \"./Overlay.vue\";\n\n@Component({\n  components: {\n    Overlay,\n    PanZoom,\n    SurfaceViewer,\n  }\n})\nexport default class App extends Vue {\n  raw = dump;\n  editor = false;\n  overlay = null as CancellationToken | null;\n  error = null as string | null;\n  progress = null as Progress | null;\n\n  @Provide()\n  async run(callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>) {\n    this.overlay = new CancellationToken();\n    this.progress = new Progress();\n    try {\n      await callback(this.overlay, this.progress);\n    } finally {\n      this.overlay = null;\n    }\n  }\n\n  onError(message: string | null = null) {\n    this.error= message;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=f44a1eb2&scoped=true&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=f44a1eb2&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f44a1eb2\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VMain } from 'vuetify/lib/components/VMain';\nimport { VTextarea } from 'vuetify/lib/components/VTextarea';\nimport { VToolbar } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VApp,VBtn,VCard,VCardTitle,VContainer,VDialog,VForm,VIcon,VMain,VTextarea,VToolbar})\n","import Vue, { VNode } from 'vue';\nimport App from './App.vue';\nimport Vuetify from 'vuetify/lib';\nimport '@mdi/font/css/materialdesignicons.css'\n\nVue.config.productionTip = false;\n\nVue.use(Vuetify);\n\nnew Vue({\n    render: (h): VNode => h(App),\n    vuetify: new Vuetify({}),\n}).$mount('#app');\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkvue_flatsurf\"] = self[\"webpackChunkvue_flatsurf\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(3467); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}