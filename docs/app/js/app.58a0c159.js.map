{"version":3,"sources":["webpack://vue-flatsurf/./demo/App.vue?4158","webpack://vue-flatsurf/./src/components/PanZoom.vue?01ff","webpack://vue-flatsurf/./src/geometry/Point.ts","webpack://vue-flatsurf/./src/geometry/Box.ts","webpack://vue-flatsurf/./src/geometry/Vector.ts","webpack://vue-flatsurf/./src/geometry/Segment.ts","webpack://vue-flatsurf/./src/geometry/Line.ts","webpack://vue-flatsurf/./src/geometry/CoordinateSystem.ts","webpack://vue-flatsurf/./src/geometry/Viewport.ts","webpack://vue-flatsurf/./src/components/PanZoom.vue","webpack://vue-flatsurf/./src/components/PanZoom.vue?9fa1","webpack://vue-flatsurf/./src/components/PanZoom.vue?7336","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?e981","webpack://vue-flatsurf/./src/geometry/triangulation/Permutation.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlatTriangulation.ts","webpack://vue-flatsurf/./src/geometry/triangulation/SaddleConnection.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlowConnection.ts","webpack://vue-flatsurf/./src/geometry/triangulation/FlowComponent.ts","webpack://vue-flatsurf/./src/components/Surface.vue?edba","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?a642","webpack://vue-flatsurf/./src/components/Face.vue?af62","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?acbc","webpack://vue-flatsurf/./src/components/svg/Ngon.vue","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?259e","webpack://vue-flatsurf/./src/components/svg/Ngon.vue?ed49","webpack://vue-flatsurf/./src/components/Face.vue","webpack://vue-flatsurf/./src/components/Face.vue?dab4","webpack://vue-flatsurf/./src/components/Face.vue?1bf1","webpack://vue-flatsurf/./src/components/HalfEdge.vue?ce70","webpack://vue-flatsurf/./src/components/svg/Segment.vue?dd62","webpack://vue-flatsurf/./src/components/svg/Segment.vue","webpack://vue-flatsurf/./src/components/svg/Segment.vue?4ff6","webpack://vue-flatsurf/./src/components/svg/Segment.vue?c246","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?7c4b","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?f6d6","webpack://vue-flatsurf/./src/components/svg/SegmentLabel.vue?aaf3","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?f880","webpack://vue-flatsurf/./src/components/svg/Arrow.vue","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?d680","webpack://vue-flatsurf/./src/components/svg/Arrow.vue?5da5","webpack://vue-flatsurf/./src/components/svg/ExtendedClickArea.vue?514f","webpack://vue-flatsurf/./src/components/svg/ExtendedClickArea.vue","webpack://vue-flatsurf/./src/components/HalfEdgeConfiguration.ts","webpack://vue-flatsurf/./src/components/HalfEdge.vue","webpack://vue-flatsurf/./src/components/HalfEdge.vue?2ee5","webpack://vue-flatsurf/./src/components/HalfEdge.vue?fa65","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?e38e","webpack://vue-flatsurf/./src/components/FlatTriangulation.vue?9e07","webpack://vue-flatsurf/./src/components/FlowComponent.vue?e742","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?4c1f","webpack://vue-flatsurf/./src/components/SaddleConnection.vue","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?4ee1","webpack://vue-flatsurf/./src/components/SaddleConnection.vue?5a2a","webpack://vue-flatsurf/./src/components/FlowComponent.vue","webpack://vue-flatsurf/./src/components/FlowComponent.vue?4dde","webpack://vue-flatsurf/./src/components/FlowComponent.vue?bd31","webpack://vue-flatsurf/./src/Palette.ts","webpack://vue-flatsurf/./src/geometry/Polygon.ts","webpack://vue-flatsurf/./src/Progress.ts","webpack://vue-flatsurf/./src/CancellationToken.ts","webpack://vue-flatsurf/./src/geometry/layout/CellLayout.ts","webpack://vue-flatsurf/./src/geometry/layout/FlatTriangulationLayout.ts","webpack://vue-flatsurf/./src/export/SVGExporter.ts","webpack://vue-flatsurf/./src/components/Surface.vue","webpack://vue-flatsurf/./src/components/Surface.vue?3189","webpack://vue-flatsurf/./src/components/Surface.vue?94ad","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?1ac1","webpack://vue-flatsurf/./src/components/SurfaceViewer.vue?3274","webpack://vue-flatsurf/./demo/2-3-4-pullback-flow.txt","webpack://vue-flatsurf/./demo/Overlay.vue?d770","webpack://vue-flatsurf/./demo/Overlay.vue","webpack://vue-flatsurf/./demo/Overlay.vue?3854","webpack://vue-flatsurf/./demo/Overlay.vue?d4f7","webpack://vue-flatsurf/./demo/App.vue","webpack://vue-flatsurf/./demo/App.vue?2c48","webpack://vue-flatsurf/./demo/App.vue?7ebf","webpack://vue-flatsurf/./demo/main.ts","webpack://vue-flatsurf/webpack/bootstrap","webpack://vue-flatsurf/webpack/runtime/chunk loaded","webpack://vue-flatsurf/webpack/runtime/compat get default export","webpack://vue-flatsurf/webpack/runtime/define property getters","webpack://vue-flatsurf/webpack/runtime/global","webpack://vue-flatsurf/webpack/runtime/hasOwnProperty shorthand","webpack://vue-flatsurf/webpack/runtime/make namespace object","webpack://vue-flatsurf/webpack/runtime/jsonp chunk loading","webpack://vue-flatsurf/webpack/startup"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","overlay","progress","raw","on","onError","svg","svgExport","scopedSlots","_u","key","fn","ref","_g","_b","error","_v","model","value","callback","$$v","editor","expression","$event","staticClass","_e","staticRenderFns","class","pan","onMouseDown","onMouseUp","_t","viewport","Point","parent","x","y","equalTo","rhs","epsilon","Math","abs","embed","toString","shape","translate","vector","Box","xy0","xy1","Array","min","max","shapes","length","Error","boxes","map","box","reduce","a","b","merge","contain","aspectRatio","xmin","height","width","ymin","xmax","ymax","other","low","high","Vector","yaml","coordinateSystem","rotate90CW","positive","rotate90CCW","normalize","multiply","scalar","angleTo","ccw","invert","add","v","Segment","end","CoordinateSystem","console","assert","undefined","start","middle","tangentInStart","tangentInEnd","at","relative","delta","intersect","intersections","push","intersects","touch","reverse","Line","pt","norm","intersection","A","a00","a01","a02","a10","a11","a12","a20","a21","a22","c","tx","d","ty","adj","det","inv","affine","embeddedInto","embedding","embedInto","into","point","xy","transform","JSON","stringify","inverse","origin","Viewport","ideal","idealCoordinateSystem","viewportCoordinateSystem","visible","focused","resize","focus","zoom","factor","center","centerBefore","centerAfter","PanZoom","observer","ResizeObserver","unpanzoom","$refs","clientWidth","window","innerWidth","clientHeight","innerHeight","refocus","mounted","$el","panzoom","observe","beforeDestroy","unobserve","e","dz","exp","dx","dy","required","type","immediate","component","surface","components","inner","onLayoutChanged","onSVGChanged","Permutation","cycles","mapping","cycle","i","fromMapping","entry","String","xor","Object","keys","find","includes","pop","image","preimage","values","FlatTriangulation","fromCycles","vertices","fromEntries","entries","vectors","halfEdge","parse","halfEdges","domain","faces","he","Number","face","sum","SaddleConnection","source","target","crossings","freeze","FlowConnection","vertical","boundary","touches","connection","FlowComponent","cylinder","perimeter","inside","layout","_l","palette","color","segment","points","Ngon","join","Face","indicator","halfEdgeConfiguration","state","labeled","_s","onClick","onMouseEnter","onMouseLeave","onMouseMove","selected","glued","coords","embedded","transformation","HalfEdgeLabel","midpoint","normal","position","x1","y1","x2","y2","atEnd","SVGArrow","endWithoutHead","PI","preventDefault","stopPropagation","$emit","apply","arguments","script","DefaultHalfEdgeConfiguration","interactions","click","enter","leave","hover","HalfEdgeComponent","ev","default","Arrow","ExtendedClickArea","SegmentComponent","SegmentLabel","style","segments","crossing","shift","line","crossingEdge","crossingLine","alongHalfEdge","ats","filter","resetCaches","ensureCaches","index","floor","patch","isHalfEdge","B","C","scenario","atouches","btouches","patchHalfEdge","every","patches","SaddleConnectionComponent","Palette","constructor","colors","seed","warn","Polygon","convexHull","p","some","hull","q","last","next","leftTo","polygon","addFace","minArea","minAreaRect","edge","edges","direction","theta","rotation","cos","sin","aligned","area","toPoints","vertex","Progress","name","steps","task","step","OperationAborted","CancellationToken","cancellationRequested","Promise","resolve","reject","aborted","setTimeout","cancelled","cancel","abort","CellLayout","cell","boundingRectArea","boundingRect","before","glues","otherPolygon","touchConsistent","boundaries","side","pending","Set","size","delete","cells","force","cache","cancellation","_progress","scores","glue","score","best","minBy","ca","cb","dc","x00","x01","x02","x10","x11","x12","x20","x21","x22","delaunay","ungluedArea","gluedArea","isArray","hasOwnProperty","packed","cell_","halfEdge_","splice","packable","segment_","screen","FlatTriangulationLayout","recompute","_","pack","assign","log","bbox","SVGExporter","cloneNode","styles","getElementsByTagName","computedStyle","tagName","unshift","document","createElement","appendChild","setAttribute","element","getComputedStyle","computed","getPropertyValue","children","dropClasses","child","removeAttribute","dropPrefixedStyles","_value","startsWith","dropInvisible","trash","forEach","_style","parentNode","removeChild","dropRedundantStyles","dropCustomAttributes","attributes","attribute","dropBrowserStyles","dropInteractiveStyles","inlineStyles","svgo","outerHTML","data","Surface","forced","hovered","run","created","relayout","async","$nextTick","exporter","onForcedChanged","onInnerChanged","forceHalfEdge","$once","unhover","relativizeOntoSegment","toPoint","dot","clientX","getBoundingClientRect","left","clientY","top","from","_run","FlatTriangulationComponent","FlowComponentComponent","SurfaceViewer","onRawChanged","parsed","message","Overlay","onCancellation","stats","VBtn","App","VApp","h","vuetify","$mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","deferred","O","result","chunkIds","priority","notFulfilled","Infinity","fulfilled","j","r","n","getter","__esModule","definition","o","defineProperty","enumerable","get","g","globalThis","Function","obj","prop","prototype","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"mappings":"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","file":"js/app.58a0c159.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',[_c('v-main',[_c('v-container',{attrs:{\"fluid\":\"\",\"fill-height\":\"\"}},[_c('overlay',{attrs:{\"cancellation\":_vm.overlay,\"progress\":_vm.progress}}),_c('surface-viewer',{attrs:{\"raw\":_vm.raw},on:{\"error\":_vm.onError,\"ok\":function () { return _vm.onError(); },\"svg\":function (svg) { return _vm.svgExport = svg; }}})],1),_c('v-dialog',{attrs:{\"fullscreen\":\"\",\"hide-overlay\":\"\",\"transition\":\"dialog-bottom-transition\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({attrs:{\"color\":_vm.error ? 'red': 'green',\"dark\":\"\",\"dense\":\"\",\"small\":\"\",\"fixed\":\"\",\"bottom\":\"\",\"right\":\"\",\"fab\":\"\"}},'v-btn',attrs,false),on),[(!_vm.error)?_c('v-icon',[_vm._v(\"mdi-pencil\")]):_c('v-icon',[_vm._v(\"mdi-alert-circle-outline\")])],1)]}}]),model:{value:(_vm.editor),callback:function ($$v) {_vm.editor=$$v},expression:\"editor\"}},[_c('v-card',[_c('v-toolbar',{attrs:{\"dark\":\"\",\"cards\":\"\",\"color\":_vm.error ? 'red' : 'green'}},[_c('v-btn',{attrs:{\"icon\":\"\",\"dark\":\"\"},on:{\"click\":function($event){_vm.editor = false}}},[_c('v-icon',[_vm._v(\"mdi-arrow-left\")])],1),_c('v-card-title',[_vm._v(\"Flat Triangulation Data\")])],1),_c('v-form',{staticClass:\"pa-6 pt-6\"},[_c('v-textarea',{staticClass:\"editor\",attrs:{\"error-messages\":_vm.error,\"auto-grow\":\"\",\"filled\":\"\",\"rows\":\"1\"},model:{value:(_vm.raw),callback:function ($$v) {_vm.raw=$$v},expression:\"raw\"}})],1)],1)],1),(!_vm.error)?_c('v-dialog',{attrs:{\"fullscreen\":\"\",\"hide-overlay\":\"\",\"transition\":\"dialog-bottom-transition\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({attrs:{\"color\":\"blue\",\"dark\":\"\",\"dense\":\"\",\"small\":\"\",\"fixed\":\"\",\"bottom\":\"\",\"left\":\"\",\"fab\":\"\"}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-camera\")])],1)]}}],null,false,4025757055),model:{value:(_vm.svg),callback:function ($$v) {_vm.svg=$$v},expression:\"svg\"}},[_c('v-card',[_c('v-toolbar',{attrs:{\"dark\":\"\",\"cards\":\"\",\"color\":\"green\"}},[_c('v-btn',{attrs:{\"icon\":\"\",\"dark\":\"\"},on:{\"click\":function($event){_vm.svg = false}}},[_c('v-icon',[_vm._v(\"mdi-arrow-left\")])],1),_c('v-card-title',[_vm._v(\"SVG Export\")])],1),_c('v-form',{staticClass:\"pa-6 pt-6\"},[_c('v-textarea',{staticClass:\"editor\",attrs:{\"auto-grow\":\"\",\"filled\":\"\",\"rows\":\"1\"},model:{value:(_vm.svgExport),callback:function ($$v) {_vm.svgExport=$$v},expression:\"svgExport\"}})],1)],1)],1):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"viewport\",class:{ pan: _vm.pan },on:{\"mousedown\":_vm.onMouseDown,\"mouseup\":_vm.onMouseUp}},[_vm._t(\"default\",null,{\"viewport\":_vm.viewport})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Vector from './Vector';\nimport Polygon from './Polygon';\n\nexport default class Point {\n  public constructor(parent: CoordinateSystem, x: Coordinate, y: Coordinate);\n  public constructor(parent: CoordinateSystem, p: Flatten.Point);\n  public constructor(parent: CoordinateSystem, x: Coordinate | Flatten.Point, y?: Coordinate) {\n    this.parent = parent;\n    if (typeof(x) === \"number\")\n      this.value = new Flatten.Point(x, y);\n    else\n      this.value = x;\n  }\n  \n  public get x() { return this.value.x; }\n  public get y() { return this.value.y; }\n  public get xy() : [Coordinate, Coordinate] { return [this.x, this.y]; }\n\n  public equalTo(rhs: Point, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return Math.abs(this.x - rhs.x) <= epsilon && Math.abs(this.y - rhs.y) <= epsilon;\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public toString(): string {\n    return `(${this.x}, ${this.y})`;\n  }\n\n  public on(shape: Polygon): boolean {\n    return shape.parent.embed(this).value.on(shape.value);\n  }\n\n  public translate(vector: Vector): Point {\n    return new Point(this.parent, this.value.translate(this.parent.embed(vector).value));\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Point;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Point from \"./Point\";\nimport Segment from './Segment';\n\nexport default class Box {\n  public constructor(parent: CoordinateSystem, box: Flatten.Box);\n  public constructor(parent: CoordinateSystem, xy0: [Coordinate, Coordinate], xy1: [Coordinate, Coordinate]);\n  public constructor(parent: CoordinateSystem, xy0: [Coordinate, Coordinate] | Flatten.Box, xy1?: [Coordinate, Coordinate]) {\n    this.parent = parent;\n\n    if (xy0 instanceof Flatten.Box) {\n      this.value = xy0;\n    } else {\n      assert(xy1 instanceof Array);\n      this.value = new Flatten.Box(Math.min(xy0[0], xy1[0]), Math.min(xy0[1], xy1[1]), Math.max(xy0[0], xy1[0]), Math.max(xy0[1], xy1[1]));\n    }\n  }\n\n  public static bbox(shapes: Array<Point|Segment>): Box {\n    if (shapes.length === 0)\n      throw Error(\"cannot create bounding box of nothing\");\n\n    const boxes = shapes.map((shape) => {\n      if (shape instanceof Point)\n        return new Box(shape.parent, [shape.value.x, shape.value.y], [shape.value.x, shape.value.y]);\n      else\n        return new Box(shape.parent, shape.value.box);\n    });\n    return boxes.reduce((a: Box, b: Box) => a.merge(b));\n  }\n\n  // Return an enlargened version of this box that has the prescribed aspect\n  // ratio (leaving one of its dimensions untouched and centering it in the\n  // other dimension.)\n  public contain(aspectRatio: number) {\n    if (this.aspectRatio < aspectRatio)\n      return new Box(this.parent, [this.value.xmin - (this.height * aspectRatio - this.width) / 2, this.value.ymin], [this.value.xmax + (this.height * aspectRatio - this.width) / 2, this.value.ymax]);\n    else\n      return new Box(this.parent, [this.value.xmin, this.value.ymin - (this.width / aspectRatio - this.height) / 2], [this.value.xmax, this.value.ymax + (this.width / aspectRatio - this.height) / 2]);\n  }\n\n  public merge(other: Box): Box {\n    return new Box(this.parent, this.value.merge(this.parent.embed(other).value));\n  }\n\n  public translate(x: Coordinate, y: Coordinate) {\n    return new Box(this.parent, [this.value.xmin + x, this.value.ymin + y], [this.value.xmax + x, this.value.ymax + y]);\n  }\n\n  public get low() {\n    return new Point(this.parent, this.value.xmin, this.value.ymin);\n  }\n\n  public get high() {\n    return new Point(this.parent, this.value.xmax, this.value.ymax);\n  }\n\n  public get aspectRatio() {\n    return this.width / this.height;\n  }\n\n  public get width() {\n    return this.value.xmax - this.value.xmin;\n  }\n\n  public get center() {\n    return new Point(this.parent, (this.value.xmin + this.value.xmax) / 2, (this.value.ymin + this.value.ymax) / 2);\n  }\n\n  public get height() {\n    return this.value.ymax - this.value.ymin;\n  }\n\n  public equalTo(rhs: Box, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return this.low.equalTo(rhs.low, epsilon) && this.high.equalTo(rhs.high, epsilon);\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Box;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem, { Coordinate } from \"./CoordinateSystem\";\nimport Point from './Point';\n\nexport interface VectorSchema {\n  x: number,\n  y: number,\n};\n\nexport default class Vector {\n  public constructor(parent: CoordinateSystem, x: Coordinate, y: Coordinate);\n  public constructor(parent: CoordinateSystem, p: Flatten.Vector);\n  public constructor(parent: CoordinateSystem, a: Point, b: Point);\n  public constructor(parent: CoordinateSystem, x: Coordinate | Flatten.Vector | Point, y?: Coordinate | Point) {\n    this.parent = parent;\n    if (typeof(x) === \"number\") {\n      assert(typeof(y) === \"number\");\n      this.value = new Flatten.Vector(x, y);\n    } else if (x instanceof Flatten.Vector) {\n      assert(y == null);\n      this.value = x;\n    } else {\n      assert(x instanceof Point);\n      assert(y instanceof Point);\n      const a = parent.embed(x);\n      const b = parent.embed(y);\n      this.value = new Flatten.Vector(a.value, b.value);\n    }\n  }\n\n  public static parse(yaml: VectorSchema, coordinateSystem: CoordinateSystem): Vector {\n    return new Vector(coordinateSystem, yaml.x, yaml.y);\n  }\n  \n  public get x() { return this.value.x; }\n  public get y() { return this.value.y; }\n  public get xy() : [Coordinate, Coordinate] { return [this.x, this.y]; }\n\n  public rotate90CW() {\n    return new Vector(this.parent, this.parent.positive ? this.value.rotate90CW(): this.value.rotate90CCW());\n  }\n\n  public rotate90CCW() {\n    return new Vector(this.parent, this.parent.positive ? this.value.rotate90CCW(): this.value.rotate90CW());\n  }\n\n  public normalize() {\n    return new Vector(this.parent, this.value.normalize());\n  }\n\n  public multiply(scalar: number) {\n    return new Vector(this.parent, this.value.multiply(scalar));\n  }\n\n  public angleTo(ccw: Vector) {\n    return this.parent.positive ? this.parent.embed(ccw).value.angleTo(this.value) : this.value.angleTo(this.parent.embed(ccw).value);\n  }\n\n  public invert() {\n    return new Vector(this.parent, this.value.invert());\n  }\n\n  public add(v: Vector) {\n    return new Vector(this.parent, this.value.add(this.parent.embed(v).value));\n  }\n\n  public equalTo(rhs: Vector, epsilon: number = 0): boolean {\n    if (this.parent === rhs.parent)\n      return Math.abs(this.x - rhs.x) <= epsilon && Math.abs(this.y - rhs.y) <= epsilon;\n    return this.parent.embed(rhs).equalTo(this);\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Vector;\n}\n\n\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Point from \"./Point\";\nimport Polygon from './Polygon';\nimport Vector from './Vector';\n\nexport default class Segment {\n  public constructor(start: Point, end: Point);\n  public constructor(parent: CoordinateSystem, value: Flatten.Segment);\n  public constructor(parent: CoordinateSystem, start: Flatten.Point, end: Flatten.Point);\n  public constructor(parent: CoordinateSystem | Point, value: Point | Flatten.Point | Flatten.Segment, end?: Flatten.Point){\n    if (!(parent instanceof CoordinateSystem)) {\n      console.assert(value instanceof Point, value);\n      ({parent, value, end} = {\n        parent: parent.parent,\n        value: parent.value,\n        end: parent.parent.embed(value as Point).value,\n      });\n    }\n\n    this.parent = parent;\n    if (end !== undefined) {\n      const start = value as Flatten.Point;\n      this.value = new Flatten.Segment(start, end);\n    } else {\n      this.value = value as Flatten.Segment;\n    }\n  }\n  \n  public get start() { return new Point(this.parent, this.value.start); }\n  public get middle() { return new Point(this.parent, this.value.middle()); }\n  public get end() { return new Point(this.parent, this.value.end); }\n  public get tangentInStart() { return new Vector(this.parent, this.value.tangentInStart()); }\n  public get tangentInEnd() { return new Vector(this.parent, this.value.tangentInEnd()); }\n\n  public at(relative: number) {\n    return this.start.translate(new Vector(this.parent, this.start, this.end).multiply(relative));\n  }\n\n  public translate(delta: Vector): Segment {\n    delta = this.parent.embed(delta);\n    return new Segment(this.parent, this.value.translate(delta.value));\n  }\n\n  // Return the points of intersection between this segment and the segments\n  // forming the boundary of the polygon. If this segment overlaps with one of\n  // the boundary segments, the end points of the overlap are included. If it\n  // touches, the point of touching is included.\n  public intersect(shape: Polygon): Point[] {\n    const intersections = shape.parent.embed(this).value.intersect(shape.value).map(value => new Point(shape.parent, value));\n    if(this.start.on(shape))\n      // TODO: Bug in flatten.\n      intersections.push(this.start);\n    if (this.end.on(shape))\n      // TODO: Bug in flatten.\n      intersections.push(this.end);\n    return intersections;\n  }\n\n  // Return whether this segment and the (filled) shape have at least one point\n  // in common.\n  public intersects(shape: Polygon): boolean {\n    return Flatten.Relations.intersect(shape.parent.embed(this).value, shape.value);\n  }\n\n  public touch(shape: Polygon): boolean {\n    return Flatten.Relations.touch(shape.parent.embed(this).value, shape.value);\n  }\n\n  public toString(): string {\n    return `((${this.value.start.x}, ${this.value.start.y}), (${this.value.end.x}, ${this.value.end.y}))`;\n  }\n\n  public get length() {\n    return this.value.length;\n  }\n\n  public equalTo(rhs: Segment, epsilon: number = 0): boolean {\n    return this.start.equalTo(rhs.start, epsilon) && this.end.equalTo(rhs.end, epsilon);\n  }\n\n  public reverse(): Segment {\n    return new Segment(this.parent, this.value.reverse());\n  }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Segment;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport Point from \"./Point\";\nimport Vector from \"./Vector\";\nimport CoordinateSystem from \"./CoordinateSystem\";\n\nexport default class Line {\n  constructor(pt: Point, norm: Vector);\n  constructor(a: Point, b: Point);\n  public constructor(pt: Point, norm: Point | Vector) {\n    this.parent = pt.parent;\n    if (norm instanceof Point)\n      this.value = new Flatten.Line(pt.value, this.parent.embed(norm).value);\n    else\n      this.value = new Flatten.Line(pt.value, this.parent.embed(norm).value);\n  }\n\n  public intersect(other: Line): Point | null {\n    const intersections = other.parent.embed(this).value.intersect(other.value).map((intersection) => new Point(other.parent, intersection));\n    if (intersections.length === 0) return null;\n    if (intersections.length !== 1) throw Error(\"not implemented: Line.intersection()\");\n    return intersections[0];\n  }\n\n  public get pt() { return new Point(this.parent, this.value.pt); }\n  public get norm() { return new Vector(this.parent, this.value.norm); }\n\n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Line;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport Point from \"./Point\";\nimport Box from \"./Box\";\nimport Vector from \"./Vector\";\nimport Segment from \"./Segment\";\nimport Line from \"./Line\";\n\nexport type Coordinate = number;\n\nexport default class CoordinateSystem {\n  public constructor(positive: boolean) {\n    this.positive = positive;\n  }\n\n  public static inverse(A: Flatten.Matrix) {\n    const [a00, a01, a02, a10, a11, a12, a20, a21, a22] = [A.a, A.c, A.tx, A.b, A.d, A.ty, 0, 0, 1];\n    const adj = [a11*a22 - a21*a12, a10*a22 - a20*a12, a10*a21 - a20*a11, a01*a22 - a21*a02, a00*a22 - a20*a02, a00*a21 - a20*a01, a01*a12 - a11*a02, a00*a12 - a10*a02, a00*a11 - a10*a01];\n    const det = a00*adj[0] - a01*adj[1] + a02*adj[2];\n    const inv = [adj[0], -adj[3], adj[6], -adj[1], adj[4], -adj[7], adj[2], -adj[5], adj[8]].map(a => a / det);\n    const affine = inv.map(a => a / inv[8]);\n    return new Flatten.Matrix(affine[0], affine[3], affine[1], affine[4], affine[2], affine[5]);\n  }\n\n  public readonly positive: boolean;\n  private embeddedInto: CoordinateSystem | null = null;\n  private embedding: Flatten.Matrix | null = null;\n\n  public embedInto(into: CoordinateSystem, embedding?: Flatten.Matrix) {\n    if (embedding === undefined) {\n      embedding = new Flatten.Matrix();\n      if (this.positive !== into.positive)\n        embedding = new Flatten.Matrix(1, 0, 0, -1);\n    }\n    if (this.embeddedInto !== null && this.embeddedInto !== into)\n        throw Error(\"not implemented: cannot have more than one embedding but this coordinate system is already embedded into another one\")\n    this.embeddedInto = into;\n    this.embedding = embedding;\n  }\n\n  public box(xy0: [Coordinate, Coordinate], xy1: [Coordinate, Coordinate]) {\n    return new Box(this, xy0, xy1);\n  }\n\n  public point(x: Coordinate, y: Coordinate) {\n    return new Point(this, x, y);\n  }\n\n  public embed(box: Box): Box;\n  public embed(point: Point): Point;\n  public embed(vector: Vector): Vector;\n  public embed(segment: Segment): Segment;\n  public embed(line: Line): Line;\n  public embed(value: Box | Point | Vector | Segment | Line) : Box | Point | Vector | Segment | Line {\n    if (value instanceof Box) {\n      let box = value as Box;\n      return new Box(this, this.embed(box.low).xy, this.embed(box.high).xy);\n    } else if (value instanceof Point) {\n      let point = value as Point;\n      while(true) {\n        if (this === point.parent)\n          return point;\n\n        if (point.parent.embeddedInto === null)\n          break;\n\n        point = new Point(point.parent.embeddedInto,\n          point.value.transform(point.parent.embedding!));\n      }\n\n      if (this.embeddedInto === null) {\n        throw Error(`point (${point.value.x}, ${point.value.y}) cannot be embedded from coordinate system ${JSON.stringify(point.parent)} into this coordinate system ${JSON.stringify(this)}; no relation between the coordinate systems could be established.`)\n      }\n\n      point = this.embeddedInto.embed(point);\n\n      return new Point(this, ...CoordinateSystem.inverse(this.embedding!).transform([point.x, point.y]));\n    } else if (value instanceof Vector) {\n      const point = this.embed(new Point(value.parent, value.x, value.y));\n      const origin = this.embed(new Point(value.parent, 0, 0));\n      return new Vector(this, point.x - origin.x, point.y - origin.y);\n    } else if (value instanceof Segment) {\n      return new Segment(this, this.embed(value.start).value, this.embed(value.end).value);\n    } else if (value instanceof Line) {\n      return new Line(this.embed(value.pt), this.embed(value.norm));\n    }\n\n    throw Error(`cannot embed this type of object into coordinate system yet`);\n  }\n}\n\n\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Box from \"./Box\";\nimport Point from \"./Point\";\n\nexport default class Viewport {\n  public constructor(ideal?: CoordinateSystem, width: number = 640, height: number = 640) {\n    this.idealCoordinateSystem = ideal || new CoordinateSystem(true);\n    if (!this.idealCoordinateSystem.positive)\n      throw new Error(\"ideal coordinate system must be positive\");\n    this.viewportCoordinateSystem = new CoordinateSystem(false);\n    this.width = width;\n    this.height = height;\n    this.visible = new Box(this.viewportCoordinateSystem, [0, 0], [width, height]);\n    this.focused = this.visible;\n\n    this.idealCoordinateSystem.embedInto(this.viewportCoordinateSystem);\n  }\n\n  // Resize the viewport while keeping the currently focused box unchanged.\n  public resize(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n\n    this.focus(this.focused);\n  }\n\n  public focus(focused: Box) {\n    this.focused = this.idealCoordinateSystem.embed(focused);\n    this.visible = this.idealCoordinateSystem.embed(this.focused.contain(this.width / this.height));\n    // We now need to embed the \"ideal\" coordinate system into the actual\n    // \"viewport\" coordinate system so that the \"visible\" box fills the (0,\n    // 0), (width, height) box.\n    this.idealCoordinateSystem.embedInto(this.viewportCoordinateSystem, new Flatten.Matrix(\n      this.width / this.visible.width, 0,\n      0, -this.height / this.visible.height,\n      -this.visible.low.x * this.width / this.visible.width,\n      this.visible.high.y * this.height / this.visible.height,\n    ));\n  }\n\n  public zoom(factor: number, center?: Point) {\n    if (center === undefined) {\n      center = this.viewport.center;\n      center = this.focused.parent.embed(center);\n\n      const width = this.focused.width / factor;\n      const height = this.focused.height / factor;\n\n      this.focus(new Box(this.focused.parent,\n        [center.x - width / 2, center.y - height / 2],\n        [center.x + width / 2, center.y + height / 2]));\n    } else {\n      center = this.idealCoordinateSystem.embed(center);\n      const centerBefore = this.viewportCoordinateSystem.embed(center);\n      this.zoom(factor);\n      const centerAfter = this.viewportCoordinateSystem.embed(center);\n      \n      this.focus(this.viewport.translate(centerAfter.x - centerBefore.x, centerAfter.y - centerBefore.y));\n    }\n  }\n\n  public embed(point: Point) : Point;\n  public embed(box: Box) : Box;\n  public embed(value: Point | Box) : Point | Box {\n    return this.viewportCoordinateSystem.embed(value as any);\n  }\n\n  public get viewport() : Box {\n    return this.viewportCoordinateSystem.embed(this.visible);\n  }\n\n  private width: number;\n  private height: number;\n  // The underlying ideal coordinate system that is stable under resizing the\n  // viewport, translating it and such.\n  public readonly idealCoordinateSystem: CoordinateSystem;\n  // Coordinates on screen, i.e., inside the viewport starting at (0, 0) in\n  // the top-left corner.\n  public readonly viewportCoordinateSystem: CoordinateSystem;\n  // The currently focused rectangle, centered in the viewport.\n  private focused: Box;\n  // The currently visible rectangle.\n  private visible: Box;\n};\n","\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport Viewport from \"../geometry/Viewport\";\nimport CoordinateSystem from \"../geometry/CoordinateSystem\";\nimport Point from \"../geometry/Point\";\nimport Box from \"../geometry/Box\";\nimport panzoom from \"pan-zoom/index.js\";\n\n@Component\nexport default class PanZoom extends Vue {\n  @Prop({required: true, type: CoordinateSystem}) coordinateSystem!: CoordinateSystem;\n  @Prop({required: true, type: Box}) focus!: Box;\n\n  private observer = new ResizeObserver(this.resize);\n  private unpanzoom = () => {};\n  protected pan = false;\n\n  private resize() {\n    this.viewport.resize(\n      Math.min((this.$refs.viewport as HTMLElement).clientWidth, window.innerWidth),\n      Math.min((this.$refs.viewport as HTMLElement).clientHeight, window.innerHeight));\n  }\n\n  @Watch(\"focus\", {immediate: true})\n  refocus() {\n    this.viewport.focus(this.focus); \n  }\n\n  mounted() {\n    this.unpanzoom = panzoom(this.$el, this.panzoom);\n    this.observer.observe(this.$el);\n    this.resize();\n  }\n\n  beforeDestroy() {\n    this.unpanzoom();\n    this.observer.unobserve(this.$el);\n  }\n\n  onMouseDown() {\n    this.pan = true;\n  }\n\n  onMouseUp() {\n    this.pan = false;\n  }\n\n  get viewport() {\n    return new Viewport(this.coordinateSystem);\n  }\n\n  private panzoom(e: any) {\n    // We either zoom or pan; mixing this is probably confusing.\n    if (e.dz !== 0) {\n      this.viewport.zoom(Math.exp(-e.dz/96), new Point(this.viewport.viewportCoordinateSystem, e.x, e.y));\n    } else {\n      this.viewport.focus(this.viewport.viewport.translate(-e.dx, -e.dy));\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PanZoom.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PanZoom.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./PanZoom.vue?vue&type=template&id=43f8a8ee&scoped=true&\"\nimport script from \"./PanZoom.vue?vue&type=script&lang=ts&\"\nexport * from \"./PanZoom.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./PanZoom.vue?vue&type=style&index=0&id=43f8a8ee&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"43f8a8ee\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('pan-zoom',{staticClass:\"surface\",attrs:{\"coordinate-system\":_vm.idealCoordinateSystem,\"focus\":_vm.focus},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar viewport = ref.viewport;\nreturn [_c('surface',{attrs:{\"viewport\":viewport,\"surface\":_vm.surface,\"components\":_vm.components,\"inner\":_vm.inner},on:{\"layout\":_vm.onLayoutChanged,\"svg\":_vm.onSVGChanged}})]}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport xor from \"lodash-es/xor\";\n\n// A permutation of T where T is something that can be safely converted to a\n// key in an object, i.e., T should probably be number or string.\nexport default class Permutation<T> {\n  public static fromCycles<T>(cycles: Array<T[]>) : Permutation<T> {\n    const mapping = [] as Array<[T, T]>;\n    for (let cycle of cycles)\n      for (let i = 0; i < cycle.length; i++)\n        mapping.push([cycle[i], cycle[(i + 1) % cycle.length]]);\n    return Permutation.fromMapping(mapping);\n  }\n\n  public static fromMapping<T>(mapping: Array<[T, T]>) : Permutation<T> {\n    return new Permutation<T>(mapping);\n  }\n\n  private constructor(mapping: Array<[T, T]>) {\n    this.mapping = {};\n    this.inverse = {};\n\n    for (let entry of mapping) {\n      if (entry[0] in this.mapping)\n        throw Error(`${entry} specified more than once in mapping domain`);\n      if (entry[1] in this.inverse)\n        throw Error(`${entry} specified more than once in mapping codomain`);\n      this.mapping[String(entry[0])] = entry[1];\n      this.inverse[String(entry[1])] = entry[0];\n    }\n\n    if (xor(Object.keys(this.mapping), Object.keys(this.inverse)).length !== 0)\n      throw Error(`domain {${Object.keys(this.mapping)}} and codomain {${Object.keys(this.inverse)}} of permutation are not identical`);\n\n    this.cycles = [];\n    for (let [a, b] of mapping) {\n      if (this.cycles.find((cycle) => cycle.includes(a)))\n        continue;\n      const cycle = [a, b];\n      while(true) {\n        const x = cycle[cycle.length - 1];\n        if (cycle[0] == x) {\n          cycle.pop();\n          break;\n        }\n        cycle.push(this.mapping[String(x)]);\n      }\n      this.cycles.push(cycle);\n    }\n  }\n\n  public image(x: T) {\n    return this.mapping[String(x)];\n  }\n\n  public preimage(x: T) {\n    return this.inverse[String(x)];\n  }\n\n  public get domain() : T[] {\n    return Object.values(this.mapping);\n  }\n\n  public readonly cycles : Array<T[]>;\n\n  private readonly mapping : { [key: string]: T }; \n  private readonly inverse : { [key: string]: T };\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport xor from \"lodash-es/xor\";\n\nimport HalfEdge from \"./HalfEdge\";\nimport Permutation from \"./Permutation\";\n\nimport Vector, { VectorSchema } from \"../Vector\";\nimport Point from \"../Point\";\nimport CoordinateSystem from '../CoordinateSystem';\n\nexport interface FlatTriangulationSchema {\n  vertices: Array<HalfEdge[]>,\n  vectors: { [key: number]: VectorSchema }\n};\n\nexport default class FlatTriangulation {\n  public static parse(yaml: FlatTriangulationSchema, coordinateSystem: CoordinateSystem) : FlatTriangulation {\n    return new FlatTriangulation(\n      Permutation.fromCycles(yaml.vertices),\n      Object.fromEntries(Object.entries(yaml.vectors).map(([halfEdge, vector]) => [halfEdge, Vector.parse(vector, coordinateSystem)]))\n    );\n  }\n\n  private constructor(vertices: Permutation<HalfEdge>, vectors: {[key: string]: Vector}) {\n    this.vertices = vertices;\n    this.halfEdges = vertices.domain;\n    this.faces = Permutation.fromMapping(this.halfEdges.map((he) => [-this.vertices.image(he), he]));\n\n    this.vectors = vectors;\n\n    if (xor(\n      [...Object.keys(this.vectors), ...Object.keys(this.vectors).map((he) => String(-Number(he)))],\n      this.halfEdges.map((he) => String(he))\n    ).length !== 0)\n      throw Error(`Provided vectors {${Object.keys(this.vectors)}} and present half edges {${this.halfEdges}} do not coincide.`);\n\n    const coordinateSystem = this.vectors['1'].parent;\n\n    for (const face of this.faces.cycles) {\n      const sum = face.reduce((sum, he) => sum.translate(this.vector(he)), new Point(coordinateSystem, 0, 0));\n      if (!sum.equalTo(new Point(coordinateSystem, 0, 0), 1e-6))\n        throw Error(`Face ${face} is not closed. Going around the face gives (${sum.x}, ${sum.y}) but should be zero.`);\n      // TODO: Wiggle the half edges to a place to make the faces closed in double coordinates.\n    }\n  }\n\n  public vector(halfEdge: HalfEdge): Vector {\n    return this.vectors[halfEdge] || this.vectors[-halfEdge].invert();\n  }\n\n  public readonly vertices: Permutation<HalfEdge>;\n  public readonly halfEdges : HalfEdge[];\n  public readonly faces : Permutation<HalfEdge>;\n  private readonly vectors : {[key: string]: Vector };\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport HalfEdge, { HalfEdgeSchema } from \"./HalfEdge\";\nimport Vector, { VectorSchema } from \"../Vector\";\nimport CoordinateSystem from '../CoordinateSystem';\n\nexport interface SaddleConnectionSchema {\n  source: HalfEdgeSchema,\n  target: HalfEdgeSchema,\n  vector: VectorSchema,\n  crossings: {\n    halfEdge: number,\n    at: number,\n  }[]\n};\n\nexport default class SaddleConnection {\n  public static parse(yaml: SaddleConnectionSchema, coordinateSystem: CoordinateSystem): SaddleConnection {\n    return new SaddleConnection(yaml.source, yaml.target, Vector.parse(yaml.vector, coordinateSystem), yaml.crossings);\n  }\n\n  private constructor(source: HalfEdge, target: HalfEdge, vector: Vector, crossings: {halfEdge: HalfEdge, at: number}[]) {\n    this.source = source;\n    this.target = target;\n    this.vector = vector;\n    this.crossings = Object.freeze(crossings);\n  }\n\n  public readonly source: HalfEdge;\n  public readonly target: HalfEdge;\n  public readonly vector: Vector;\n  // The sequence of half edges crossed with approximate\n  // relative point of crossing in [0, 1].\n  public readonly crossings: readonly {halfEdge: HalfEdge, at: number}[];\n}\n\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport SaddleConnection, { SaddleConnectionSchema } from \"./SaddleConnection\";\nimport CoordinateSystem from '../CoordinateSystem';\nimport HalfEdge from \"./HalfEdge\";\n\nexport interface Touch {\n  halfEdge: HalfEdge;\n  index: number;\n}\n\nexport interface FlowConnectionSchema extends SaddleConnectionSchema {\n  vertical: boolean;\n  boundary: boolean;\n  touches: Touch[];\n}\n\nexport default class FlowConnection {\n  public static parse(yaml: FlowConnectionSchema, coordinateSystem: CoordinateSystem): FlowConnection {\n    return new FlowConnection(SaddleConnection.parse(yaml, coordinateSystem), yaml.vertical, yaml.boundary, yaml.touches);\n  }\n\n  private constructor(connection: SaddleConnection, vertical: boolean, boundary: boolean, touches: Touch[]) {\n    this.connection = connection;\n    this.vertical = vertical;\n    this.boundary = boundary;\n    this.touches = Object.freeze(touches);\n  }\n\n  public readonly connection: SaddleConnection;\n  public readonly vertical: boolean;\n  public readonly boundary: boolean;\n\n  // The sequence of half edges crossed/touched (most half edges show up in\n  // pairs) and the order of this crossing/touching in comparison to all the\n  // others of this component on that half edge. Typically, starts with\n  // [source half edge, 0], then the first [half edge crossed, 0] if this is\n  // the right-most crossing of that half edge, then [-half edge crossed,\n  // 0], ... until the [target half edge, 0].\n  public readonly touches: readonly Touch[];\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport CoordinateSystem from '../CoordinateSystem';\nimport FlowConnection, { FlowConnectionSchema } from \"./FlowConnection\";\nimport HalfEdge, { HalfEdgeSchema } from './HalfEdge';\n\nexport default class FlowComponent {\n  public static parse(yaml: {\n    cylinder: boolean,\n    perimeter: FlowConnectionSchema[],\n    inside: HalfEdgeSchema[],\n  }, coordinateSystem: CoordinateSystem) : FlowComponent {\n    return new FlowComponent(yaml.cylinder, yaml.perimeter.map(connection => FlowConnection.parse(connection, coordinateSystem)), yaml.inside);\n  }\n\n  private constructor(cylinder: boolean, perimeter: FlowConnection[], inside: HalfEdge[]) {\n    this.cylinder = cylinder;\n    this.perimeter = perimeter;\n    this.inside = inside;\n  }\n\n  public readonly cylinder: boolean;\n  public readonly perimeter: FlowConnection[];\n  public readonly inside: HalfEdge[];\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('svg',{ref:\"svg\",attrs:{\"width\":_vm.viewport.width,\"height\":_vm.viewport.height}},[(_vm.layout != null)?_c('g',_vm._l((_vm.components),function(component,i){return _c('flow-component-component',{key:i,attrs:{\"color\":_vm.palette.color(i),\"component\":component,\"layout\":_vm.layout,\"surface\":_vm.surface}})}),1):_vm._e(),(_vm.layout != null)?_c('flat-triangulation-component',{attrs:{\"surface\":_vm.layout}}):_vm._e()],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"FlatTriangulation\"},[_c('g',_vm._l((_vm.faces),function(face,i){return _c('face',{key:i,attrs:{\"vertices\":face}})}),1),_c('g',_vm._l((_vm.halfEdges),function(halfEdge){return _c('half-edge-component',{key:halfEdge,class:{ inner: _vm.surface.layout(halfEdge).inner },attrs:{\"segment\":_vm.surface.layout(halfEdge).segment,\"half-edge\":halfEdge}})}),1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ngon',{attrs:{\"vertices\":_vm.vertices}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('polygon',{attrs:{\"points\":_vm.points}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\nimport { Component, Inject, Prop, Vue } from \"vue-property-decorator\";\n\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class Ngon extends Vue {\n  @Prop({ required: true, type: Array }) vertices!: Point[];\n\n  get points() {\n    return this.vertices.map((xy) => {\n      xy = this.svg(xy); \n      return `${xy.x},${xy.y}`;\n    }).join(\",\");\n  }\n\n  @Inject()\n  svg!: (xy: Point) => Point;\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Ngon.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Ngon.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Ngon.vue?vue&type=template&id=30284d09&\"\nimport script from \"./Ngon.vue?vue&type=script&lang=ts&\"\nexport * from \"./Ngon.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\n\nimport Point from \"@/geometry/Point\";\nimport Ngon from \"./svg/Ngon.vue\";\n\n@Component({\n  components: { Ngon }\n})\nexport default class Face extends Vue {\n  @Prop({ required: true, type: Array }) vertices!: Point[];\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Face.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Face.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Face.vue?vue&type=template&id=efce637c&scoped=true&\"\nimport script from \"./Face.vue?vue&type=script&lang=ts&\"\nexport * from \"./Face.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Face.vue?vue&type=style&index=0&id=efce637c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"efce637c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',[(_vm.indicator)?_c('arrow',{staticClass:\"indicator\",attrs:{\"segment\":_vm.indicator}}):_vm._e(),(_vm.halfEdgeConfiguration(_vm.halfEdge).state.labeled || true)?_c('segment-label',{attrs:{\"at\":_vm.segment}},[_vm._v(_vm._s(_vm.halfEdge))]):_vm._e(),_c('extended-click-area',{on:{\"click\":_vm.onClick,\"mouseenter\":_vm.onMouseEnter,\"mouseleave\":_vm.onMouseLeave,\"mousemove\":_vm.onMouseMove}},[_c('segment-component',{class:{ selected: _vm.selected, glued: _vm.glued },attrs:{\"segment\":_vm.segment}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('line',{attrs:{\"x1\":_vm.coords[0],\"y1\":_vm.coords[1],\"x2\":_vm.coords[2],\"y2\":_vm.coords[3]}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\nimport { Component, Inject, Prop, Vue } from \"vue-property-decorator\";\n\nimport Segmnt from \"@/geometry/Segment\";\n\n@Component\nexport default class Segment extends Vue {\n  @Prop({ required: true, type: Object }) segment!: Segmnt;\n\n  // For performance reasons we compute all coordinates at once since this\n  // gets called a lot.\n  get coords() {\n    const embedded = this.svg(this.segment);\n    return [embedded.start.x, embedded.start.y, embedded.end.x, embedded.end.y];\n  }\n\n  @Inject()\n  svg!: (s: Segmnt) => Segmnt;\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Segment.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Segment.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Segment.vue?vue&type=template&id=6290d963&\"\nimport script from \"./Segment.vue?vue&type=script&lang=ts&\"\nexport * from \"./Segment.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{attrs:{\"transform\":_vm.transformation}},[_c('text',[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nimport { Vue, Component, Inject, Prop } from \"vue-property-decorator\";\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class HalfEdgeLabel extends Vue {\n\t@Prop({required: true, type: Object}) at!: Segment;\n\n\tget position() {\n\t\tconst midpoint = this.at.middle;\n\t\tlet normal = this.svg(this.at.tangentInStart.rotate90CCW()).normalize();\n\t\treturn this.svg(midpoint).translate(normal.multiply(12));\n\t}\n\n\tget transformation() {\n\t\treturn `translate(${this.position.x} ${this.position.y}) translate(6 4)`;\n\t}\n\n  @Inject()\n  svg!: ((xy: Point) => Point) & ((xy: Vector) => Vector);\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SegmentLabel.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SegmentLabel.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SegmentLabel.vue?vue&type=template&id=03911908&scoped=true&\"\nimport script from \"./SegmentLabel.vue?vue&type=script&lang=ts&\"\nexport * from \"./SegmentLabel.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SegmentLabel.vue?vue&type=style&index=0&id=03911908&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"03911908\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"arrow\"},[_c('line',{attrs:{\"x1\":_vm.x1,\"y1\":_vm.y1,\"x2\":_vm.x2,\"y2\":_vm.y2}}),_c('path',{attrs:{\"d\":\"M 0 -3 L 12 0 L 0 3 z\",\"transform\":_vm.atEnd,\"stroke-width\":\"0\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\nimport { Prop, Vue, Component, Inject } from \"vue-property-decorator\";\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport Point from \"@/geometry/Point\";\n\n@Component\nexport default class SVGArrow extends Vue {\n\t@Prop({required: true, type: Object}) segment!: Segment;\n\n  get x1() {\n    return this.svg(this.segment.start).x;\n  }\n\n  get y1() {\n    return this.svg(this.segment.start).y;\n  }\n\n  get endWithoutHead() {\n    return this.svg(this.segment.end).translate(this.svg(this.segment.tangentInEnd).normalize().multiply(12));\n  }\n\n  get x2() {\n    return this.svg(this.endWithoutHead).x;\n  }\n\n  get y2() {\n    return this.svg(this.endWithoutHead).y;\n  }\n\n\tget atEnd() {\n    return `translate(${this.x2} ${this.y2}) rotate(${-this.segment.tangentInStart.angleTo(new Vector(this.segment.parent, 1, 0))*360 / (2*Math.PI)} 0 0)`;\n\t}\n\n  @Inject()\n  svg!: ((xy: Point) => Point) & ((xy: Vector) => Vector);\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Arrow.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Arrow.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Arrow.vue?vue&type=template&id=4e3f5919&scoped=true&\"\nimport script from \"./Arrow.vue?vue&type=script&lang=ts&\"\nexport * from \"./Arrow.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Arrow.vue?vue&type=style&index=0&id=4e3f5919&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4e3f5919\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{staticClass:\"extended-click-area\",on:{\"mousedown\":function($event){$event.preventDefault();$event.stopPropagation();return (function (e) { return _vm.$emit('mousedown', e); }).apply(null, arguments)},\"click\":function (e) { return _vm.$emit('click', e); },\"mouseenter\":function (e) { return _vm.$emit('mouseenter', e); },\"mouseleave\":function (e) { return _vm.$emit('mouseleave', e); },\"mousemove\":function (e) { return _vm.$emit('mousemove', e); }}},[_vm._t(\"default\"),_c('g',{staticClass:\"extension\"},[_vm._t(\"default\")],2)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./ExtendedClickArea.vue?vue&type=template&id=7941a33e&scoped=true&\"\nvar script = {}\nimport style0 from \"./ExtendedClickArea.vue?vue&type=style&index=0&id=7941a33e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7941a33e\",\n  null\n  \n)\n\nexport default component.exports","import Segment from \"@/geometry/Segment\";\n\nexport interface IHalfEdgeConfiguration {\n  interactions: {\n    click: (ev: MouseEvent, segment: Segment) => void,\n    enter: (ev: MouseEvent, segment: Segment) => void,\n    leave: (ev: MouseEvent, segment: Segment) => void,\n    hover: (ev: MouseEvent, segment: Segment) => void,\n  },\n  state: {\n    selected: boolean,\n    glued: boolean,\n    labeled: boolean,\n    indicator: number | null,\n  },\n};\n\nexport const DefaultHalfEdgeConfiguration: IHalfEdgeConfiguration = {\n  interactions: {\n    click: () => {},\n    enter: () => {},\n    leave: () => {},\n    hover: () => {},\n  },\n  state: {\n    selected: false,\n    glued: false,\n    labeled: false,\n    indicator: null,\n  }\n};\n","\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Inject, Vue } from \"vue-property-decorator\";\n\nimport Segment from \"@/geometry/Segment\";\nimport Vector from \"@/geometry/Vector\";\nimport SegmentComponent from \"./svg/Segment.vue\";\nimport HalfEdge from \"@/geometry/triangulation/HalfEdge\";\nimport SegmentLabel from \"./svg/SegmentLabel.vue\";\nimport Arrow from \"./svg/Arrow.vue\";\n\nimport ExtendedClickArea from \"./svg/ExtendedClickArea.vue\";\nimport { IHalfEdgeConfiguration, DefaultHalfEdgeConfiguration } from \"./HalfEdgeConfiguration\";\n\n@Component({\n  components: { Arrow, ExtendedClickArea, SegmentComponent, SegmentLabel },\n})\nexport default class HalfEdgeComponent extends Vue {\n  @Prop({required: true, type: Number}) halfEdge!: HalfEdge;\n  // TODO: We should compute the segment here from the layout object instead.\n  @Prop({required: true, type: Object}) segment!: Segment;\n\n  onClick(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.click(ev, this.segment);\n  }\n\n  onMouseEnter(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.enter(ev, this.segment);\n  }\n\n  onMouseLeave(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.leave(ev, this.segment);\n  }\n\n  onMouseMove(ev: MouseEvent) {\n    this.halfEdgeConfiguration(this.halfEdge).interactions.hover(ev, this.segment);\n  }\n\n  get selected() {\n    return this.halfEdgeConfiguration(this.halfEdge).state.selected;\n  }\n\n  get glued() {\n    return this.halfEdgeConfiguration(this.halfEdge).state.glued;\n  }\n\n\tget indicator() {\n    let indicator = this.halfEdgeConfiguration(this.halfEdge).state.indicator;\n    if (indicator) {\n\t\t  const end = this.segment.at(indicator);\n\t\t  const start = end.translate(this.svg(this.segment.tangentInStart.rotate90CCW()).normalize().multiply(10));\n      return new Segment(start, end);\n    }\n\t}\n\n  @Inject({ default: () => DefaultHalfEdgeConfiguration })\n  halfEdgeConfiguration!: (halfEdge: HalfEdge) => IHalfEdgeConfiguration;\n\n  @Inject()\n  svg!: (xy: Vector) => Vector;\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HalfEdge.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HalfEdge.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./HalfEdge.vue?vue&type=template&id=d533d4e2&scoped=true&\"\nimport script from \"./HalfEdge.vue?vue&type=script&lang=ts&\"\nexport * from \"./HalfEdge.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./HalfEdge.vue?vue&type=style&index=0&id=d533d4e2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d533d4e2\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Vue, Component, Prop } from \"vue-property-decorator\";\nimport Face from \"./Face.vue\";\nimport HalfEdgeComponent from \"./HalfEdge.vue\";\nimport FlatTriangulationLayout from \"../geometry/layout/FlatTriangulationLayout\";\n\n@Component({\n  components: {\n    Face,\n    HalfEdgeComponent,\n  }\n})\nexport default class FlatTriangulation extends Vue {\n  @Prop({required: true, type: Object}) surface!: FlatTriangulationLayout;\n\n  get halfEdges() {\n    return this.surface.surface.halfEdges;\n  }\n\n  get faces() {\n    return this.surface.surface.faces.cycles.map((face) => face.map((he) => this.surface!.layout(he).segment.end)) as any;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlatTriangulation.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlatTriangulation.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FlatTriangulation.vue?vue&type=template&id=52118882&\"\nimport script from \"./FlatTriangulation.vue?vue&type=script&lang=ts&\"\nexport * from \"./FlatTriangulation.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FlatTriangulation.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',[_c('g',{style:({ '--color': _vm.color })},_vm._l((_vm.patches),function(vertices,i){return _c('ngon',{key:i,attrs:{\"vertices\":vertices}})}),1),_c('g',{staticClass:\"boundary\"},_vm._l((_vm.perimeter),function(connection,i){return _c('saddle-connection-component',{key:i,attrs:{\"connection\":connection,\"layout\":_vm.layout}})}),1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',{style:({ '--color': _vm.color })},_vm._l((_vm.segments),function(segment,i){return _c('segment-component',{key:i,attrs:{\"segment\":segment}})}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nimport FlatTriangulationLayout from '@/geometry/layout/FlatTriangulationLayout';\nimport  { Vue, Component, Prop } from \"vue-property-decorator\";\nimport SaddleConnectionData from \"../geometry/triangulation/SaddleConnection\";\nimport SegmentComponent from \"./svg/Segment.vue\";\nimport Segment from \"../geometry/Segment\";\nimport Point from \"../geometry/Point\";\nimport Line from \"../geometry/Line\";\nimport Vector from \"../geometry/Vector\";\n\n@Component({\n  components: {\n    SegmentComponent,\n  }\n})\nexport default class FlowComponent extends Vue {\n  @Prop({ required: true }) connection!: SaddleConnectionData;\n  @Prop({ required: true }) layout!: FlatTriangulationLayout;\n  @Prop({ required: false, type: String, default:\"orange\" }) color!: string;\n\n  get segments(): Segment[] {\n    const segments = [];\n\n    const vector = this.connection.vector;\n    const crossings = [...this.connection.crossings];\n\n    let start = this.layout.layout(this.connection.source).segment.start;\n    const end = crossings.length > 0 ? this.layout.layout(this.connection.target).segment.start : this.layout.layout(this.connection.source).segment.end;\n\n    // TODO: Use at() instead of halfEdge() to construct the point of intersection.\n    while(crossings.length) {\n\t\t  const crossing = crossings.shift()!;\n      if (this.layout.layout(crossing.halfEdge).inner)\n        continue;\n\n      // Since we are crossing an outer half edge, we compute the intersection\n      // of the saddle connection ray with it and add it to segments.\n      const line = new Line(start, start.translate(vector));\n      const crossingEdge = this.layout.layout(crossing.halfEdge).segment;\n      const crossingLine = new Line(crossingEdge.start, crossingEdge.end);\n      const intersection = line.intersect(crossingLine);\n      if (intersection === null) {\n        throw Error(\"saddle connection must intersect every crossing\");\n      }\n      segments.push(new Segment(start, intersection));\n\t\t  \n      // Now, we move the intersection point to the corresponding half-edge\n      // and repeat.\n      const alongHalfEdge = new Vector(intersection.parent, this.layout.layout(crossing.halfEdge).segment.start, intersection as Point);\n      start = this.layout.layout(-crossing.halfEdge).segment.end.translate(alongHalfEdge);\n    }\n\n    segments.push(new Segment(start, end));\n    \n    return segments;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SaddleConnection.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SaddleConnection.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SaddleConnection.vue?vue&type=template&id=18dfc604&scoped=true&\"\nimport script from \"./SaddleConnection.vue?vue&type=script&lang=ts&\"\nexport * from \"./SaddleConnection.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SaddleConnection.vue?vue&type=style&index=0&id=18dfc604&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"18dfc604\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport  { Vue, Component, Prop, Watch } from \"vue-property-decorator\";\nimport FlowComponentData from \"../geometry/triangulation/FlowComponent\";\nimport { Touch } from \"../geometry/triangulation/FlowConnection\";\nimport SaddleConnectionComponent from \"./SaddleConnection.vue\";\nimport FlatTriangulationLayout from \"../geometry/layout/FlatTriangulationLayout\";\nimport Ngon from \"./svg/Ngon.vue\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\nimport Point from \"../geometry/Point\";\nimport FlatTriangulation from \"../geometry/triangulation/FlatTriangulation\";\n\n@Component({\n  components: {\n    SaddleConnectionComponent,\n    Ngon,\n  },\n})\nexport default class FlowComponent extends Vue {\n  @Prop({ required: true }) component!: FlowComponentData;\n  @Prop({ required: true }) layout!: FlatTriangulationLayout;\n  @Prop({ required: true }) surface!: FlatTriangulation;\n  @Prop({ required: false, type: String, default:\"orange\" }) color!: string;\n\n  ats!: {[key: number]: number[]};\n  // Maps a half edge to the touches on that half edge in order.\n  touches!: {[key: number]: Touch[]};\n\n  get perimeter() {\n    let perimeter = this.component.perimeter;\n    if (this.component.cylinder)\n      // For cylinders do not show the connections at the top & bottom of the cylinder.\n      perimeter = perimeter.filter((connection) => connection.vertical);\n    else\n      // For minimal/undetermined components, do not show the inner structure of the component.\n      perimeter = perimeter.filter((connection) => connection.boundary);\n\n    return perimeter.map((connection) => connection.connection);\n  }\n\n  @Watch(\"layout\", { immediate: true })\n  resetCaches() {\n    this.ats = undefined as any;\n    this.touches = undefined as any;\n    this.ensureCaches();\n  }\n\n  ensureCaches() {\n    if (this.touches == null) {\n      this.touches = {};\n      for (const halfEdge of this.surface.halfEdges)\n        this.touches[halfEdge] = [];\n\n      for (const connection of this.component.perimeter) {\n        for (const touch of connection.touches) {\n          this.touches[touch.halfEdge][touch.index] = touch;\n        }\n      }\n    }\n    if (this.ats == null) {\n      this.ats = {};\n      for (const connection of this.component.perimeter) {\n        for (let i = 0; i < connection.touches.length; i++) {\n          const touch = connection.touches[i];\n          let at = 0;\n          if (i != 0 && i != connection.touches.length - 1) {\n            at = connection.connection.crossings[Math.floor((i - 1) / 2)].at;\n            if (i % 2 == 0)\n              at = 1 - at;\n          }\n          if (this.ats[touch.halfEdge] === undefined) this.ats[touch.halfEdge] = [];\n          this.ats[touch.halfEdge][touch.index] = at;\n        }\n      }\n    }\n  }\n\n  // Return the relative length in [0, 1] where `touch` intersects its half edge.\n  private at(touch: Touch): number {\n    console.assert(this.ats != null);\n    return this.ats[touch.halfEdge][touch.index];\n  }\n\n  // Return the triangle [A, B, C] completing the two touches `a`, `b`.\n  private patch(a: Touch, b: Touch): Point[] | null {\n    // Given `at` in [0, 1] returns the actual point on `halfEdge` that is that far on `halfEdge`.\n    const layout = (halfEdge: HalfEdge, at: number) => this.layout.layout(halfEdge).segment.at(at);\n\n    const isHalfEdge = a.halfEdge === -b.halfEdge;\n\n    const A = layout(a.halfEdge, this.at(a));\n    let B = isHalfEdge ? layout(a.halfEdge, 1) : layout(b.halfEdge, this.at(b));\n    let C = B;\n\n    let scenario = \"undefined\";\n\n    if (isHalfEdge) {\n      console.assert(this.at(a) === 0, \"Edge-parallel connection must start at vertex.\")\n      console.assert(this.at(b) === 0, \"Edge-parallel connection must end at vertex.\");\n    } else {\n      console.assert(a.halfEdge !== b.halfEdge, `Saddle Connection cannot cross the half edge ${a.halfEdge} twice in a row.`);\n    }\n\n    const atouches = this.touches[a.halfEdge];\n    const btouches = this.touches[b.halfEdge];\n\n    if (isHalfEdge) {\n      return null;\n    } else {\n      if (b.index === btouches.length - 1) {\n        if (this.at(b) === 1) {\n          // The vertex B of the patch is an actual vertex of the triangulation. We will search for C on A's half edge.\n\n          // Search for C on A's half edge.\n          console.assert(this.at(a) !== 0);\n          if (a.index === 0) {\n            // Everything next to A is part of this patch.\n            console.assert(this.at(a) !== 0);\n            C = layout(a.halfEdge, 0);\n          } else {\n            C = layout(a.halfEdge, this.at(atouches[a.index - 1]));\n          }\n        } else {\n          // Everything next to B is part of this patch.\n          scenario = \"remaining face\";\n          C = layout(b.halfEdge, 1);\n          if (this.at(b) === 0)\n            return null;\n        }\n      } else {\n        if (this.at(b) === this.at(btouches[b.index + 1])) {\n          // The vertex B of this patch is a vertex of the component.\n          console.assert(this.at(b) === 0 || this.at(b) === 1, \"Vertices of components must be aligned with the vertices of the triangulation.\");\n\n          // Search for C on A's half edge.\n          console.assert(this.at(a) !== 0);\n          if (a.index === 0) {\n            // Everything next to A is part of this patch.\n            console.assert(this.at(a) !== 0);\n            // TODO: Is this always taken care of by something else?\n            C = layout(a.halfEdge, 0);\n            return null;\n          } else {\n            // TODO: Is this always taken care of by something else?\n            C = layout(a.halfEdge, this.at(atouches[a.index - 1]));\n            return null;\n          }\n        } else {\n          console.assert(this.at(btouches[b.index + 1]) > this.at(b), `Touches are not ordered correctly on half edge ${b.halfEdge}. The ${btouches[b.index + 1].index}th touch at ${this.at(btouches[b.index + 1])} should not be after the ${b.index}th touch at ${this.at(b)}.`);\n          C = layout(b.halfEdge, this.at(btouches[b.index + 1]));\n        }\n      }\n    }\n\n    console.assert(!A.equalTo(B), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice A == B, i.e., ${A.toString()} == ${B.toString()}.`);\n    console.assert(!A.equalTo(C), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice A == C, i.e., ${A.toString()} == ${C.toString()}.`);\n    console.assert(!B.equalTo(C), `Patch of kind '${scenario}' coming from the touches (${a.halfEdge}, ${a.index}) at ${this.at(a)} and (${b.halfEdge}, ${b.index}) at ${this.at(b)} has the same point twice B == C, i.e., ${B.toString()} == ${C.toString()}.`);\n\n    return [A, B, C];\n  }\n\n  private patchHalfEdge(halfEdge: HalfEdge): Point[] | null {\n    // Given `at` in [0, 1] returns the actual point on `halfEdge` that is that far on `halfEdge`.\n    const layout = (halfEdge: HalfEdge, at: number) => this.layout.layout(halfEdge).segment.at(at);\n\n    const face = [halfEdge, this.surface.faces.image(halfEdge), this.surface.faces.preimage(halfEdge)];\n\n    const A = layout(halfEdge, 0);\n    const B = layout(halfEdge, 1);\n    let C = B;\n    let scenario = \"undefined\";\n\n    // Search for the third point of the patch on the following half edge in the face.\n    let touches = this.touches[face[1]]\n    if (touches.length === 0) {\n      // Since nothing intersects the following half edge in this face, this\n      // patch is the entire face.\n      scenario = \"entire face\";\n      C = layout(face[1], 1);\n      if (face[0] !== Math.min(...face))\n        return null;\n    } else if (this.at(touches[0]) === 0) {\n      // Something starts at the vertex joining this half edge with the\n      // following half edge...\n      touches = this.touches[-face[2]];\n      if (touches.every((touch) => this.at(touch) === 0 || this.at(touch) === 1)) {\n        // ...it is just the following half edge itself.\n        scenario = \"entire face 2\";\n        // TODO: Is this always taken care of by something else?\n        C = layout(face[1], 1);\n        if (face[0] !== Math.min(...face))\n          return null;\n      } else {\n        // It's another connection. So the patch ends at the beginning of the\n        // next half edge, none of that half edge is in the patch, i.e., the\n        // third point of the patch must be on the other half edge of this\n        // face.\n        scenario = \"on previous half edge\";\n        for (const touch of touches) {\n          if (this.at(touch) !== 0) {\n            // TODO: Is this always taken care of by something else?\n            C = layout(face[2], 1 - this.at(touch));\n            return null;\n            break;\n          }\n        }\n      }\n    } else {\n      scenario = \"on following half edge\";\n      C = layout(face[1], this.at(touches[0]));\n    }\n\n    console.assert(!A.equalTo(B), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice A == B, i.e., ${A.toString()} == ${B.toString()}.`);\n    console.assert(!A.equalTo(C), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice A == C, i.e., ${A.toString()} == ${C.toString()}.`);\n    console.assert(!B.equalTo(C), `Patch of kind '${scenario}' coming from the half edge ${halfEdge} has the same point twice B == C, i.e., ${B.toString()} == ${C.toString()}.`);\n\n    return [A, B, C];\n  }\n\n  get patches() {\n    let /* TODO const */ patches = [];\n\n    for (const connection of this.component.perimeter) {\n      for (let i = 0; i < connection.touches.length; i+=2) {\n        const patch = this.patch(connection.touches[i], connection.touches[i + 1])\n        if (patch !== null)\n          patches.push(patch);\n      }\n    }\n\n    for (const inside of this.component.inside) {\n      const patch = this.patchHalfEdge(inside);\n      if (patch != null)\n        patches.push(patch);\n    }\n\n    return patches;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlowComponent.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FlowComponent.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FlowComponent.vue?vue&type=template&id=622cb8ef&scoped=true&\"\nimport script from \"./FlowComponent.vue?vue&type=script&lang=ts&\"\nexport * from \"./FlowComponent.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FlowComponent.vue?vue&type=style&index=0&id=622cb8ef&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"622cb8ef\",\n  null\n  \n)\n\nexport default component.exports","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport iwanthue from \"iwanthue\";\n\nexport default class Palette {\n  constructor(colors: number = 2) {\n    // TODO: Typings in iwanthue are wrong.\n    this.palette = iwanthue(colors >= 2 ? colors : 2, { seed: 1337 as any });\n  }\n\n  color(i: number) {\n    if (i >= this.palette.length)\n      console.warn(\"Color outside of palette bounds requested.\");\n    return this.palette[i % this.palette.length];\n  }\n\n  private readonly palette;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\n\nimport Flatten from \"@flatten-js/core\";\n\nimport CoordinateSystem from \"./CoordinateSystem\";\nimport Point from \"./Point\";\n\nexport default class Polygon {\n  public constructor(parent: CoordinateSystem, value: Flatten.Polygon) {\n    this.parent = parent;\n    this.value = value;\n  }\n\n  public get convexHull(): Polygon {\n    return Polygon.convexHull(this.vertices);\n  }\n\n  // Compute the convex hull of the points (using the slow Jarvis march\n  // algorithm.)\n  public static convexHull(points: Point[]): Polygon {\n    assert(points.length !== 0);\n\n    const coordinateSystem = points[0].parent;\n\n    const vertices = points.map((p) => coordinateSystem.embed(p).value);\n\n    assert(vertices.some((p) => !p.equalTo(vertices[0])));\n\n    const hull = [vertices.reduce((p, q) => {\n      if (p.x < q.x)\n        return p;\n      if (p.x > q.x)\n        return q\n      if (p.y < q.y)\n        return p;\n      return q;\n    })];\n\n    do {\n      const last = hull[hull.length - 1];\n      let next = vertices[0].equalTo(last) ? vertices[1] : vertices[0];\n      for (let p of vertices) {\n        if (p.leftTo(new Flatten.Line(last, next)))\n          next = p;\n      }\n      hull.push(next);\n      // TODO: This is numerically too unstable (and hangs sometimes.)\n      if (hull.length > vertices.length + 1) {\n        console.error(\"Convex Hull incorrect\");\n        break;\n      }\n    } while(!hull[hull.length - 1].equalTo(hull[0]));\n\n    hull.pop();\n\n    const polygon = new Flatten.Polygon();\n    polygon.addFace(hull);\n    return new Polygon(coordinateSystem, polygon);\n  }\n\n  // Return a bounding rectangle of minimal area. (The rectangle might not be\n  // axis-aligned.)\n  public get boundingRect(): Polygon {\n    const hull = this.convexHull;\n\n    let minArea = 1./0.;\n    let minAreaRect = null;\n\n    // Algorithm: The minimal bounding rect of a convex polygon must be aligned to one of its sides.\n    for (const edge of hull.value.edges) {\n      // Rotate such that the edge is horizontal.\n      const segment: Flatten.Segment = edge.shape;\n      const direction = segment.tangentInStart();\n      const theta = new Flatten.Vector(1, 0).angleTo(direction);\n      const rotation = new Flatten.Matrix(\n        Math.cos(-theta), -Math.sin(-theta),\n        Math.sin(-theta), Math.cos(-theta),\n      );\n      const aligned = hull.value.transform(rotation);\n\n      // Compute the area of this bounding box.\n      const area = aligned.area();\n\n      if (area < minArea) {\n        minArea = area;\n\n        // Rotate the box back.\n        minAreaRect = new Polygon(this.parent, new Flatten.Polygon(aligned.box.toPoints()).transform(CoordinateSystem.inverse(rotation)));\n      }\n    }\n\n    return minAreaRect!;\n  }\n\n  public get vertices(): Point[] {\n    return this.value.vertices.map((vertex) => new Point(this.parent, vertex));\n  }\n\n  public area(): number {\n    return this.value.area();\n  }\n  \n  public readonly parent: CoordinateSystem;\n  public readonly value: Flatten.Polygon;\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nexport default class Progress {\n  constructor(name: string = \"\", steps: number = 0) {\n    this.name = name;\n    this.steps = steps;\n  }\n\n  public task(name: string, steps: number) {\n    this.steps += steps;\n    this.name = name;\n  }\n\n  public progress() {\n    this.step++;\n  }\n\n  public get stats(): { name: string, step?: number, steps?: number } {\n    return {\n      name: this.name,\n      step: (this.steps != null && this.step < this.steps) ? this.step : undefined,\n      steps: this.steps,\n    }\n  }\n\n  private step = 0;\n  private steps = 0;\n  private name: string;\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nexport class OperationAborted extends Error {}\n\nexport default class CancellationToken {\n  public cancellationRequested() {\n    return new Promise<boolean>((resolve, reject) => {\n      if (this.aborted) reject(new OperationAborted());\n      setTimeout(() => resolve(this.cancelled), 0);\n    });\n  }\n\n  public cancel() {\n    this.cancelled = true;\n  }\n\n  public abort() {\n    this.aborted = true;\n  }\n\n  private cancelled = false;\n  private aborted = false;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020-2021 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\nimport minBy from \"lodash-es/minBy\";\nimport Flatten from \"@flatten-js/core\";\n\nimport Vector from \"../Vector\";\nimport HalfEdge from \"../triangulation/HalfEdge\";\nimport HalfEdgeLayout from './HalfEdgeLayout';\nimport Point from '../Point';\nimport Segment from '../Segment';\nimport Polygon from '../Polygon';\nimport FlatTriangulation from '../triangulation/FlatTriangulation';\nimport Progress from \"@/Progress\";\nimport CancellationToken from \"@/CancellationToken\";\n\nexport default class CellLayout {\n  // Create a layout by walking the boundary of the cell in counter-clockwise\n  // order on the inside and summing up the associated vectors to determine the\n  // segment corresponding to each half edge.\n  public constructor(surface: FlatTriangulation, cell: HalfEdge[], origin: Point);\n  public constructor(surface: FlatTriangulation, layout: Record<HalfEdge, HalfEdgeLayout>);\n  public constructor(surface: FlatTriangulation, cell: HalfEdge[] | Record<HalfEdge, HalfEdgeLayout>, origin?: Point) {\n    this.surface = surface;\n\n    if (cell instanceof Array) {\n      assert(origin);\n      let end = origin;\n      this.layout = Object.fromEntries(cell.map((he: HalfEdge) => {\n        const start = end;\n        end = end.translate(surface.vector(he));\n        return [he, {\n          segment: new Segment(origin.parent, start.value, end.value),\n          inner: false,\n        }];\n      }));\n    } else {\n      this.layout = cell;\n    }\n\n    this.boundingRectArea = this.polygon.boundingRect.area();\n  }\n\n  // Translate this cell so that half edge coincides with segment.\n  translate(delta: Vector): void;\n  translate(halfEdge: HalfEdge, segment: Segment): void;\n  translate(halfEdge: HalfEdge | Vector, segment?: Segment) {\n    if (halfEdge instanceof Vector) {\n      const delta = halfEdge as Vector;\n      this.halfEdges.map((halfEdge) => {\n        this.layout[halfEdge].segment = this.layout[halfEdge].segment.translate(delta);\n      });\n    } else {\n      const before = this.layout[halfEdge].segment;\n      const delta = new Vector(before.parent, before.start, segment!.start);\n      \n      // https://github.com/alexbol99/flatten-js/pull/75\n      assert(before.translate(delta).equalTo(segment!, (Flatten.Utils as any).getTolerance()));\n\n      this.translate(delta);\n    }\n  }\n\n  // Return the HalfEdges that glue correctly between this layout and `other`\n  // currently or return an empty array if something overlaps or touches\n  // incorrectly.\n  glues(other: CellLayout): HalfEdge[] {\n    const otherPolygon = other.polygon;\n\n    const glued = [];\n\n    for (const halfEdge of this.halfEdges) {\n      if (this.layout[halfEdge].segment.intersects(otherPolygon)) {\n        // This half edge and the other cell have at least a point in common.\n\n        if (this.layout[halfEdge].segment.middle.on(otherPolygon)) {\n          if (other.halfEdges.includes(-halfEdge)) {\n            // If this half edge has its counterpart in the other cell, then we\n            // want them to be glued correctly.\n            if (this.layout[halfEdge].segment.equalTo(other.layout[-halfEdge].segment.reverse(), Flatten.Utils.getTolerance())) {\n              glued.push(halfEdge);\n              continue;\n            } else {\n              return [];\n            }\n          } else {\n            return [];\n          }\n        }\n\n        const intersections = this.layout[halfEdge].segment.intersect(otherPolygon);\n        if (intersections.length === 0) {\n          // This half edge is completely inside the other cell.\n          return [];\n        }\n\n        // Check whether the intersection points are consistently glued.\n        for (const intersection of intersections) {\n          const touchConsistent = (source: HalfEdge) => {\n              for (const vertex of this.surface.vertices.cycles) {\n                if (!vertex.includes(source)) continue;\n\n                for (const touch of vertex) {\n                  if (!other.halfEdges.includes(touch)) continue;\n\n                  if (intersection.equalTo(other.layout[touch].segment.start, Flatten.Utils.getTolerance()))\n                    return true;\n              }\n            };\n            // Not touching at a vertex or not touching at this vertex.\n            return false;\n          }\n\n          if (intersection.equalTo(this.layout[halfEdge].segment.start, Flatten.Utils.getTolerance())) {\n            // The cells touch at the starting point of this half edge. We\n            // check whether what it touches is the same vertex in the other\n            // cell.\n            if (!touchConsistent(halfEdge)) {\n              return [];\n            }\n          }\n          else if (intersection.equalTo(this.layout[halfEdge].segment.end, Flatten.Utils.getTolerance())) {\n            // The cells touch at the end point of this half edge. We\n            // check whether what it touches is the same vertex in the other\n            // cell.\n            if (!touchConsistent(-halfEdge)) {\n              return [];\n            }\n          } else {\n            // The cells touch not at the end point of a half edge.\n            return [];\n          }\n        }\n      }\n    }\n\n    assert(glued.length !== 0);\n    return glued;\n  }\n\n  touches(other: CellLayout): HalfEdge[] {\n    const otherPolygon = other.polygon;\n    return this.halfEdges.filter((halfEdge) => {\n      return !this.layout[halfEdge].inner && this.layout[halfEdge].segment.intersects(otherPolygon) || this.layout[halfEdge].segment.touch(otherPolygon);\n    });\n  }\n\n  // Return the boundary polygon of this cell (might not be connected.)\n  get polygon(): Polygon {\n    const polygon = new Flatten.Polygon();\n    this.boundaries.map((boundary) => {\n      polygon.addFace(boundary.map((side) => this.parent.embed(this.layout[side].segment).value));\n    });\n    return new Polygon(this.parent, polygon);\n  }\n\n  // Return the boundary polygons of this cell.\n  get boundaries() : HalfEdge[][] {\n    let pending = new Set(this.halfEdges.filter((he) => !this.layout[he].inner));\n    const boundaries = [] as HalfEdge[][];\n\n    while(pending.size) {\n      let start!: number;\n      for (start of pending) break;\n\n      const boundary = [] as HalfEdge[];\n      let next = start;\n      do {\n        next = -next;\n\n        do {\n          next = this.surface.vertices.preimage(next);\n        } while(this.layout[next].inner);\n\n        boundary.push(next);\n        pending.delete(next);\n      } while (next !== start);\n\n      boundaries.push(boundary);\n    }\n\n    return boundaries;\n  }\n\n  private get parent() {\n    return this.layout[this.halfEdges[0]].segment.parent;\n  }\n\n  public toString(): string {\n    return \"{\" + this.halfEdges.map((he) => `${he}: ${this.layout[he].segment}`).join(\", \") + \"}\";\n  }\n\n  get halfEdges(): HalfEdge[] {\n    return Object.keys(this.layout).map((halfEdge) => Number(halfEdge));\n  }\n\n  // Merge two of the cells by identifying two opposite half edges.\n  static async merge(cells: CellLayout[], force: (he: HalfEdge) => boolean | null, cache: Record<HalfEdge, number | null> = {}, cancellation = new CancellationToken(), _progress = new Progress()): Promise<CellLayout[]> {\n    if (cells.length === 1)\n      return cells;\n\n    let scores = [] as {\n      glue: HalfEdge;\n      cell: CellLayout;\n      other: CellLayout;\n      score: number;\n    }[];\n\n    for (const cell of cells) {\n      if (await cancellation.cancellationRequested())\n        break;\n\n      for (const glue of cell.halfEdges) {\n        if (glue < 0) continue;\n        const other = cells.find((other) => other.halfEdges.includes(-glue))!;\n        if (cell === other) continue;\n\n        if (cache[glue] === undefined) {\n          cache[glue] = CellLayout.score(glue, cell, other, cells, force);\n        }\n\n        const score = cache[glue];\n\n        if (score === null)\n          continue;\n\n        scores.push({ glue, cell, other, score });\n      }\n    }\n\n    if (scores.length === 0)\n      return cells;\n\n    const best = minBy(scores, 'score')!;\n\n    const cell = CellLayout.glue(best.glue, best.cell, best.other);\n\n    for (let halfEdge of cell.halfEdges) {\n      delete cache[halfEdge];\n      delete cache[-halfEdge];\n    }\n\n    return [cell, ...cells.filter((c) => c !== best.cell && c !== best.other)];\n  }\n\n  // Return the score (lower is better) to the visual glueing of glue of\n  // parent and -glue of other; or return null if the two cannot be glued\n  // without overlaps in the resulting picture.\n  private static score(glue: HalfEdge, parent: CellLayout, other: CellLayout, cells: CellLayout[], force?: (he: HalfEdge) => boolean | null): number | null {\n    assert(parent.halfEdges.includes(glue) && other.halfEdges.includes(-glue));\n    assert(!parent.layout[glue].inner && !other.layout[-glue].inner);\n\n    other.translate(-glue, parent.layout[glue].segment.reverse());\n    const glues = parent.glues(other);\n    if (glues.length === 0) {\n      return null;\n    }\n\n\n    // Prefer edges that have been explicitly selected.\n    if (force) {\n      if (force(glue) === true)\n        return -force.length;\n      if (force(glue) === false)\n        return null;\n    }\n\n    // Prefer edges that keep Delaunay cells intact.\n    {\n      const ca = parent.surface.vector(glue);\n      const cb = parent.surface.vector(parent.surface.vertices.image(glue));\n      const dc = parent.surface.vector(-parent.surface.faces.image(-glue));\n\n      const a = dc.add(ca);\n      const b = dc.add(cb);\n      const c = dc;\n\n      const det = (x00: number, x01: number, x02: number, x10: number, x11: number, x12: number, x20: number, x21: number, x22: number) => x00 * (x11 * x22 - x12 * x21) - x10 * (x01 * x22 - x21 * x02) + x20 * (x01 * x12 - x11 * x02);\n\n      const delaunay = det(a.x, a.y, a.x * a.x + a.y * a.y, b.x, b.y, b.x * b.x + b.y * b.y, c.x, c.y, c.x * c.x + c.y * c.y);\n\n      if (Math.abs(delaunay) < (Flatten.Utils as any).getTolerance())\n        return 0;\n    }\n\n    // Prefer edges that minimize the area of a bounding rectangle of the glued area.\n    {\n      const ungluedArea = cells.map((cell) => cell.boundingRectArea).reduce((a, b) => a+b);\n\n      const gluedArea = cells.filter((cell) => cell !== parent && cell !== other).map((cell) => cell.boundingRectArea).reduce((a, b) => a + b, 0)\n        + CellLayout.glue(glues, parent, other).boundingRectArea;\n\n      return gluedArea / ungluedArea;\n    }\n  }\n\n  // Glue parent and other along glue and return the resulting cell.\n  private static glue(glues: HalfEdge[], parent: CellLayout, other: CellLayout): CellLayout;\n  private static glue(glue: HalfEdge, parent: CellLayout, other: CellLayout): CellLayout;\n  private static glue(glues: HalfEdge | HalfEdge[], parent: CellLayout, other: CellLayout): CellLayout {\n    if (!Array.isArray(glues)) {\n      other.translate(-glues, parent.layout[glues].segment.reverse());\n      return CellLayout.glue(parent.glues(other), parent, other);\n    } else {\n      assert(glues.length !== 0)\n      other.translate(-glues[0], parent.layout[glues[0]].segment.reverse());\n\n      // https://github.com/alexbol99/flatten-js/pull/75\n      for (const glue of glues)\n        assert(parent.layout[glue].segment.equalTo(other.layout[-glue].segment.reverse(), (Flatten.Utils as any).getTolerance()));\n\n      assert(Object.keys(parent.layout).every((he) => !other.layout.hasOwnProperty(he)));\n      assert(Object.keys(other.layout).every((he) => !parent.layout.hasOwnProperty(he)));\n\n      const glued = {...parent.layout, ...other.layout};\n      for (const glue of glues) {\n        glued[glue] = { segment: parent.layout[glue].segment, inner: true }\n        glued[-glue] = { segment: other.layout[-glue].segment, inner: true }\n      }\n\n      return new CellLayout(parent.surface, glued);\n    }\n  }\n\n  private static packable(cells: CellLayout[], packed: CellLayout[]) {\n    for (let i = 0; i < cells.length; i++) {\n      const cell = cells[i];\n\n      // Find a half edge that connects to something that has already been packed\n      for (let halfEdge of cell.halfEdges) {\n        for (let cell_ of packed) {\n          for (let halfEdge_ of cell_.halfEdges) {\n            if (halfEdge === -halfEdge_) {\n              cells.splice(i, 1);\n              return {\n                cell,\n                cell_,\n                halfEdge,\n                halfEdge_,\n              };\n            }\n          }\n        }\n      }\n    }\n\n    assert(false, `Could not find any cells packable with ${packed} among ${cells}`);\n  }\n\n  static pack(cells: CellLayout[], progress: Progress): CellLayout[] {\n    if (cells.length <= 1) return cells;\n\n    const packed = [cells.pop()] as CellLayout[];\n\n    progress.task(\"Packing Cells\", cells.length);\n\n    while (cells.length) {\n      progress.progress();\n\n      const {cell, cell_, halfEdge, halfEdge_} = CellLayout.packable(cells, packed);\n\n      const segment = cell.layout[halfEdge].segment;\n      const segment_ = cell_.layout[halfEdge_].segment.reverse();\n\n      cell.translate(halfEdge, segment_);\n\n      // We determine a distance that two edges have to be separated from each\n      // other to make it clear that they are not glued.\n      // The idea is that the entire `packed` presumably fills a notebook cell,\n      // probably 800 x 600 pixels. A gap of 5 pixels can easily be recognized\n      // as a gap.\n      const screen = packed.map((cell) => cell.polygon.value.box).reduce((box, cell) => box.merge(cell), new Flatten.Box());\n      const step = Math.max((screen.xmax - screen.xmin) / 800, (screen.ymax - screen.ymin) / 600) * 5;\n      const delta = segment.tangentInStart.rotate90CCW().multiply(step);\n      \n      do {\n        cell.translate(delta);\n      } while(packed.some((other) => cell.touches(other).length))\n\n      packed.push(cell);\n    }\n\n    return packed;\n  }\n\n  protected readonly surface: FlatTriangulation;\n  protected readonly boundingRectArea: number;\n  public readonly layout: Record<HalfEdge, HalfEdgeLayout>;\n}\n","/* ******************************************************************************\n * Copyright (c) 2020 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport Point from '../Point';\nimport FlatTriangulation from \"../triangulation/FlatTriangulation\";\nimport HalfEdge from '../triangulation/HalfEdge';\nimport CellLayout from './CellLayout';\nimport HalfEdgeLayout from './HalfEdgeLayout';\nimport Box from '../Box';\nimport CancellationToken from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\n\nexport default class FlatTriangulationLayout {\n  private constructor(surface: FlatTriangulation, force?: (he: HalfEdge) => boolean | null) {\n    this.surface = surface;\n    this.force = force || (() => null);\n  }\n\n  public static async layout(surface: FlatTriangulation, force?: (he: HalfEdge) => boolean | null, cancellation = new CancellationToken(), progress = new Progress()) {\n    const layout = new FlatTriangulationLayout(surface, force);\n    await layout.recompute(cancellation, progress);\n    return layout;\n  }\n\n  private async recompute(cancellation: CancellationToken, progress: Progress) {\n    // Layout Algorithm:\n    // (1) Start from elementary cells, i.e., triangular faces.\n    // (2) Greedily glue any two cells as long as no overlap is produced,\n    //     prefering metrics such as the gluing that minimizes the area of a\n    //     bounding rectangle.\n    // (3) Pack the resulting cells into a box by randomly aligning\n    //     corresponding half edges to create a single polygon (with self intersections)\n    //     and move the pieces away from each other orthogonally until no overlaps\n    //     happen anymore.\n\n    // (1) Elementary Cells\n    if (this.surface.halfEdges.length === 0) {\n      this.halfEdges = {};\n      return;\n    }\n\n    const origin = new Point(this.surface.vector(this.surface.halfEdges[0]).parent, 0, 0);\n    let cells = this.surface.faces.cycles.map((face) => new CellLayout(this.surface, face, origin));\n\n    // (2) Glue Cells\n    progress.task(\"Gluing Cells\", cells.length - 1);\n    const cache = {};\n    for (const _ of Array(cells.length - 1)) {\n      progress.progress();\n      cells = await CellLayout.merge(cells, this.force, cache, cancellation, progress);\n    }\n\n    // (3) Pack Cells\n    cells = CellLayout.pack(cells, progress);\n\n    this.halfEdges = Object.assign({}, ...cells.map((cell) => cell.layout));\n\n    // Complain about unsatisfied forcings.\n    for (const he of this.surface.halfEdges) {\n      if (this.force(he) === true && !this.layout(he).inner)\n        console.log(`Half edge ${he} should be visually glued in the layout but this was not possible.`);\n      if (this.force(he) === false && this.layout(he).inner)\n        console.error(`Half edge ${he} should not be visually glued in the layout but it is.`);\n    }\n\n  }\n\n  public layout(halfEdge: HalfEdge): HalfEdgeLayout {\n    return this.halfEdges[halfEdge];\n  }\n\n  public get bbox(): Box {\n    return Box.bbox(Object.values(this.halfEdges).map((layout) => layout.segment));\n  }\n\n  public readonly surface: FlatTriangulation;\n  private force: (he: HalfEdge) => boolean | null;\n  private halfEdges!: Record<HalfEdge, HalfEdgeLayout>;\n}\n","/* ******************************************************************************\n * Copyright (c) 2021 Julian Rth <julian.rueth@fsfe.org>\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * *****************************************************************************/\n\nimport assert from \"assert\";\n\nimport { optimize } from \"svgo/dist/svgo.browser.js\";\n\n/*\n * Turns an <svg> in an HTML document into a standalone svg.\n */\nexport default class SVGExporter {\n  constructor(svg: Element) {\n    this.svg = svg.cloneNode(true) as Element;\n    this.styles = [...svg.getElementsByTagName(\"*\")].map(this.computedStyle);\n\n    if (this.svg.tagName !== 'svg') {\n      this.styles.unshift(this.computedStyle(svg));\n\n      svg = document.createElement('svg');\n      svg.appendChild(this.svg);\n      this.svg = svg;\n    }\n\n    this.svg.setAttribute(\"xmlns\", \"http://www.w3.org/2000/svg\");\n    this.svg.setAttribute(\"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n  }\n\n  private get children() {\n    return this.svg.getElementsByTagName(\"*\");\n  }\n\n  private computedStyle(element: Element) {\n    const style = window.getComputedStyle(element);\n    const computed = {} as { [key: string]: string };\n    for (let i = 0; i < style.length; i++)\n      computed[style[i]] = style.getPropertyValue(style[i]);\n    return computed;\n  }\n\n  /*\n   * Return the index of `e` in `styles`.\n   */\n  private index(e: Element) {\n    const children = this.children;\n    assert(children.length == this.styles.length);\n\n    for (let index = 0; index < children.length; index++) {\n      if (children[index] === e)\n        return index;\n    }\n\n    throw Error(\"Element not found in DOM tree.\")\n  }\n\n  /*\n   * Drop all class=\"\" attributes from all elements.\n   */\n  public dropClasses() {\n    for (const child of this.children) {\n      child.removeAttribute('class');\n    }\n  }\n\n  /*\n   * Drop all prefixed styles from all elements, i.e., things such as\n   * `-webkit-...` and `--variable`.\n   */\n  public dropPrefixedStyles() {\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, _value]) => !key.startsWith('-'))\n      );\n    });\n  }\n\n  /*\n   * Drop all elements that are not visible from the element tree.\n   */\n  public dropInvisible() {\n    const children = this.children;\n    assert(children.length === this.styles.length);\n\n    const trash = {} as {[index: number]: Element};\n\n    const add = (element: Element) => {\n      const index = this.index(element);\n\n      if (index in trash)\n        return;\n      trash[index] = element;\n\n      [...element.children].forEach(add);\n    };\n\n    for (let index = 0; index < children.length; index++) {\n      const child = children[index];\n      const style = this.styles[index];\n      if (style[\"visibility\"] === \"hidden\" || style[\"display\"] === \"none\")\n        add(child);\n    }\n\n    this.styles = this.styles.filter((_style, i) => !(i in trash));\n\n    for (const element of Object.values(trash)) {\n      if (element.parentNode != null) {\n        element.parentNode.removeChild(element);\n      }\n    }\n\n    assert(children.length === this.styles.length);\n\n    // Now we can drop all \"visibility: visible\" and \"display: \" which has no\n    // effect in SVG anymore.\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, _value]) => key !== \"visibility\" && key !== \"display\")\n      );\n    });\n  }\n\n  /*\n   * Drop styling that is already equally set on the parent node.\n   */\n  public dropRedundantStyles() {\n    const children = this.children;\n    assert(children.length === this.styles.length);\n\n    for (let index = children.length; index--;) {\n      const child = children[index];\n      const parent = child.parentNode as Element;\n\n      assert(parent != null);\n      if (parent === this.svg) continue;\n\n      const style = this.styles[this.index(parent)];\n      this.styles[index] = Object.fromEntries(\n        Object.entries(this.styles[index]).filter(([key, value]) => style[key] != value)\n      );\n    }\n  }\n\n  /*\n   * Drop custom attributes such as `data-attribute=\"\"`.\n   */\n  public dropCustomAttributes() {\n    for (const child of this.children) {\n      [...child.attributes].forEach((attribute) => {\n        if (attribute.name.includes('-'))\n          child.removeAttribute(attribute.name);\n      });\n    }\n  }\n\n  /*\n   * Drop styles that are inherited from the browser but have no meaning in SVG.\n   */\n  public dropBrowserStyles() {\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, _value]) => {\n          // flex styles\n          if (key.startsWith('align-'))\n            return false;\n          if (key.startsWith('flex-'))\n            return false;\n          // grid styles\n          if (key.startsWith('grid-'))\n            return false;\n          if (key.startsWith('column-'))\n            return false;\n          if (key.startsWith('row-'))\n            return false;\n          // HTML styles\n          if (key.startsWith('padding'))\n            return false;\n          if (key.startsWith('margin'))\n            return false;\n          if (key.startsWith('background'))\n            return false;\n          if (key.startsWith('border'))\n            return false;\n          if (key.startsWith('scroll'))\n            return false;\n          if (key.startsWith('overscroll'))\n            return false;\n          if (key.startsWith('overflow'))\n            return false;\n          if (key.startsWith('counter'))\n            return false;\n          if (key.startsWith('object-'))\n            return false;\n          if (key === 'float')\n            return false;\n          if (key === 'clear')\n            return false;\n          return true;\n        })\n      );\n    });\n  }\n\n  /*\n   * Drop styles that are only used for interaction and animations.\n   */\n  public dropInteractiveStyles() {\n    this.styles = this.styles.map((styles) => {\n      return Object.fromEntries(\n        Object.entries(styles).filter(([key, _value]) => {\n          if (key == 'user-select')\n            return false;\n          if (key.startsWith('animation'))\n            return false;\n          if (key.startsWith('transition'))\n            return false;\n          if (key.startsWith('touch'))\n            return false;\n          if (key.startsWith('offset'))\n            return false;\n          if (key === 'pointer-events')\n            return false;\n          if (key === 'cursor')\n            return false;\n          return true;\n        })\n      );\n    });\n  }\n\n  /*\n   * Inline all styling into the elements `style` attribute.\n   * This is usually the last method to call before `toString()`.\n   */\n  public inlineStyles() {\n    const children = this.children;\n    assert(children.length == this.styles.length);\n\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      const style = Object.entries(this.styles[i]).map(([key, value]) => {\n        return `${key}: ${value};`\n      }).join(\" \");\n      if (style)\n        child.setAttribute('style', style);\n      else\n        child.removeAttribute('style');\n    }\n  }\n\n  /*\n   * Return the extracted SVG as a string.\n   */\n  public toString(svgo: boolean = true) {\n    let svg = this.svg.outerHTML;\n    if (svgo)\n      svg = optimize(svg).data;\n    return svg;\n  }\n\n  // A clone of the original SVG node from the DOM.\n  private svg: Element;\n\n  // The computed style of each node in the original SVG node in traversal order.\n  private styles: Array<{ [key: string]: string }> = [];\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Provide, Inject, Watch } from \"vue-property-decorator\";\n\nimport Viewport from \"../geometry/Viewport\";\nimport FlatTriangulation from \"../geometry/triangulation/FlatTriangulation\";\nimport FlatTriangulationComponent from \"./FlatTriangulation.vue\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\nimport FlowComponent from \"../geometry/triangulation/FlowComponent\";\nimport FlowComponentComponent from \"./FlowComponent.vue\";\nimport Palette from \"@/Palette\";\n\nimport Point from \"@/geometry/Point\";\nimport Vector from \"@/geometry/Vector\";\nimport Segment from \"@/geometry/Segment\";\nimport FlatTriangulationLayout from '@/geometry/layout/FlatTriangulationLayout';\nimport { IHalfEdgeConfiguration } from \"./HalfEdgeConfiguration\";\n\nimport CancellationToken, { OperationAborted } from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\n\nimport SVGExporter from \"@/export/SVGExporter\";\n\n@Component({\n  components: {\n    FlatTriangulationComponent,\n    FlowComponentComponent,\n  }\n})\nexport default class Surface extends Vue {\n  @Prop({ required: true }) viewport!: Viewport;\n  @Prop({ required: true }) surface!: FlatTriangulation;\n  @Prop({ required: false, default: () => [], type: Array }) components!: FlowComponent[];\n  @Prop({ required: false, default: () => [], type: Array }) inner!: HalfEdge[];\n  \n  private forced = [] as HalfEdge[];\n  private selected = [] as HalfEdge[];\n  private hovered = [] as HalfEdge[];\n  private indicator = {} as Record<HalfEdge, number | null>;\n  private cancellation = new CancellationToken();\n  private layout = null as FlatTriangulationLayout | null;\n\n  // TODO: It is a strange pattern to hide the updates behind the layout updates.\n  palette = new Palette();\n\n  static _run(callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>): void {\n    callback(new CancellationToken(), new Progress());\n  }\n\n  @Inject({ from: 'run', default: () => Surface._run})\n  run!: (callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>) => void;\n\n  created() {\n    this.relayout();\n  }\n\n  async relayout() {\n    this.cancellation.abort();\n    this.run(async (cancellation, progress) => {\n      this.cancellation = cancellation;\n      try {\n        this.layout = await FlatTriangulationLayout.layout(this.surface, (he: HalfEdge) => (this.forced.includes(he) || this.forced.includes(-he)) ? true : null, this.cancellation, progress);\n      } catch (e) {\n        if (e instanceof OperationAborted) return;\n        throw e;\n      }\n      this.palette = new Palette(this.components.length);\n      this.$emit('layout', this.layout);\n      this.$nextTick(() => {\n        // TODO: Maybe we should not always export the SVG but only do so on demand.\n        const exporter = new SVGExporter(this.$refs.svg as HTMLElement);\n        exporter.dropClasses();\n        exporter.dropPrefixedStyles();\n        exporter.dropInvisible();\n        exporter.dropRedundantStyles();\n        exporter.dropCustomAttributes();\n        exporter.dropBrowserStyles();\n        exporter.dropInteractiveStyles();\n        exporter.inlineStyles();\n        this.$emit('svg', exporter.toString());\n      });\n    });\n\n  }\n\n  @Provide()\n  svg(xy: Vector | Point | Segment) : Vector | Point | Segment {\n    if (xy instanceof Vector)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    if (xy instanceof Point)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    if (xy instanceof Segment)\n      return this.viewport.viewportCoordinateSystem.embed(xy);\n    throw new Error(\"Cannot embed this type into the SVG coordinate system yet.\");\n  }\n\n  @Watch(\"forced\")\n  onForcedChanged() {\n    this.relayout();\n  }\n\n  @Watch(\"inner\", {immediate: true})\n  onInnerChanged() {\n    this.forced = this.inner;\n  }\n\n  forceHalfEdge(halfEdge: HalfEdge) {\n    this.forced.push(halfEdge);\n  }\n\n  async glue(halfEdge: HalfEdge) {\n    if (this.forced.includes(halfEdge) || this.forced.includes(-halfEdge))\n      this.forced = this.forced.filter((he) => he !== halfEdge && he !== -halfEdge);\n    else\n      this.forced.unshift(halfEdge);\n\n    this.selected.push(halfEdge); \n\n    await new Promise(resolve => this.$once(\"layout\", resolve));\n\n    await new Promise(resolve => setTimeout(resolve, 500));\n\n    this.selected = this.selected.filter((he) => he !== halfEdge && he !== -halfEdge);\n  }\n\n  hover(halfEdge: HalfEdge, at: number) {\n    this.hovered.push(halfEdge);\n    this.indicator[halfEdge] = at;\n    this.indicator[-halfEdge] = 1 - at;\n  }\n\n  unhover(halfEdge: HalfEdge) {\n    this.hovered = this.hovered.filter((he) => he !== halfEdge && he !== -halfEdge);\n    this.indicator[halfEdge] = null;\n    this.indicator[-halfEdge] = null;\n  }\n\n  // TODO: This should live in a more generic place.\n  private relativizeOntoSegment(segment: Segment, point: Point): number {\n    const e = segment.value.tangentInStart();\n    const toPoint = new Vector(segment.parent, segment.start, point).value;\n    return e.dot(toPoint) / segment.value.length;\n  }\n\n  // TODO: This is a weird name.\n  @Provide()\n  halfEdgeConfiguration(halfEdge: HalfEdge): IHalfEdgeConfiguration {\n    return {\n      interactions: {\n        click: () => {\n          this.unhover(halfEdge)\n          this.glue(halfEdge)\n        },\n        // TODO: This assumes that this component fills the viewport coordinate system. That's probably always in practice true but maybe we should inject the offset.\n        enter: (ev: MouseEvent, segment: Segment) => this.hover(halfEdge, this.relativizeOntoSegment(segment, new Point(this.viewport.viewportCoordinateSystem, ev.clientX - this.$el.getBoundingClientRect().left, ev.clientY - this.$el.getBoundingClientRect().top))),\n        leave: () => this.unhover(halfEdge),\n        hover: (ev: MouseEvent, segment: Segment) => this.hover(halfEdge, this.relativizeOntoSegment(segment, new Point(this.viewport.viewportCoordinateSystem, ev.clientX - this.$el.getBoundingClientRect().left, ev.clientY - this.$el.getBoundingClientRect().top))),\n      },\n      state: {\n        selected: this.selected.includes(halfEdge) || this.selected.includes(-halfEdge),\n        glued: this.forced.includes(halfEdge) || this.forced.includes(-halfEdge),\n        labeled: this.hovered.includes(halfEdge) || this.hovered.includes(-halfEdge),\n        indicator: this.indicator[halfEdge],\n      },\n    };\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Surface.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Surface.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Surface.vue?vue&type=template&id=7e571d50&\"\nimport script from \"./Surface.vue?vue&type=script&lang=ts&\"\nexport * from \"./Surface.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport YAML from \"yaml\";\n\nimport CoordinateSystem from \"@/geometry/CoordinateSystem\";\nimport FlatTriangulation from \"@/geometry/triangulation/FlatTriangulation\";\nimport FlowComponent from \"@/geometry/triangulation/FlowComponent\";\nimport FlatTriangulationLayout from \"@/geometry/layout/FlatTriangulationLayout\";\nimport HalfEdge from \"../geometry/triangulation/HalfEdge\";\n\nimport PanZoom from \"./PanZoom.vue\";\nimport Surface from \"./Surface.vue\";\n\n@Component({\n  components: {\n    Surface,\n    PanZoom,\n  }\n})\nexport default class SurfaceViewer extends Vue {\n  @Prop({ required: true }) raw!: string;\n  @Prop({ required: false, default: () => [], type: Array }) inner!: HalfEdge[];\n\n  private readonly idealCoordinateSystem = new CoordinateSystem(true);\n  protected surface: FlatTriangulation | null = null;\n  protected components: FlowComponent[] = [];\n\n  focus = this.idealCoordinateSystem.box([-1, -1], [1, 1]);\n\n  protected onLayoutChanged(layout: FlatTriangulationLayout) {\n    if (!this.focus.equalTo(layout.bbox))\n      this.focus = layout.bbox;\n    this.$emit('layout', layout)\n    this.$emit('update:inner', this.surface!.halfEdges.filter((he) => layout.layout(he).inner));\n  }\n\n  protected onSVGChanged(svg: string) {\n    this.$emit('svg', svg);\n  }\n\n  @Watch(\"raw\", { immediate: true })\n  onRawChanged() {\n    try {\n      const parsed = YAML.parse(this.raw);\n      this.surface = FlatTriangulation.parse(parsed, this.idealCoordinateSystem);\n      this.components = (parsed.components || []).map((component: any) => FlowComponent.parse(component, this.idealCoordinateSystem));\n      this.$emit('ok');\n    } catch(e) {\n      this.$emit('error', e.message);\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SurfaceViewer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SurfaceViewer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SurfaceViewer.vue?vue&type=template&id=e1ca3df0&\"\nimport script from \"./SurfaceViewer.vue?vue&type=script&lang=ts&\"\nexport * from \"./SurfaceViewer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default \"vertices:\\n- - 1\\n  - -3\\n  - -9\\n  - -21\\n  - 14\\n  - 6\\n  - -7\\n  - -17\\n  - -27\\n  - 25\\n  - -26\\n  - 23\\n  - 12\\n  - -13\\n  - 18\\n  - -19\\n  - 10\\n  - 4\\n- - -1\\n  - -5\\n  - -12\\n  - 16\\n  - 7\\n  - 2\\n- - -2\\n  - -6\\n  - -15\\n  - -25\\n  - 24\\n  - 13\\n  - 5\\n  - -4\\n  - -11\\n  - 21\\n  - -20\\n  - 17\\n  - -16\\n  - -23\\n  - 22\\n  - 19\\n  - 8\\n  - 3\\n- - -8\\n  - -18\\n  - -24\\n  - 27\\n  - 20\\n  - 9\\n- - -10\\n  - -22\\n  - 26\\n  - 15\\n  - -14\\n  - 11\\nvectors:\\n  1:\\n    x: 1.0\\n    y: 0.0\\n  2:\\n    x: -0.32635182233306964\\n    y: 0.565257937423568\\n  3:\\n    x: -0.6736481776669303\\n    y: -0.565257937423568\\n  4:\\n    x: 0.6736481776669303\\n    y: -0.565257937423568\\n  5:\\n    x: 0.32635182233306964\\n    y: 0.565257937423568\\n  6:\\n    x: -0.8263518223330697\\n    y: -0.3007674663608706\\n  7:\\n    x: 0.5\\n    y: 0.8660254037844386\\n  8:\\n    x: -0.5\\n    y: 0.41954981558864\\n  9:\\n    x: -0.17364817766693036\\n    y: -0.984807753012208\\n  10:\\n    x: 0.17364817766693036\\n    y: -0.984807753012208\\n  11:\\n    x: 0.5\\n    y: 0.41954981558864\\n  12:\\n    x: -0.5\\n    y: 0.8660254037844386\\n  13:\\n    x: 0.8263518223330697\\n    y: -0.3007674663608706\\n  14:\\n    x: -0.9396926207859084\\n    y: 0.3420201433256687\\n  15:\\n    x: 0.11334079845283873\\n    y: -0.6427876096865394\\n  16:\\n    x: 0.6527036446661393\\n    y: 0.0\\n  17:\\n    x: -0.1527036446661393\\n    y: 0.8660254037844386\\n  18:\\n    x: -0.9396926207859084\\n    y: -0.3420201433256687\\n  19:\\n    x: 0.4396926207859084\\n    y: 0.7615699589143088\\n  20:\\n    x: -0.6133407984528387\\n    y: -0.22323779409789932\\n  21:\\n    x: 0.4396926207859084\\n    y: -0.7615699589143088\\n  22:\\n    x: 0.6133407984528387\\n    y: -0.22323779409789932\\n  23:\\n    x: 0.1527036446661393\\n    y: 0.8660254037844386\\n  24:\\n    x: -0.11334079845283873\\n    y: -0.6427876096865394\\n  25:\\n    x: 0.8793852415718167\\n    y: 0.0\\n  26:\\n    x: -0.766044443118978\\n    y: -0.6427876096865394\\n  27:\\n    x: -0.766044443118978\\n    y: 0.6427876096865394\\ncomponents:\\n- cylinder: true\\n  perimeter:\\n  - source: 25\\n    target: -25\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.8793852415718167\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 25\\n      index: 0\\n    - halfEdge: -25\\n      index: 1\\n  - source: -15\\n    target: 13\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -1.7057370639048863\\n      y: 0.3007674663608706\\n    crossings:\\n    - halfEdge: 26\\n      at: 0.8006595491452156\\n    - halfEdge: -23\\n      at: 0.8263518223330697\\n    - halfEdge: -12\\n      at: 0.8006595491452156\\n    touches:\\n    - halfEdge: -15\\n      index: 0\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: 13\\n      index: 0\\n  - source: -25\\n    target: 25\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.8793852415718167\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -25\\n      index: 0\\n    - halfEdge: 25\\n      index: 1\\n  - source: -27\\n    target: -13\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 1.7057370639048863\\n      y: -0.3007674663608706\\n    crossings:\\n    - halfEdge: -24\\n      at: 0.766044443118978\\n    touches:\\n    - halfEdge: -27\\n      index: 0\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -13\\n      index: 0\\n  inside:\\n  - 13\\n  - -13\\n  - 25\\n  - -25\\n- cylinder: true\\n  perimeter:\\n  - source: 1\\n    target: -1\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 1.0\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 1\\n      index: 0\\n    - halfEdge: -1\\n      index: 1\\n  - source: 16\\n    target: -16\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.6527036446661393\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: 16\\n      index: 0\\n    - halfEdge: -16\\n      index: 1\\n  - source: 17\\n    target: 22\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: -7\\n      at: 0.8793852415718167\\n    - halfEdge: -2\\n      at: 0.7733184030943225\\n    - halfEdge: 3\\n      at: 0.5739779522395382\\n    - halfEdge: 9\\n      at: 0.713011023880231\\n    - halfEdge: 21\\n      at: 0.5739779522395382\\n    - halfEdge: -11\\n      at: 0.7733184030943225\\n    - halfEdge: 10\\n      at: 0.8793852415718167\\n    touches:\\n    - halfEdge: 17\\n      index: 0\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -2\\n      index: 0\\n    - halfEdge: 2\\n      index: 0\\n    - halfEdge: 3\\n      index: 0\\n    - halfEdge: -3\\n      index: 0\\n    - halfEdge: 9\\n      index: 0\\n    - halfEdge: -9\\n      index: 0\\n    - halfEdge: 21\\n      index: 0\\n    - halfEdge: -21\\n      index: 0\\n    - halfEdge: -11\\n      index: 0\\n    - halfEdge: 11\\n      index: 0\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 22\\n      index: 0\\n  - source: -16\\n    target: 16\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.6527036446661393\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -16\\n      index: 0\\n    - halfEdge: 16\\n      index: 1\\n  - source: -1\\n    target: 1\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -1.0\\n      y: 0.0\\n    crossings: []\\n    touches:\\n    - halfEdge: -1\\n      index: 0\\n    - halfEdge: 1\\n      index: 1\\n  - source: 4\\n    target: 14\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: 5\\n      at: 0.7168814171420514\\n    - halfEdge: 12\\n      at: 0.7733184030943225\\n    - halfEdge: 23\\n      at: 0.6736481776669303\\n    - halfEdge: -26\\n      at: 0.7733184030943225\\n    - halfEdge: -15\\n      at: 0.7168814171420514\\n    touches:\\n    - halfEdge: 4\\n      index: 0\\n    - halfEdge: 5\\n      index: 0\\n    - halfEdge: -5\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -15\\n      index: 0\\n    - halfEdge: 15\\n      index: 0\\n    - halfEdge: 14\\n      index: 0\\n  inside:\\n  - 1\\n  - -1\\n  - 14\\n  - -14\\n  - 16\\n  - -16\\n  - 22\\n  - -22\\n- cylinder: true\\n  perimeter:\\n  - source: 22\\n    target: -4\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 1.1133407984528387\\n      y: 0.19631202149074067\\n    crossings:\\n    - halfEdge: -10\\n      at: 0.32635182233306964\\n    touches:\\n    - halfEdge: 22\\n      index: 0\\n    - halfEdge: -10\\n      index: 2\\n    - halfEdge: 10\\n      index: 1\\n    - halfEdge: -4\\n      index: 1\\n  - source: -4\\n    target: -2\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: 10\\n      at: 0.4679111137620439\\n    - halfEdge: -19\\n      at: 0.532088886237956\\n    - halfEdge: 18\\n      at: 0.8793852415718167\\n    - halfEdge: 24\\n      at: 0.9076037345479523\\n    - halfEdge: -27\\n      at: 0.8793852415718167\\n    - halfEdge: -17\\n      at: 0.532088886237956\\n    - halfEdge: -7\\n      at: 0.4679111137620439\\n    touches:\\n    - halfEdge: -4\\n      index: 2\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -10\\n      index: 3\\n    - halfEdge: -19\\n      index: 0\\n    - halfEdge: 19\\n      index: 0\\n    - halfEdge: 18\\n      index: 0\\n    - halfEdge: -18\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: -27\\n      index: 0\\n    - halfEdge: 27\\n      index: 0\\n    - halfEdge: -17\\n      index: 0\\n    - halfEdge: 17\\n      index: 1\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 7\\n      index: 1\\n    - halfEdge: -2\\n      index: 0\\n  - source: 8\\n    target: 21\\n    vertical: true\\n    boundary: false\\n    vector:\\n      x: -1.1133407984528387\\n      y: 0.19631202149074067\\n    crossings:\\n    - halfEdge: 9\\n      at: 0.32635182233306964\\n    touches:\\n    - halfEdge: 8\\n      index: 0\\n    - halfEdge: 9\\n      index: 1\\n    - halfEdge: -9\\n      index: 1\\n    - halfEdge: 21\\n      index: 1\\n  - source: -4\\n    target: 22\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -1.1133407984528387\\n      y: -0.19631202149074067\\n    crossings:\\n    - halfEdge: 10\\n      at: 0.6736481776669303\\n    touches:\\n    - halfEdge: -4\\n      index: 0\\n    - halfEdge: 10\\n      index: 2\\n    - halfEdge: -10\\n      index: 1\\n    - halfEdge: 22\\n      index: 1\\n  - source: 22\\n    target: 17\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: -10\\n      at: 0.12061475842818323\\n    - halfEdge: 11\\n      at: 0.22668159690567746\\n    - halfEdge: -21\\n      at: 0.4260220477604618\\n    - halfEdge: -9\\n      at: 0.2869889761197691\\n    - halfEdge: -3\\n      at: 0.4260220477604618\\n    - halfEdge: 2\\n      at: 0.22668159690567746\\n    - halfEdge: 7\\n      at: 0.12061475842818323\\n    touches:\\n    - halfEdge: 22\\n      index: 2\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 10\\n      index: 3\\n    - halfEdge: 11\\n      index: 0\\n    - halfEdge: -11\\n      index: 0\\n    - halfEdge: -21\\n      index: 0\\n    - halfEdge: 21\\n      index: 2\\n    - halfEdge: -9\\n      index: 0\\n    - halfEdge: 9\\n      index: 2\\n    - halfEdge: -3\\n      index: 0\\n    - halfEdge: 3\\n      index: 0\\n    - halfEdge: 2\\n      index: 0\\n    - halfEdge: -2\\n      index: 1\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -7\\n      index: 1\\n    - halfEdge: 17\\n      index: 0\\n  - source: 21\\n    target: 8\\n    vertical: true\\n    boundary: false\\n    vector:\\n      x: 1.1133407984528387\\n      y: -0.19631202149074067\\n    crossings:\\n    - halfEdge: -9\\n      at: 0.6736481776669303\\n    touches:\\n    - halfEdge: 21\\n      index: 0\\n    - halfEdge: -9\\n      index: 2\\n    - halfEdge: 9\\n      index: 0\\n    - halfEdge: 8\\n      index: 1\\n  inside:\\n  - 8\\n  - -8\\n  - 20\\n  - -20\\n- cylinder: true\\n  perimeter:\\n  - source: -6\\n    target: 6\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: 0.8263518223330697\\n      y: 0.3007674663608706\\n    crossings: []\\n    touches:\\n    - halfEdge: -6\\n      index: 0\\n    - halfEdge: 6\\n      index: 1\\n  - source: 14\\n    target: 4\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -3.2057370639048863\\n      y: 0.565257937423568\\n    crossings:\\n    - halfEdge: 15\\n      at: 0.28311858285794855\\n    - halfEdge: 26\\n      at: 0.22668159690567746\\n    - halfEdge: -23\\n      at: 0.32635182233306964\\n    - halfEdge: -12\\n      at: 0.22668159690567746\\n    - halfEdge: -5\\n      at: 0.28311858285794855\\n    touches:\\n    - halfEdge: 14\\n      index: 0\\n    - halfEdge: 15\\n      index: 0\\n    - halfEdge: -15\\n      index: 1\\n    - halfEdge: 26\\n      index: 0\\n    - halfEdge: -26\\n      index: 1\\n    - halfEdge: -23\\n      index: 0\\n    - halfEdge: 23\\n      index: 1\\n    - halfEdge: -12\\n      index: 0\\n    - halfEdge: 12\\n      index: 1\\n    - halfEdge: -5\\n      index: 0\\n    - halfEdge: 5\\n      index: 0\\n    - halfEdge: 4\\n      index: 0\\n  - source: -13\\n    target: -27\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: -1.7057370639048863\\n      y: 0.3007674663608706\\n    crossings:\\n    - halfEdge: 24\\n      at: 0.23395555688102196\\n    touches:\\n    - halfEdge: -13\\n      index: 0\\n    - halfEdge: 24\\n      index: 0\\n    - halfEdge: -24\\n      index: 1\\n    - halfEdge: -27\\n      index: 0\\n  - source: 6\\n    target: -6\\n    vertical: false\\n    boundary: false\\n    vector:\\n      x: -0.8263518223330697\\n      y: -0.3007674663608706\\n    crossings: []\\n    touches:\\n    - halfEdge: 6\\n      index: 0\\n    - halfEdge: -6\\n      index: 1\\n  - source: -2\\n    target: -4\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 3.2057370639048863\\n      y: -0.565257937423568\\n    crossings:\\n    - halfEdge: 7\\n      at: 0.532088886237956\\n    - halfEdge: 17\\n      at: 0.4679111137620439\\n    - halfEdge: 27\\n      at: 0.12061475842818323\\n    - halfEdge: -24\\n      at: 0.09239626545204768\\n    - halfEdge: -18\\n      at: 0.12061475842818323\\n    - halfEdge: 19\\n      at: 0.4679111137620439\\n    - halfEdge: -10\\n      at: 0.532088886237956\\n    touches:\\n    - halfEdge: -2\\n      index: 0\\n    - halfEdge: 7\\n      index: 0\\n    - halfEdge: -7\\n      index: 0\\n    - halfEdge: 17\\n      index: 0\\n    - halfEdge: -17\\n      index: 0\\n    - halfEdge: 27\\n      index: 0\\n    - halfEdge: -27\\n      index: 1\\n    - halfEdge: -24\\n      index: 0\\n    - halfEdge: 24\\n      index: 1\\n    - halfEdge: -18\\n      index: 0\\n    - halfEdge: 18\\n      index: 0\\n    - halfEdge: 19\\n      index: 0\\n    - halfEdge: -19\\n      index: 0\\n    - halfEdge: -10\\n      index: 0\\n    - halfEdge: 10\\n      index: 0\\n    - halfEdge: -4\\n      index: 0\\n  - source: 13\\n    target: -15\\n    vertical: true\\n    boundary: true\\n    vector:\\n      x: 1.7057370639048863\\n      y: -0.3007674663608706\\n    crossings:\\n    - halfEdge: 12\\n      at: 0.19934045085478438\\n    - halfEdge: 23\\n      at: 0.17364817766693036\\n    - halfEdge: -26\\n      at: 0.19934045085478438\\n    touches:\\n    - halfEdge: 13\\n      index: 0\\n    - halfEdge: 12\\n      index: 0\\n    - halfEdge: -12\\n      index: 1\\n    - halfEdge: 23\\n      index: 0\\n    - halfEdge: -23\\n      index: 1\\n    - halfEdge: -26\\n      index: 0\\n    - halfEdge: 26\\n      index: 1\\n    - halfEdge: -15\\n      index: 0\\n  inside:\\n  - 4\\n  - -4\\n  - 6\\n  - -6\\n\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.cancellation != null && _vm.visible)?_c('v-overlay',{staticClass:\"loading-overlay\",attrs:{\"opacity\":.2,\"z-index\":0}},[_c('v-container',[_c('v-row',[_c('v-col',[_vm._v(\" \"+_vm._s(_vm.name)+\" \"),_c('v-progress-circular',{attrs:{\"indeterminate\":_vm.value == null,\"value\":_vm.value}})],1)],1),_c('v-row',[_c('v-col',[_c('v-btn',{attrs:{\"color\":\"error\",\"dark\":\"\",\"disabled\":_vm.cancellation.cancelled},on:{\"click\":function () { return _vm.cancellation.cancel(); }}},[_vm._v(\"Cancel\")])],1)],1)],1)],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport CancellationToken from \"../src/CancellationToken\";\nimport Progress from \"../src/Progress\";\n\n@Component\nexport default class Overlay extends Vue {\n  @Prop({required: true}) cancellation!: CancellationToken | null;\n  @Prop({required: true}) progress!: Progress | null;\n\n  visible = false;\n\n  @Watch(\"cancellation\", {immediate: true})\n  onCancellation(value: CancellationToken) {\n    if (value == null)\n      this.visible = false;\n    else\n      setTimeout(() => {\n        if (this.cancellation === value)\n          this.visible = true\n      }, 150);\n  }\n\n  get name() {\n    return this.progress!.stats.name;\n  }\n\n  get value() : number | null {\n    if (this.progress!.stats.step == null || this.progress!.stats.steps == null)\n      return null;\n    return this.progress!.stats.step / this.progress!.stats.steps * 100;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Overlay.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Overlay.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Overlay.vue?vue&type=template&id=3e466302&scoped=true&\"\nimport script from \"./Overlay.vue?vue&type=script&lang=ts&\"\nexport * from \"./Overlay.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Overlay.vue?vue&type=style&index=0&id=3e466302&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3e466302\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VOverlay } from 'vuetify/lib/components/VOverlay';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCol,VContainer,VOverlay,VProgressCircular,VRow})\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Provide, Vue } from \"vue-property-decorator\";\nimport PanZoom from \"@/components/PanZoom.vue\";\nimport SurfaceViewer from \"@/components/SurfaceViewer.vue\";\nimport dump from \"!!raw-loader!./2-3-4-pullback-flow.txt\";\nimport CancellationToken from \"@/CancellationToken\";\nimport Progress from \"@/Progress\";\nimport Overlay from \"./Overlay.vue\";\n\n@Component({\n  components: {\n    Overlay,\n    PanZoom,\n    SurfaceViewer,\n  }\n})\nexport default class App extends Vue {\n  raw = dump;\n  editor = false;\n  svg = false;\n  svgExport = null;\n  overlay = null as CancellationToken | null;\n  error = null as string | null;\n  progress = null as Progress | null;\n\n  @Provide()\n  async run(callback: (cancellation: CancellationToken, progress: Progress) => Promise<void>) {\n    // Any previous run is supposedly cancelled already so we can safely throw\n    // away its cancellation and progress tokens.\n    const cancellation = new CancellationToken();\n    this.overlay = cancellation;\n    this.progress = new Progress();\n    try {\n      await callback(this.overlay, this.progress);\n    } finally {\n      if (this.overlay === cancellation)\n        // We came here because this process completed. Remove the overlay.\n        this.overlay = null;\n    }\n  }\n\n  onError(message: string | null = null) {\n    this.error= message;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-39[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??clonedRuleSet-39[0].rules[0].use[2]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=0bcaedbe&scoped=true&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=0bcaedbe&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0bcaedbe\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VMain } from 'vuetify/lib/components/VMain';\nimport { VTextarea } from 'vuetify/lib/components/VTextarea';\nimport { VToolbar } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VApp,VBtn,VCard,VCardTitle,VContainer,VDialog,VForm,VIcon,VMain,VTextarea,VToolbar})\n","import Vue, { VNode } from 'vue';\nimport App from './App.vue';\nimport Vuetify from 'vuetify/lib';\nimport '@mdi/font/css/materialdesignicons.css'\n\nVue.config.productionTip = false;\n\nVue.use(Vuetify);\n\nnew Vue({\n    render: (h): VNode => h(App),\n    vuetify: new Vuetify({}),\n}).$mount('#app');\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkvue_flatsurf\"] = self[\"webpackChunkvue_flatsurf\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(3808); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}